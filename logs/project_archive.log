2025-10-25 16:47:38,797 [INFO] pc_project: Starting data cleaning.
2025-10-25 16:47:38,798 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 16:47:38,810 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 16:47:38,813 [INFO] pc_project: Data cleaning complete.
2025-10-25 16:47:38,813 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 16:47:38,813 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,815 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 16:47:38,816 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,818 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 16:47:38,818 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,820 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 16:47:38,820 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,822 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 16:47:38,823 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,826 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 16:47:38,828 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 16:47:38,828 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 16:47:38,829 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 16:47:38,829 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 16:47:38,835 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 16:47:38,837 [INFO] pc_project: Starting data cleaning.
2025-10-25 16:47:38,837 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 16:47:38,847 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 16:47:38,849 [INFO] pc_project: Data cleaning complete.
2025-10-25 16:47:38,850 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 16:47:38,850 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,852 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 16:47:38,852 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,854 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 16:47:38,854 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,856 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 16:47:38,856 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,858 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 16:47:38,858 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,860 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 16:47:38,860 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,861 [INFO] pc_project: Starting data cleaning.
2025-10-25 16:47:38,861 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 16:47:38,867 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 16:47:38,870 [INFO] pc_project: Data cleaning complete.
2025-10-25 16:47:38,870 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 16:47:38,871 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,872 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 16:47:38,873 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,873 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 16:47:38,880 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 16:47:38,881 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 16:47:38,882 [INFO] pc_project: Starting data cleaning.
2025-10-25 16:47:38,882 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 16:47:38,894 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 16:47:38,896 [INFO] pc_project: Data cleaning complete.
2025-10-25 16:47:38,897 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 16:47:38,897 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,899 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 16:47:38,899 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,901 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 16:47:38,901 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,903 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 16:47:38,903 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,905 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 16:47:38,905 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,907 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 16:47:38,907 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,909 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 16:47:38,909 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,911 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 16:47:38,911 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,913 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 16:47:38,913 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,913 [INFO] pc_project: Starting data cleaning.
2025-10-25 16:47:38,914 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 16:47:38,919 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 16:47:38,922 [INFO] pc_project: Data cleaning complete.
2025-10-25 16:47:38,922 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 16:47:38,922 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,924 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 16:47:38,925 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,926 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 16:47:38,927 [INFO] pc_project: --------------------------------------------------
2025-10-25 16:47:38,927 [INFO] pc_project: Starting merge pipeline...
2025-10-25 16:47:38,928 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 16:47:38,931 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 16:47:38,935 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 16:47:38,939 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 16:47:38,942 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 16:47:38,950 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 16:47:38,950 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 16:47:38,957 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 16:47:38,970 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 16:47:38,970 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 18:18:49,798 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:18:49,798 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 18:18:49,813 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:18:49,829 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:18:49,830 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 18:18:49,831 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,834 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 18:18:49,835 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,837 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 18:18:49,839 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,840 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 18:18:49,840 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,846 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 18:18:49,847 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,850 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 18:18:49,853 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 18:18:49,854 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 18:18:49,855 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 18:18:49,856 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 18:18:49,863 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 18:18:49,868 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:18:49,869 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 18:18:49,880 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:18:49,883 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:18:49,884 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 18:18:49,885 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,887 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:18:49,888 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,889 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 18:18:49,890 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,893 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 18:18:49,893 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,893 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 18:18:49,898 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,900 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 18:18:49,901 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,902 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:18:49,903 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 18:18:49,909 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:18:49,910 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:18:49,910 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 18:18:49,910 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,915 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 18:18:49,916 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,916 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 18:18:49,921 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 18:18:49,922 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 18:18:49,923 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:18:49,923 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 18:18:49,937 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:18:49,939 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:18:49,939 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 18:18:49,940 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,941 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:18:49,942 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,948 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 18:18:49,948 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,948 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 18:18:49,948 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,948 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 18:18:49,948 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,954 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 18:18:49,954 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,956 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 18:18:49,956 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,957 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 18:18:49,958 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,959 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 18:18:49,960 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,961 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:18:49,962 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 18:18:49,970 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:18:49,973 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:18:49,973 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 18:18:49,974 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,975 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 18:18:49,976 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,978 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 18:18:49,979 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:18:49,980 [INFO] pc_project: Starting merge pipeline...
2025-10-25 18:18:49,981 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 18:18:49,986 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 18:18:49,990 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 18:18:49,993 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 18:18:49,995 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 18:18:50,002 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 18:18:50,002 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 18:18:50,012 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 18:18:50,014 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 18:19:15,284 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:19:15,285 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 18:19:15,363 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:19:15,366 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:19:15,367 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 18:19:15,368 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,372 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 18:19:15,373 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,375 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 18:19:15,376 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,379 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 18:19:15,380 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,382 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 18:19:15,383 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,386 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 18:19:15,389 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 18:19:15,390 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 18:19:15,391 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 18:19:15,392 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 18:19:15,398 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 18:19:15,399 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:19:15,400 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 18:19:15,414 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:19:15,417 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:19:15,419 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 18:19:15,420 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,422 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:19:15,424 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,426 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 18:19:15,427 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,429 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 18:19:15,431 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,434 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 18:19:15,434 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,436 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 18:19:15,437 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,438 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:19:15,438 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 18:19:15,445 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:19:15,447 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:19:15,448 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 18:19:15,449 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,450 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 18:19:15,451 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,451 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 18:19:15,459 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 18:19:15,460 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 18:19:15,460 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:19:15,461 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 18:19:15,476 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:19:15,479 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:19:15,480 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 18:19:15,480 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,482 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:19:15,483 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,484 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 18:19:15,485 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,487 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 18:19:15,488 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,490 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 18:19:15,490 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,492 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 18:19:15,492 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,494 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 18:19:15,495 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,496 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 18:19:15,497 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,499 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 18:19:15,499 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,500 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:19:15,501 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 18:19:15,508 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:19:15,511 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:19:15,511 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 18:19:15,511 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,512 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 18:19:15,513 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,515 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 18:19:15,515 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:19:15,515 [INFO] pc_project: Starting merge pipeline...
2025-10-25 18:19:15,516 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 18:19:15,520 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 18:19:15,523 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 18:19:15,528 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 18:19:15,530 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 18:19:15,535 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 18:19:15,536 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 18:19:15,542 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 18:19:15,544 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 18:19:15,555 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 18:19:15,556 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 18:27:11,205 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:11,206 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 18:27:11,217 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:11,220 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:11,221 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 18:27:11,222 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,225 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 18:27:11,227 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,229 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 18:27:11,230 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,234 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 18:27:11,235 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,238 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 18:27:11,239 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,242 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 18:27:11,247 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 18:27:11,248 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 18:27:11,250 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 18:27:11,251 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 18:27:11,259 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 18:27:11,260 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:11,261 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 18:27:11,274 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:11,277 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:11,279 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 18:27:11,280 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,282 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:27:11,283 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,285 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 18:27:11,286 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,287 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 18:27:11,288 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,289 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 18:27:11,290 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,291 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 18:27:11,291 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,292 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:11,292 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 18:27:11,297 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:11,300 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:11,300 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 18:27:11,301 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,302 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 18:27:11,303 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,303 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 18:27:11,310 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 18:27:11,311 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 18:27:11,312 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:11,313 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 18:27:11,322 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:11,324 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:11,325 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 18:27:11,325 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,327 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:27:11,327 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,329 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 18:27:11,330 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,331 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 18:27:11,332 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,333 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 18:27:11,334 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,335 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 18:27:11,336 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,338 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 18:27:11,338 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,340 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 18:27:11,340 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,342 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 18:27:11,343 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,344 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:11,344 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 18:27:11,350 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:11,352 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:11,352 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 18:27:11,353 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,354 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 18:27:11,355 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,356 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 18:27:11,357 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:11,358 [INFO] pc_project: Starting merge pipeline...
2025-10-25 18:27:11,358 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 18:27:11,363 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 18:27:11,366 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 18:27:11,370 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 18:27:11,373 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 18:27:11,380 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 18:27:11,380 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 18:27:11,389 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 18:27:11,391 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 18:27:11,401 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 18:27:11,402 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 18:27:24,992 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:24,993 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 18:27:25,006 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:25,010 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:25,011 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 18:27:25,012 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,014 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 18:27:25,015 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,017 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 18:27:25,018 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,022 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 18:27:25,057 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,077 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 18:27:25,082 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,093 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 18:27:25,099 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 18:27:25,101 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 18:27:25,106 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 18:27:25,107 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 18:27:25,116 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 18:27:25,118 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:25,119 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 18:27:25,140 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:25,144 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:25,144 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 18:27:25,145 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,146 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:27:25,147 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,150 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 18:27:25,150 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,152 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 18:27:25,153 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,156 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 18:27:25,157 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,159 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 18:27:25,159 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,160 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:25,161 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 18:27:25,167 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:25,169 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:25,170 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 18:27:25,170 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,172 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 18:27:25,173 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,173 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 18:27:25,181 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 18:27:25,182 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 18:27:25,183 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:25,183 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 18:27:25,196 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:25,199 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:25,199 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 18:27:25,199 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,201 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 18:27:25,201 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,203 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 18:27:25,203 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,205 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 18:27:25,205 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,207 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 18:27:25,208 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,211 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 18:27:25,211 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,213 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 18:27:25,214 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,215 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 18:27:25,216 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,218 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 18:27:25,218 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,218 [INFO] pc_project: Starting data cleaning.
2025-10-25 18:27:25,219 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 18:27:25,224 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 18:27:25,227 [INFO] pc_project: Data cleaning complete.
2025-10-25 18:27:25,227 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 18:27:25,227 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,229 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 18:27:25,229 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,231 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 18:27:25,231 [INFO] pc_project: --------------------------------------------------
2025-10-25 18:27:25,231 [INFO] pc_project: Starting merge pipeline...
2025-10-25 18:27:25,231 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 18:27:25,235 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 18:27:25,238 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 18:27:25,244 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 18:27:25,246 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 18:27:25,251 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 18:27:25,251 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 18:27:25,256 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 18:27:25,260 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 18:27:25,268 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 18:27:25,268 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:00:38,989 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:00:38,990 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:00:39,008 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:00:39,011 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:00:39,011 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:00:39,012 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,014 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:00:39,015 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,018 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:00:39,019 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,021 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:00:39,022 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,023 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:00:39,024 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,027 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:00:39,030 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:00:39,030 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:00:39,031 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:00:39,031 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:00:39,055 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:00:39,055 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:00:39,056 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:00:39,067 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:00:39,069 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:00:39,069 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:00:39,070 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,071 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:00:39,072 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,073 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:00:39,074 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,075 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:00:39,077 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,078 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:00:39,078 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,080 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:00:39,082 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,083 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:00:39,083 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:00:39,088 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:00:39,090 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:00:39,090 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:00:39,090 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,092 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:00:39,093 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,094 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:00:39,101 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:00:39,102 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:00:39,102 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:00:39,103 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:00:39,115 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:00:39,118 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:00:39,118 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:00:39,119 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,120 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:00:39,121 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,122 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:00:39,123 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,125 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:00:39,125 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,128 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:00:39,128 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,130 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:00:39,131 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,133 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:00:39,133 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,135 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:00:39,135 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,137 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:00:39,137 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,138 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:00:39,138 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:00:39,145 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:00:39,148 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:00:39,148 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:00:39,149 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,151 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:00:39,151 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,153 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:00:39,153 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:00:39,153 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:00:39,154 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:00:39,158 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:00:39,163 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:00:39,168 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:00:39,170 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:00:39,178 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:00:39,178 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:00:39,186 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:00:39,190 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:00:39,200 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:00:39,200 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:00:39,229 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:00:39,238 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:01:52,184 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,188 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:01:52,204 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,207 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:01:52,235 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,246 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,248 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,249 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:01:52,249 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,255 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:01:52,255 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,257 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:01:52,258 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,259 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,260 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:01:52,260 [INFO] pc_project: --------------------------------------------------
est            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:01:52,260 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,262 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:01:52,263 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,265 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:01:52,266 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,268 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:01:52,268 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:01:52,270 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,272 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:01:52,273 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,274 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:01:52,274 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:01:52,274 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:01:52,275 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:01:52,275 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:01:52,275 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,279 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:01:52,284 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:01:52,284 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:01:52,285 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:01:52,286 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:01:52,289 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:01:52,289 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,289 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:01:52,300 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:01:52,301 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,301 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,302 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:01:52,308 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,308 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:01:52,308 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,310 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:01:52,311 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,313 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:01:52,314 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,316 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:01:52,316 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,318 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,319 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:01:52,319 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,321 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:01:52,321 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,321 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,321 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:01:52,325 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,326 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:01:52,326 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,328 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:01:52,329 [INFO] pc_project: No NaN values detected in the dataset.
----------
2025-10-25 20:01:52,331 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:01:52,331 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,333 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:01:52,334 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,336 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:01:52,336 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,337 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,337 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:01:52,338 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,338 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:01:52,339 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,339 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,340 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:01:52,340 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:01:52,340 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,341 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:01:52,346 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,352 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:01:52,353 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,354 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:01:52,354 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:01:52,354 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,355 [INFO] pc_project: Input shape: (5, 8)
-----------------------------
2025-10-25 20:01:52,356 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:01:52,357 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,357 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:01:52,369 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:01:52,370 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:01:52,371 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,371 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:01:52,371 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,378 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,378 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:01:52,378 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,382 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:01:52,382 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,384 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:01:52,384 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,386 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:01:52,386 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,388 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,389 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:01:52,389 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,391 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:01:52,391 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,392 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:01:52,393 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,395 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,395 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:01:52,395 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:01:52,395 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,395 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,398 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:01:52,398 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,398 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:01:52,399 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,399 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,399 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:01:52,400 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:01:52,401 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,403 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:01:52,404 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,405 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:01:52,406 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,407 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,408 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:01:52,408 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,410 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:01:52,410 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,412 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:01:52,413 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,415 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:01:52,416 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,415 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,416 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:01:52,416 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,416 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:01:52,416 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:01:52,418 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:01:52,418 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,420 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:01:52,420 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,420 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:01:52,421 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:01:52,423 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:01:52,433 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:01:52,433 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:01:52,434 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,435 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:01:52,436 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:01:52,436 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,438 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:01:52,438 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:01:52,439 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:01:52,439 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:01:52,440 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:01:52,448 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:01:52,450 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:01:52,453 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:01:52,459 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:01:52,459 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:01:52,461 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:01:52,467 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:01:52,469 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:01:52,470 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:01:52,474 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:01:52,476 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:01:52,476 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:01:52,489 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:01:52,492 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:01:52,492 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:01:52,492 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:01:52,508 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:01:52,513 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:01:52,513 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:01:52,525 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:01:52,528 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:01:52,547 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:02:34,481 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:02:34,484 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:02:34,526 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:02:34,540 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:02:34,540 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:02:34,541 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,547 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:02:34,547 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,549 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:02:34,550 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,552 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:02:34,552 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,554 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:02:34,554 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,558 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:02:34,563 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:02:34,564 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:02:34,564 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:02:34,564 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:02:34,576 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:02:34,577 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:02:34,578 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:02:34,588 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:02:34,597 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:02:34,597 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:02:34,598 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,600 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:02:34,600 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,601 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:02:34,602 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,603 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:02:34,603 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,605 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:02:34,605 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,607 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:02:34,607 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,607 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:02:34,608 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:02:34,614 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:02:34,619 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:02:34,620 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:02:34,620 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,621 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:02:34,622 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,622 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:02:34,631 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:02:34,632 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:02:34,632 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:02:34,633 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:02:34,645 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:02:34,652 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:02:34,653 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:02:34,653 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,655 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:02:34,655 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,656 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:02:34,657 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,659 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:02:34,660 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,661 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:02:34,662 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,663 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:02:34,664 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,665 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:02:34,665 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,667 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:02:34,667 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,669 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:02:34,669 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,670 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:02:34,670 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:02:34,678 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:02:34,683 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:02:34,684 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:02:34,684 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,686 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:02:34,686 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,688 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:02:34,688 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:02:34,688 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:02:34,690 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:02:34,699 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:02:34,703 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:02:34,710 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:02:34,712 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:02:34,717 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:02:34,717 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:02:34,728 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:02:34,730 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:02:34,745 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:02:34,745 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:02:34,759 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:02:34,772 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:07:04,880 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:07:04,880 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:07:04,891 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:07:04,894 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:07:04,894 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:07:04,895 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,897 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:07:04,897 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,899 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:07:04,900 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,902 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:07:04,902 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,904 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:07:04,904 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,906 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:07:04,908 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:07:04,909 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:07:04,909 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:07:04,910 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:07:04,914 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:07:04,915 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:07:04,916 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:07:04,924 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:07:04,927 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:07:04,928 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:07:04,928 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,931 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:07:04,931 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,932 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:07:04,933 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,935 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:07:04,935 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,936 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:07:04,937 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,938 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:07:04,938 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,939 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:07:04,939 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:07:04,943 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:07:04,946 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:07:04,947 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:07:04,947 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,949 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:07:04,949 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,949 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:07:04,954 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:07:04,955 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:07:04,956 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:07:04,956 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:07:04,967 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:07:04,970 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:07:04,970 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:07:04,971 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,972 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:07:04,972 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,974 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:07:04,975 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,976 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:07:04,977 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,979 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:07:04,979 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,981 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:07:04,981 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,983 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:07:04,983 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,985 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:07:04,985 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,987 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:07:04,987 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,988 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:07:04,988 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:07:04,993 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:07:04,996 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:07:04,996 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:07:04,996 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:04,998 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:07:04,998 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:05,000 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:07:05,000 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:07:05,001 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:07:05,001 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:07:05,005 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:07:05,010 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:07:05,017 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:07:05,019 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:07:05,024 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:07:05,027 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:07:05,033 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:07:05,037 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:07:05,044 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:07:05,044 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:07:05,054 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:07:05,062 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:26:08,837 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:08,839 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:26:08,852 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:08,857 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:08,858 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:26:08,858 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,861 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:26:08,862 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,864 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:26:08,865 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,898 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:26:08,899 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,901 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:26:08,902 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,905 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:26:08,907 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:26:08,907 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:26:08,908 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:26:08,908 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:26:08,917 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:26:08,918 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:08,918 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:26:08,930 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:08,933 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:08,933 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:26:08,934 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,937 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:26:08,938 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,944 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:26:08,944 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,948 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:26:08,949 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,951 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:26:08,951 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,954 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:26:08,954 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,955 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:08,955 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:26:08,961 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:08,965 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:08,965 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:26:08,965 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,967 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:26:08,967 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,967 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:26:08,973 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:26:08,974 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:26:08,975 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:08,975 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:26:08,987 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:08,989 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:08,989 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:26:08,990 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,991 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:26:08,992 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,994 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:26:08,995 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,997 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:26:08,997 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:08,999 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:26:08,999 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,001 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:26:09,001 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,003 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:26:09,003 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,005 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:26:09,005 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,007 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:26:09,007 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,008 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:09,008 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:26:09,015 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:09,021 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:09,021 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:26:09,022 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,024 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:26:09,024 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,027 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:26:09,027 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:09,028 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:26:09,028 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:26:09,031 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:26:09,035 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:26:09,039 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:26:09,042 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:26:09,047 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:26:09,048 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:26:09,053 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:26:09,059 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:26:09,066 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:26:09,067 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:26:27,978 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:27,979 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:26:27,999 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:28,006 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:28,006 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:26:28,007 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,009 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:26:28,009 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,011 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:26:28,012 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,013 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:26:28,014 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,017 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:26:28,017 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,022 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:26:28,024 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:26:28,025 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:26:28,025 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:26:28,025 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:26:28,032 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:26:28,032 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:28,033 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:26:28,046 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:28,048 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:28,049 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:26:28,049 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,053 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:26:28,053 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,055 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:26:28,056 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,057 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:26:28,058 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,059 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:26:28,060 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,061 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:26:28,063 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,064 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:28,064 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:26:28,073 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:28,077 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:28,077 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:26:28,077 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,079 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:26:28,080 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,080 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:26:28,091 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:26:28,093 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:26:28,093 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:28,094 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:26:28,139 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:28,159 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:28,169 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:26:28,172 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,174 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:26:28,175 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,180 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:26:28,183 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,185 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:26:28,186 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,189 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:26:28,190 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,192 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:26:28,193 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,196 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:26:28,197 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,203 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:26:28,206 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,209 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:26:28,209 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,212 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:26:28,213 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:26:28,220 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:26:28,222 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:26:28,223 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:26:28,223 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,225 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:26:28,225 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,229 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:26:28,230 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:26:28,231 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:26:28,231 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:26:28,235 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:26:28,240 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:26:28,246 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:26:28,248 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:26:28,254 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:26:28,255 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:26:28,261 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:26:28,267 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:26:28,275 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:26:28,276 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:26:28,284 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:26:28,292 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:26:28,297 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:26:28,302 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 20:31:25,056 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:31:25,057 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:31:25,066 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:31:25,068 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:31:25,068 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:31:25,068 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,070 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:31:25,070 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,071 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:31:25,072 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,074 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:31:25,074 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,075 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:31:25,076 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,078 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:31:25,080 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:31:25,081 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:31:25,081 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:31:25,082 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:31:25,087 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:31:25,087 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:31:25,088 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:31:25,097 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:31:25,099 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:31:25,099 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:31:25,100 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,101 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:31:25,101 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,104 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:31:25,106 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,108 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:31:25,109 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,110 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:31:25,110 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,112 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:31:25,112 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,113 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:31:25,114 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:31:25,118 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:31:25,122 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:31:25,123 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:31:25,123 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,125 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:31:25,125 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,125 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:31:25,130 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:31:25,131 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:31:25,131 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:31:25,132 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:31:25,143 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:31:25,146 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:31:25,146 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:31:25,147 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,148 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:31:25,149 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,150 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:31:25,150 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,152 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:31:25,152 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,154 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:31:25,154 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,156 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:31:25,157 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,158 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:31:25,159 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,160 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:31:25,160 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,162 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:31:25,162 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,163 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:31:25,163 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:31:25,169 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:31:25,172 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:31:25,172 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:31:25,173 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,174 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:31:25,175 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,176 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:31:25,176 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:31:25,177 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:31:25,177 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:31:25,180 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:31:25,184 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:31:25,188 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:31:25,191 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:31:25,196 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:31:25,196 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:31:25,202 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:31:25,207 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:31:25,212 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:31:25,213 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:31:25,221 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:32:06,724 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:06,724 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:32:06,740 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:06,743 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:06,743 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:32:06,743 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,745 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:32:06,746 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,747 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:32:06,748 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,751 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:32:06,751 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,753 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:32:06,753 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,756 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:32:06,758 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:32:06,758 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:32:06,759 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:32:06,759 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:32:06,765 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:32:06,765 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:06,767 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:32:06,776 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:06,779 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:06,779 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:32:06,779 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,781 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:32:06,782 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,785 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:32:06,785 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,787 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:32:06,787 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,788 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:32:06,788 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,790 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:32:06,791 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,791 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:06,792 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:32:06,799 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:06,802 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:06,803 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:32:06,803 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,805 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:32:06,805 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,805 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:32:06,811 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:32:06,813 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:32:06,813 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:06,813 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:32:06,823 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:06,825 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:06,826 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:32:06,826 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,828 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:32:06,828 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,831 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:32:06,831 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,833 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:32:06,833 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,835 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:32:06,835 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,837 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:32:06,837 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,838 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:32:06,839 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,841 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:32:06,841 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,841 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:32:06,841 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,841 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:06,845 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:32:06,851 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:06,853 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:06,854 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:32:06,854 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,855 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:32:06,856 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,858 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:32:06,858 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:06,859 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:32:06,859 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:32:06,859 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:32:06,868 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:32:06,872 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:32:06,874 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:32:06,880 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:32:06,880 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:32:06,886 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:32:06,890 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:32:06,899 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:32:06,899 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:32:06,908 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:32:21,152 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:21,153 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:32:21,164 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:21,167 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:21,167 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:32:21,167 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,169 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:32:21,169 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,171 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:32:21,171 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,173 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:32:21,173 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,175 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:32:21,175 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,177 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:32:21,179 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:32:21,180 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:32:21,180 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:32:21,180 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:32:21,185 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:32:21,185 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:21,186 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:32:21,199 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:21,203 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:21,203 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:32:21,205 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,207 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:32:21,207 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,209 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:32:21,210 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,212 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:32:21,212 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,213 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:32:21,214 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,216 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:32:21,216 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,217 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:21,218 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:32:21,224 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:21,226 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:21,227 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:32:21,227 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,228 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:32:21,229 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,229 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:32:21,234 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:32:21,236 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:32:21,237 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:21,237 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:32:21,249 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:21,252 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:21,253 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:32:21,253 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,256 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:32:21,257 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,258 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:32:21,259 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,260 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:32:21,261 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,262 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:32:21,262 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,264 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:32:21,264 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,266 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:32:21,267 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,269 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:32:21,269 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,271 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:32:21,271 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,272 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:32:21,272 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:32:21,278 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:32:21,280 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:32:21,281 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:32:21,281 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,283 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:32:21,283 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,285 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:32:21,285 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:32:21,286 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:32:21,286 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:32:21,290 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:32:21,294 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:32:21,297 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:32:21,302 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:32:21,308 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:32:21,308 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:32:21,314 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:32:21,320 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:32:21,327 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:32:21,328 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:32:21,336 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:32:21,344 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:32:21,349 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:32:21,355 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 20:34:18,447 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:34:18,447 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 20:34:18,457 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:34:18,460 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:34:18,461 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 20:34:18,461 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,463 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 20:34:18,464 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,465 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 20:34:18,466 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,467 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 20:34:18,467 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,469 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 20:34:18,469 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,472 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 20:34:18,474 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 20:34:18,475 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 20:34:18,475 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 20:34:18,476 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 20:34:18,481 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 20:34:18,482 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:34:18,482 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 20:34:18,491 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:34:18,493 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:34:18,493 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 20:34:18,493 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,495 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:34:18,496 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,497 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 20:34:18,497 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,499 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 20:34:18,499 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,501 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 20:34:18,501 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,503 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 20:34:18,503 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,503 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:34:18,504 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 20:34:18,509 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:34:18,513 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:34:18,513 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 20:34:18,513 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,515 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 20:34:18,515 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,516 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 20:34:18,521 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 20:34:18,522 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 20:34:18,523 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:34:18,523 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 20:34:18,535 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:34:18,537 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:34:18,538 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 20:34:18,538 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,539 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 20:34:18,540 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,541 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 20:34:18,543 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,544 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 20:34:18,545 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,546 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 20:34:18,546 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,547 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 20:34:18,548 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,550 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 20:34:18,550 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,551 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 20:34:18,552 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,553 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 20:34:18,554 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,554 [INFO] pc_project: Starting data cleaning.
2025-10-25 20:34:18,554 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 20:34:18,561 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 20:34:18,563 [INFO] pc_project: Data cleaning complete.
2025-10-25 20:34:18,564 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 20:34:18,564 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,566 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 20:34:18,566 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,568 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 20:34:18,568 [INFO] pc_project: --------------------------------------------------
2025-10-25 20:34:18,569 [INFO] pc_project: Starting merge pipeline...
2025-10-25 20:34:18,569 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 20:34:18,572 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 20:34:18,578 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 20:34:18,582 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 20:34:18,585 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 20:34:18,591 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 20:34:18,592 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 20:34:18,597 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 20:34:18,601 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 20:34:18,644 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 20:34:18,651 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 20:34:18,687 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 20:34:18,736 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:34:18,781 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 20:34:18,815 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:21:25,053 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:25,054 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:21:25,064 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:25,067 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:25,068 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:21:25,068 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,071 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:21:25,071 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,073 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:21:25,073 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,075 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:21:25,075 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,077 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:21:25,077 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,079 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:21:25,083 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:21:25,083 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:21:25,084 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:21:25,084 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:21:25,092 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:21:25,093 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:25,093 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:21:25,103 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:25,106 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:25,106 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:21:25,107 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,108 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:21:25,109 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,110 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:21:25,111 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,112 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:21:25,113 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,115 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:21:25,115 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,116 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:21:25,117 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,117 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:25,118 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:21:25,123 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:25,125 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:25,126 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:21:25,126 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,127 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:21:25,128 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,128 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:21:25,133 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:21:25,134 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:21:25,134 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:25,135 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:21:25,146 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:25,148 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:25,148 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:21:25,148 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,150 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:21:25,150 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,151 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:21:25,152 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,154 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:21:25,154 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,156 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:21:25,157 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,158 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:21:25,159 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,160 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:21:25,160 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,163 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:21:25,163 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,164 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:21:25,165 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,165 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:25,166 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:21:25,172 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:25,174 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:25,175 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:21:25,175 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,178 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:21:25,178 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,179 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:21:25,180 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:25,180 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:21:25,180 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:21:25,183 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:21:25,188 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:21:25,193 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:21:25,195 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:21:25,200 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:21:25,200 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:21:25,207 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:21:25,210 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:21:25,217 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:21:25,218 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:21:25,230 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:21:25,240 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:21:25,246 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:21:25,252 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:21:25,263 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:21:25,267 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:21:25,269 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:21:25,274 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:21:25,278 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:21:25,281 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:21:39,764 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:39,765 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:21:39,778 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:39,781 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:39,781 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:21:39,782 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,783 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:21:39,784 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,785 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:21:39,786 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,788 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:21:39,789 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,791 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:21:39,792 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,794 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:21:39,796 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:21:39,796 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:21:39,797 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:21:39,797 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:21:39,802 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:21:39,803 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:39,803 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:21:39,815 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:39,818 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:39,818 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:21:39,819 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,820 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:21:39,820 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,823 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:21:39,824 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,826 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:21:39,826 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,828 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:21:39,828 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,829 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:21:39,830 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,830 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:39,831 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:21:39,836 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:39,841 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:39,841 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:21:39,841 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,843 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:21:39,844 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,844 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:21:39,850 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:21:39,852 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:21:39,852 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:39,853 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:21:39,868 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:39,871 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:39,872 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:21:39,872 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,874 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:21:39,875 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,877 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:21:39,877 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,879 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:21:39,879 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,881 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:21:39,882 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,883 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:21:39,883 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,885 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:21:39,886 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,887 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:21:39,888 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,890 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:21:39,890 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,891 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:21:39,891 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:21:39,897 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:21:39,899 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:21:39,900 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:21:39,900 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,902 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:21:39,902 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,904 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:21:39,904 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:21:39,905 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:21:39,905 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:21:39,909 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:21:39,913 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:21:39,919 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:21:39,921 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:21:39,927 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:21:39,927 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:21:39,934 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:21:39,937 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:21:39,946 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:21:39,946 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:21:39,955 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:21:39,963 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:21:39,970 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:21:39,976 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:21:39,980 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:21:39,984 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:21:39,988 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:21:39,991 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:21:39,995 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:21:40,000 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:36:59,664 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:36:59,665 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:36:59,679 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:36:59,683 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:36:59,683 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:36:59,684 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,686 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:36:59,686 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,688 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:36:59,689 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,691 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:36:59,692 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,693 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:36:59,693 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,695 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:36:59,697 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:36:59,697 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:36:59,697 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:36:59,697 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:36:59,705 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:36:59,706 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:36:59,706 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:36:59,718 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:36:59,722 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:36:59,722 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:36:59,722 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,724 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:36:59,724 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,726 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:36:59,726 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,728 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:36:59,728 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,730 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:36:59,730 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,732 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:36:59,732 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,733 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:36:59,733 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:36:59,740 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:36:59,743 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:36:59,743 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:36:59,743 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,745 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:36:59,745 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,746 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:36:59,751 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:36:59,752 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:36:59,753 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:36:59,753 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:36:59,763 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:36:59,765 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:36:59,765 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:36:59,766 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,767 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:36:59,767 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,768 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:36:59,769 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,771 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:36:59,771 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,773 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:36:59,773 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,775 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:36:59,775 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,777 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:36:59,777 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,779 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:36:59,780 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,782 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:36:59,782 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,783 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:36:59,783 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:36:59,788 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:36:59,791 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:36:59,791 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:36:59,791 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,793 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:36:59,793 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,795 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:36:59,795 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:36:59,796 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:36:59,796 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:36:59,800 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:36:59,803 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:36:59,808 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:36:59,809 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:36:59,815 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:36:59,815 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:36:59,821 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:36:59,824 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:36:59,832 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:36:59,832 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:36:59,841 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:36:59,850 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:36:59,856 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:36:59,861 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:36:59,870 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:36:59,874 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:36:59,878 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:36:59,882 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:36:59,885 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:36:59,889 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:36:59,900 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:36:59,907 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:36:59,912 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:36:59,919 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:36:59,925 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:36:59,930 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:36:59,933 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:36:59,936 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:39:39,120 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:39,120 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:39:39,131 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:39,134 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:39,134 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:39:39,135 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,137 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:39:39,137 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,139 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:39:39,140 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,141 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:39:39,142 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,143 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:39:39,144 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,147 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:39:39,148 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:39:39,149 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:39:39,149 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:39:39,150 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:39:39,154 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:39:39,155 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:39,156 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:39:39,164 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:39,166 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:39,167 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:39:39,167 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,168 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:39:39,169 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,171 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:39:39,172 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,174 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:39:39,174 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,176 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:39:39,176 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,177 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:39:39,178 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,179 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:39,179 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:39:39,183 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:39,186 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:39,186 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:39:39,186 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,189 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:39:39,190 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,190 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:39:39,196 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:39:39,198 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:39:39,198 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:39,199 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:39:39,211 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:39,213 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:39,213 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:39:39,214 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,215 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:39:39,216 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,217 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:39:39,217 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,220 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:39:39,221 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,223 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:39:39,223 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,225 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:39:39,225 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,226 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:39:39,227 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,228 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:39:39,229 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,230 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:39:39,231 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,231 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:39,231 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:39:39,238 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:39,240 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:39,240 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:39:39,241 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,242 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:39:39,242 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,244 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:39:39,244 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:39,244 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:39:39,245 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:39:39,248 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:39:39,252 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:39:39,256 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:39:39,258 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:39:39,263 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:39:39,263 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:39:39,270 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:39:39,273 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:39:39,278 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:39:39,279 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:39:39,287 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:39:39,296 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:39:39,303 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:39:39,308 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:39:39,312 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:39:39,316 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:39:39,319 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:39:39,323 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:39:39,326 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:39:39,330 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:39:39,331 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:39:39,335 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:39:39,340 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:39:39,346 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:39:39,350 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:39:39,354 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:39:39,358 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:39:39,362 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:39:39,362 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:39:39,368 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:39:39,373 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:39:39,379 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:39:39,382 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:39:39,386 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:39:39,390 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:39:39,394 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:39:52,313 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:52,313 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:39:52,324 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:52,326 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:52,327 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:39:52,327 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,329 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:39:52,329 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,330 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:39:52,331 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,332 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:39:52,333 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,336 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:39:52,336 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,338 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:39:52,340 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:39:52,341 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:39:52,341 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:39:52,341 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:39:52,346 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:39:52,346 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:52,347 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:39:52,358 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:52,360 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:52,361 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:39:52,361 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,362 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:39:52,363 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,364 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:39:52,365 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,367 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:39:52,368 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,369 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:39:52,369 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,370 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:39:52,371 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,371 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:52,371 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:39:52,376 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:52,378 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:52,379 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:39:52,379 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,380 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:39:52,381 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,382 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:39:52,386 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:39:52,387 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:39:52,388 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:52,389 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:39:52,401 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:52,403 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:52,404 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:39:52,404 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,405 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:39:52,406 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,408 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:39:52,409 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,410 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:39:52,411 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,412 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:39:52,412 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,414 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:39:52,414 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,416 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:39:52,417 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,418 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:39:52,418 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,420 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:39:52,420 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,421 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:39:52,421 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:39:52,427 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:39:52,430 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:39:52,430 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:39:52,430 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,431 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:39:52,432 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,434 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:39:52,434 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:39:52,434 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:39:52,435 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:39:52,438 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:39:52,441 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:39:52,446 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:39:52,448 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:39:52,452 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:39:52,452 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:39:52,458 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:39:52,461 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:39:52,467 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:39:52,468 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:39:52,474 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:39:52,483 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:39:52,488 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:39:52,495 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:39:52,498 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:39:52,501 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:39:52,504 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:39:52,509 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:39:52,512 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:39:52,515 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:39:52,516 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:39:52,521 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:39:52,527 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:39:52,533 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:39:52,537 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:39:52,542 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:39:52,546 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:39:52,549 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:39:52,550 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 21:39:52,556 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 21:39:52,560 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 21:39:52,563 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 21:39:52,570 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 21:39:52,574 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:39:52,578 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 21:54:53,172 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:54:53,173 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:54:53,184 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:54:53,186 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:54:53,186 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:54:53,187 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,188 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:54:53,189 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,190 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:54:53,190 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,193 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:54:53,193 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,195 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:54:53,196 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,199 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:54:53,201 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:54:53,201 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:54:53,201 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:54:53,202 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:54:53,208 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:54:53,209 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:54:53,209 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:54:53,219 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:54:53,222 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:54:53,222 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:54:53,223 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,226 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:54:53,227 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,229 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:54:53,229 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,231 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:54:53,231 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,233 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:54:53,233 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,235 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:54:53,236 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,236 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:54:53,236 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:54:53,244 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:54:53,246 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:54:53,246 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:54:53,247 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,248 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:54:53,249 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,249 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:54:53,253 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:54:53,256 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:54:53,257 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:54:53,257 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:54:53,268 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:54:53,271 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:54:53,272 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:54:53,272 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,274 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:54:53,274 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,277 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:54:53,277 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,279 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:54:53,279 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,281 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:54:53,281 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,283 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:54:53,284 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,285 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:54:53,285 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,287 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:54:53,288 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,290 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:54:53,290 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,291 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:54:53,292 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:54:53,299 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:54:53,300 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:54:53,301 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:54:53,301 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,303 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:54:53,303 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,305 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:54:53,305 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:54:53,306 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:54:53,306 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:54:53,310 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:54:53,314 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:54:53,319 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:54:53,322 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:54:53,328 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:54:53,328 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:54:53,335 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:54:53,337 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:54:53,345 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:54:53,345 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:54:53,356 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:54:53,367 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:54:53,372 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:54:53,380 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:54:53,385 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:54:53,388 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:54:53,393 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:54:53,397 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:54:53,401 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:54:53,405 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:54:53,405 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:54:53,413 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:54:53,418 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:54:53,423 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:54:53,429 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:54:53,433 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:54:53,437 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:54:53,443 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:54:53,444 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 21:54:53,448 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 21:54:53,452 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 21:54:53,456 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 21:54:53,463 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 21:54:53,479 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:54:53,524 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 21:54:53,582 [INFO] pc_project: Merged all levels — final shape: (5, 15)
2025-10-25 21:55:06,873 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:06,873 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:55:06,885 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:06,887 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:06,888 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:55:06,888 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,890 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:55:06,891 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,893 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:55:06,894 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,895 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:55:06,896 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,898 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:55:06,898 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,901 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:55:06,903 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:55:06,904 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:55:06,904 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:55:06,904 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:55:06,911 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:55:06,911 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:06,912 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:55:06,921 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:06,924 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:06,925 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:55:06,926 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,927 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:55:06,927 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,929 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:55:06,930 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,931 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:55:06,931 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,932 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:55:06,933 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,934 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:55:06,935 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,935 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:06,935 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:55:06,942 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:06,944 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:06,945 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:55:06,945 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,947 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:55:06,947 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,948 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:55:06,954 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:55:06,956 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:55:06,957 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:06,957 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:55:06,967 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:06,970 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:06,971 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:55:06,971 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,972 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:55:06,973 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,974 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:55:06,974 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,976 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:55:06,976 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,978 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:55:06,978 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,980 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:55:06,981 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,983 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:55:06,984 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,985 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:55:06,987 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,989 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:55:06,989 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:06,990 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:06,990 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:55:06,996 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:06,999 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:06,999 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:55:06,999 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:07,001 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:55:07,002 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:07,004 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:55:07,004 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:07,004 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:55:07,005 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:55:07,008 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:55:07,012 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:55:07,019 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:55:07,021 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:55:07,025 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:55:07,026 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:55:07,033 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:55:07,037 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:55:07,043 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:55:07,043 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:55:07,052 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:55:07,059 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:55:07,065 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:55:07,071 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:55:07,075 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:55:07,079 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:55:07,083 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:55:07,086 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:55:07,090 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:55:07,093 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:55:07,094 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:55:07,101 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:55:07,105 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:55:07,108 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:55:07,116 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:55:07,120 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:55:07,123 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:55:07,128 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:55:07,129 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 21:55:07,134 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 21:55:07,138 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 21:55:07,143 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 21:55:07,150 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 21:55:07,153 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:55:07,156 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 21:55:07,173 [INFO] pc_project: Merged all levels — final shape: (5, 15)
2025-10-25 21:55:23,878 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:23,878 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:55:23,888 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:23,891 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:23,892 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:55:23,892 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:23,894 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:55:23,895 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:23,896 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:55:23,896 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:23,898 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:55:23,900 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:23,902 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:55:23,902 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:23,905 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:55:23,915 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:55:23,921 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:55:23,922 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:55:23,926 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:55:23,955 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:55:23,980 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:23,986 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:55:24,036 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:24,038 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:24,041 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:55:24,042 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,098 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:55:24,104 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,110 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:55:24,119 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,128 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:55:24,138 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,150 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:55:24,150 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,152 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:55:24,152 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,153 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:24,153 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:55:24,158 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:24,161 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:24,161 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:55:24,162 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,163 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:55:24,164 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,165 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:55:24,169 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:55:24,170 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:55:24,171 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:24,171 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:55:24,182 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:24,184 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:24,184 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:55:24,184 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,186 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:55:24,192 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,194 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:55:24,195 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,199 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:55:24,200 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,204 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:55:24,206 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,208 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:55:24,209 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,214 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:55:24,215 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,217 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:55:24,218 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,222 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:55:24,222 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,223 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:55:24,224 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:55:24,236 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:55:24,238 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:55:24,239 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:55:24,239 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,240 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:55:24,241 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,243 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:55:24,243 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:55:24,244 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:55:24,248 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:55:24,251 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:55:24,255 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:55:24,260 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:55:24,262 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:55:24,268 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:55:24,268 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:55:24,274 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:55:24,278 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:55:24,284 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:55:24,284 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:55:24,294 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:55:24,302 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:55:24,307 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:55:24,314 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:55:24,319 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:55:24,322 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:55:24,326 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:55:24,329 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:55:24,333 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:55:24,336 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:55:24,337 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:55:24,343 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:55:24,349 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:55:24,354 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:55:24,359 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:55:24,364 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:55:24,367 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:55:24,371 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:55:24,371 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 21:55:24,376 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 21:55:24,380 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 21:55:24,384 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 21:55:24,390 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 21:55:24,393 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:55:24,397 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 21:55:24,413 [INFO] pc_project: Merged all levels — final shape: (5, 15)
2025-10-25 21:56:47,419 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:56:47,420 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 21:56:47,434 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:56:47,437 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:56:47,437 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 21:56:47,437 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,440 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 21:56:47,440 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,443 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 21:56:47,444 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,445 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 21:56:47,446 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,447 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 21:56:47,447 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,451 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 21:56:47,453 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 21:56:47,454 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 21:56:47,454 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 21:56:47,454 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 21:56:47,460 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 21:56:47,461 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:56:47,461 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 21:56:47,472 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:56:47,475 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:56:47,475 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 21:56:47,476 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,477 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:56:47,477 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,478 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 21:56:47,479 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,480 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 21:56:47,481 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,483 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 21:56:47,483 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,485 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 21:56:47,485 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,486 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:56:47,486 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 21:56:47,492 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:56:47,494 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:56:47,494 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 21:56:47,495 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,496 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 21:56:47,496 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,497 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 21:56:47,503 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 21:56:47,505 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 21:56:47,505 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:56:47,506 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 21:56:47,515 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:56:47,520 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:56:47,520 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 21:56:47,520 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,522 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 21:56:47,522 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,524 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 21:56:47,525 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,527 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 21:56:47,527 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,528 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 21:56:47,529 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,530 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 21:56:47,531 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,532 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 21:56:47,533 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,533 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 21:56:47,533 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,537 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 21:56:47,538 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,538 [INFO] pc_project: Starting data cleaning.
2025-10-25 21:56:47,539 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 21:56:47,544 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 21:56:47,547 [INFO] pc_project: Data cleaning complete.
2025-10-25 21:56:47,548 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 21:56:47,548 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,552 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 21:56:47,552 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,554 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 21:56:47,554 [INFO] pc_project: --------------------------------------------------
2025-10-25 21:56:47,555 [INFO] pc_project: Starting merge pipeline...
2025-10-25 21:56:47,555 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 21:56:47,559 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 21:56:47,562 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 21:56:47,566 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 21:56:47,570 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 21:56:47,575 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 21:56:47,575 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 21:56:47,581 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 21:56:47,581 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 21:56:47,590 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 21:56:47,591 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 21:56:47,598 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 21:56:47,607 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:56:47,612 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 21:56:47,620 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 21:56:47,623 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 21:56:47,626 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 21:56:47,629 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 21:56:47,631 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 21:56:47,639 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:56:47,643 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 21:56:47,644 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 21:56:47,650 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:56:47,655 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 21:56:47,661 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 21:56:47,665 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 21:56:47,672 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 21:56:47,676 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:56:47,680 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 21:56:47,681 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 21:56:47,686 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 21:56:47,689 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 21:56:47,696 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 21:56:47,697 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 21:56:47,706 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 21:56:47,708 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 21:56:47,715 [INFO] pc_project: Merged all levels — final shape: (5, 15)
2025-10-25 22:09:51,798 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:09:51,798 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 22:09:51,820 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:09:51,824 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:09:51,825 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 22:09:51,825 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,827 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 22:09:51,828 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,830 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 22:09:51,830 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,832 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 22:09:51,833 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,835 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 22:09:51,835 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,835 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 22:09:51,840 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 22:09:51,840 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 22:09:51,841 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 22:09:51,841 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 22:09:51,848 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 22:09:51,849 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:09:51,849 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 22:09:51,860 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:09:51,862 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:09:51,863 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 22:09:51,863 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,865 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:09:51,866 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,867 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 22:09:51,868 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,869 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 22:09:51,871 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,872 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 22:09:51,873 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,874 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 22:09:51,875 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,875 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:09:51,876 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 22:09:51,880 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:09:51,883 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:09:51,884 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 22:09:51,884 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,885 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 22:09:51,886 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,886 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 22:09:51,890 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 22:09:51,891 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 22:09:51,892 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:09:51,893 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 22:09:51,903 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:09:51,905 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:09:51,905 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 22:09:51,906 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,907 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:09:51,907 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,909 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 22:09:51,909 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,911 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 22:09:51,911 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,912 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 22:09:51,913 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,916 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 22:09:51,916 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,918 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 22:09:51,919 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,920 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 22:09:51,921 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,922 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 22:09:51,922 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,922 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:09:51,924 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 22:09:51,929 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:09:51,931 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:09:51,932 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 22:09:51,932 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,933 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 22:09:51,934 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,936 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 22:09:51,936 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:09:51,936 [INFO] pc_project: Starting merge pipeline...
2025-10-25 22:09:51,937 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 22:09:51,942 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 22:09:51,946 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 22:09:51,952 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 22:09:51,954 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 22:09:51,960 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 22:09:51,961 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 22:09:51,970 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 22:09:51,975 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 22:09:51,983 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 22:09:51,983 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 22:09:51,995 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 22:09:52,007 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:09:52,014 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:09:52,019 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 22:09:52,029 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 22:09:52,032 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 22:09:52,033 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 22:09:52,039 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 22:09:52,043 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:09:52,046 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 22:09:52,047 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 22:09:52,053 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:09:52,058 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:09:52,063 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 22:09:52,068 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 22:09:52,072 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 22:09:52,077 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:09:52,080 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 22:09:52,081 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 22:09:52,085 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 22:09:52,090 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 22:09:52,095 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 22:09:52,103 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 22:09:52,106 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:09:52,109 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 22:09:52,128 [INFO] pc_project: Merged all levels — final shape: (5, 15)
2025-10-25 22:10:15,954 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:10:15,955 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 22:10:15,967 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:10:15,970 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:10:15,971 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 22:10:15,971 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:15,974 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 22:10:15,974 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:15,976 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 22:10:15,976 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:15,979 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 22:10:15,979 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:15,981 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 22:10:15,981 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:15,984 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 22:10:15,986 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 22:10:15,986 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 22:10:15,987 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 22:10:15,987 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 22:10:15,992 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 22:10:15,993 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:10:15,993 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 22:10:16,004 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:10:16,007 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:10:16,007 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 22:10:16,007 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,009 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:10:16,010 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,011 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 22:10:16,012 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,013 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 22:10:16,014 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,015 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 22:10:16,015 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,017 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 22:10:16,018 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,018 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:10:16,019 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 22:10:16,024 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:10:16,026 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:10:16,027 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 22:10:16,027 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,029 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 22:10:16,029 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,029 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 22:10:16,035 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 22:10:16,036 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 22:10:16,037 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:10:16,037 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 22:10:16,047 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:10:16,050 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:10:16,050 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 22:10:16,050 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,052 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:10:16,052 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,054 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 22:10:16,055 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,056 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 22:10:16,057 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,058 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 22:10:16,059 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,061 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 22:10:16,061 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,062 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 22:10:16,062 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,064 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 22:10:16,064 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,066 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 22:10:16,066 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,067 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:10:16,067 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 22:10:16,074 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:10:16,076 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:10:16,076 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 22:10:16,077 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,079 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 22:10:16,079 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,080 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 22:10:16,081 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:10:16,081 [INFO] pc_project: Starting merge pipeline...
2025-10-25 22:10:16,082 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 22:10:16,085 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 22:10:16,090 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 22:10:16,094 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 22:10:16,095 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 22:10:16,100 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 22:10:16,101 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 22:10:16,107 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 22:10:16,110 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 22:10:16,115 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 22:10:16,116 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 22:10:16,123 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 22:10:16,131 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:10:16,138 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:10:16,143 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 22:10:16,147 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 22:10:16,150 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 22:10:16,154 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 22:10:16,157 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 22:10:16,162 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:10:16,166 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 22:10:16,166 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 22:10:16,172 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:10:16,176 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:10:16,181 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 22:10:16,187 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 22:10:16,191 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 22:10:16,194 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:10:16,197 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 22:10:16,198 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 22:10:16,203 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 22:10:16,207 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 22:10:16,211 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 22:10:16,218 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 22:10:16,221 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:10:16,226 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 22:10:16,247 [INFO] pc_project: Merged all levels — final shape: (5, 15)
2025-10-25 22:15:09,349 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:15:09,349 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 22:15:09,363 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:15:09,367 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:15:09,367 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 22:15:09,367 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,369 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 22:15:09,370 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,372 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 22:15:09,373 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,375 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 22:15:09,375 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,377 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 22:15:09,377 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,379 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 22:15:09,381 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 22:15:09,381 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 22:15:09,382 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 22:15:09,382 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 22:15:09,388 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 22:15:09,390 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:15:09,390 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 22:15:09,402 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:15:09,406 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:15:09,406 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 22:15:09,406 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,408 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:15:09,408 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,410 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 22:15:09,410 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,411 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 22:15:09,412 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,413 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 22:15:09,413 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,415 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 22:15:09,416 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,416 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:15:09,416 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 22:15:09,423 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:15:09,425 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:15:09,425 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 22:15:09,426 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,427 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 22:15:09,427 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,428 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 22:15:09,432 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 22:15:09,433 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 22:15:09,434 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:15:09,434 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 22:15:09,444 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:15:09,446 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:15:09,447 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 22:15:09,447 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,448 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:15:09,449 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,450 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 22:15:09,451 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,453 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 22:15:09,453 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,455 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 22:15:09,455 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,457 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 22:15:09,458 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,459 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 22:15:09,460 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,461 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 22:15:09,461 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,463 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 22:15:09,463 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,464 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:15:09,464 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 22:15:09,470 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:15:09,472 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:15:09,473 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 22:15:09,473 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,474 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 22:15:09,475 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,477 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 22:15:09,477 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:15:09,477 [INFO] pc_project: Starting merge pipeline...
2025-10-25 22:15:09,478 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 22:15:09,480 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 22:15:09,487 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 22:15:09,491 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 22:15:09,492 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 22:15:09,498 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 22:15:09,498 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 22:15:09,504 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 22:15:09,508 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 22:15:09,514 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 22:15:09,514 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 22:15:09,524 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 22:15:09,534 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:15:09,540 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:15:09,545 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 22:15:09,551 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 22:15:09,554 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 22:15:09,558 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 22:15:09,561 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 22:15:09,566 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:15:09,570 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 22:15:09,570 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 22:15:09,576 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:15:09,582 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:15:09,588 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 22:15:09,593 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 22:15:09,597 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 22:15:09,601 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:15:09,604 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 22:15:09,605 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 22:15:09,610 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 22:15:09,614 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 22:15:09,618 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 22:15:09,624 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 22:15:09,629 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:15:09,632 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 22:16:08,760 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:16:08,761 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 22:16:08,773 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:16:08,775 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:16:08,775 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 22:16:08,777 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,779 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 22:16:08,779 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,781 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 22:16:08,782 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,783 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 22:16:08,784 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,786 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 22:16:08,787 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,789 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 22:16:08,792 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 22:16:08,793 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 22:16:08,793 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 22:16:08,793 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 22:16:08,797 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 22:16:08,798 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:16:08,798 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 22:16:08,809 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:16:08,811 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:16:08,811 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 22:16:08,811 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,812 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:16:08,813 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,814 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 22:16:08,814 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,816 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 22:16:08,816 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,818 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 22:16:08,818 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,820 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 22:16:08,820 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,821 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:16:08,821 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 22:16:08,828 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:16:08,830 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:16:08,831 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 22:16:08,831 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,832 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 22:16:08,833 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,833 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 22:16:08,841 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 22:16:08,842 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 22:16:08,843 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:16:08,843 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 22:16:08,852 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:16:08,854 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:16:08,855 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 22:16:08,855 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,857 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:16:08,857 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,859 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 22:16:08,860 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,862 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 22:16:08,862 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,864 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 22:16:08,864 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,866 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 22:16:08,867 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,869 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 22:16:08,869 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,871 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 22:16:08,872 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,873 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 22:16:08,874 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,874 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:16:08,874 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 22:16:08,880 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:16:08,882 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:16:08,883 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 22:16:08,883 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,885 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 22:16:08,885 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,887 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 22:16:08,888 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:16:08,888 [INFO] pc_project: Starting merge pipeline...
2025-10-25 22:16:08,888 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 22:16:08,892 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 22:16:08,895 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 22:16:08,900 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 22:16:08,905 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 22:16:08,911 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 22:16:08,911 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 22:16:08,917 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 22:16:08,921 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 22:16:08,928 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 22:16:08,928 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 22:16:08,937 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 22:16:08,946 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:16:08,953 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:16:08,959 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 22:16:08,963 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 22:16:08,966 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 22:16:08,970 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 22:16:08,974 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 22:16:08,977 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:16:08,982 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 22:16:08,983 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 22:16:08,991 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:16:08,997 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:16:09,003 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 22:16:09,008 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 22:16:09,012 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 22:16:09,015 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:16:09,019 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 22:16:09,019 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 22:16:09,024 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 22:16:09,029 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 22:16:09,032 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 22:16:09,039 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 22:16:09,043 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:16:09,046 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 22:17:16,709 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:17:16,710 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 22:17:16,720 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:17:16,723 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:17:16,723 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 22:17:16,723 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,725 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 22:17:16,726 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,727 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 22:17:16,728 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,731 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 22:17:16,732 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,734 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 22:17:16,734 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,737 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 22:17:16,739 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 22:17:16,740 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 22:17:16,740 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 22:17:16,740 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 22:17:16,748 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 22:17:16,748 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:17:16,749 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 22:17:16,760 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:17:16,763 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:17:16,763 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 22:17:16,764 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,765 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:17:16,766 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,768 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 22:17:16,768 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,770 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 22:17:16,771 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,772 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 22:17:16,773 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,775 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 22:17:16,775 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,776 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:17:16,776 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 22:17:16,782 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:17:16,785 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:17:16,785 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 22:17:16,785 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,787 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 22:17:16,787 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,788 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 22:17:16,794 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 22:17:16,795 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 22:17:16,796 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:17:16,796 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 22:17:16,805 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:17:16,807 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:17:16,808 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 22:17:16,808 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,810 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:17:16,810 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,812 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 22:17:16,812 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,814 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 22:17:16,814 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,815 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 22:17:16,816 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,817 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 22:17:16,817 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,819 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 22:17:16,819 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,820 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 22:17:16,821 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,822 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 22:17:16,823 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,823 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:17:16,824 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 22:17:16,830 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:17:16,832 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:17:16,832 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 22:17:16,833 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,834 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 22:17:16,834 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,836 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 22:17:16,836 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:17:16,837 [INFO] pc_project: Starting merge pipeline...
2025-10-25 22:17:16,837 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 22:17:16,841 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 22:17:16,844 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 22:17:16,848 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 22:17:16,850 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 22:17:16,856 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 22:17:16,856 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 22:17:16,861 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 22:17:16,864 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 22:17:16,870 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 22:17:16,871 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 22:17:16,878 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 22:17:16,885 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:17:16,890 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:17:16,896 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 22:17:16,899 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 22:17:16,904 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 22:17:16,907 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 22:17:16,910 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 22:17:16,913 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:17:16,916 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 22:17:16,916 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 22:17:16,923 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:17:16,928 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:17:16,933 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 22:17:16,939 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 22:17:16,942 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 22:17:16,945 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:17:16,948 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 22:17:16,949 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 22:17:16,954 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 22:17:16,958 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 22:17:16,962 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 22:17:16,969 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 22:17:16,974 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:17:16,977 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 22:20:17,429 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:20:17,430 [INFO] pc_project: Input shape: (137, 6)
2025-10-25 22:20:17,440 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:20:17,442 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:20:17,442 [INFO] pc_project: Output shape: (137, 6)
2025-10-25 22:20:17,443 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,445 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-25 22:20:17,445 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,447 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-25 22:20:17,447 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,449 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-25 22:20:17,449 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,451 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-25 22:20:17,451 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,454 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-25 22:20:17,457 [INFO] pc_project: Applied cash flow sign convention.
2025-10-25 22:20:17,457 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-25 22:20:17,457 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-25 22:20:17,458 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-25 22:20:17,463 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-25 22:20:17,464 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:20:17,464 [INFO] pc_project: Input shape: (5, 10)
2025-10-25 22:20:17,476 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:20:17,478 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:20:17,479 [INFO] pc_project: Output shape: (5, 10)
2025-10-25 22:20:17,479 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,480 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:20:17,481 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,483 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-25 22:20:17,484 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,486 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-25 22:20:17,486 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,488 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-25 22:20:17,488 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,490 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-25 22:20:17,490 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,491 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:20:17,491 [INFO] pc_project: Input shape: (48, 3)
2025-10-25 22:20:17,497 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:20:17,501 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:20:17,501 [INFO] pc_project: Output shape: (48, 3)
2025-10-25 22:20:17,501 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,503 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-25 22:20:17,504 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,504 [INFO] pc_project: Starting curve cleaning process...
2025-10-25 22:20:17,509 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-25 22:20:17,510 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-25 22:20:17,511 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:20:17,511 [INFO] pc_project: Input shape: (5, 8)
2025-10-25 22:20:17,524 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:20:17,526 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:20:17,526 [INFO] pc_project: Output shape: (5, 8)
2025-10-25 22:20:17,526 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,528 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-25 22:20:17,528 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,530 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-25 22:20:17,530 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,534 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-25 22:20:17,534 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,535 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-25 22:20:17,536 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,537 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-25 22:20:17,538 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,539 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-25 22:20:17,540 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,541 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-25 22:20:17,542 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,543 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-25 22:20:17,543 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,544 [INFO] pc_project: Starting data cleaning.
2025-10-25 22:20:17,545 [INFO] pc_project: Input shape: (2, 6)
2025-10-25 22:20:17,552 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-25 22:20:17,554 [INFO] pc_project: Data cleaning complete.
2025-10-25 22:20:17,554 [INFO] pc_project: Output shape: (2, 6)
2025-10-25 22:20:17,554 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,556 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-25 22:20:17,557 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,558 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-25 22:20:17,558 [INFO] pc_project: --------------------------------------------------
2025-10-25 22:20:17,559 [INFO] pc_project: Starting merge pipeline...
2025-10-25 22:20:17,559 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-25 22:20:17,564 [INFO] pc_project: After structure merge: (137, 14)
2025-10-25 22:20:17,571 [INFO] pc_project: After terms merge: (137, 24)
2025-10-25 22:20:17,575 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-25 22:20:17,576 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-25 22:20:17,583 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-25 22:20:17,583 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-25 22:20:17,589 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-25 22:20:17,592 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-25 22:20:17,598 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-25 22:20:17,599 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-25 22:20:17,609 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-25 22:20:17,617 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:20:17,624 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-25 22:20:17,629 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-25 22:20:17,634 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-25 22:20:17,638 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-25 22:20:17,641 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-25 22:20:17,644 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-25 22:20:17,647 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:20:17,650 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-25 22:20:17,651 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-25 22:20:17,657 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:20:17,662 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-25 22:20:17,666 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-25 22:20:17,671 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-25 22:20:17,676 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-25 22:20:17,679 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:20:17,683 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-25 22:20:17,683 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-25 22:20:17,688 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-25 22:20:17,693 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-25 22:20:17,697 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-25 22:20:17,703 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-25 22:20:17,708 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-25 22:20:17,711 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-25 22:20:17,737 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-25 22:20:17,737 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-25 22:20:17,739 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 09:42:46,909 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:42:46,910 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 09:42:46,924 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:42:46,927 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:42:46,927 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 09:42:46,927 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,930 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 09:42:46,930 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,932 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 09:42:46,932 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,935 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 09:42:46,936 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,938 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 09:42:46,939 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,942 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 09:42:46,944 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 09:42:46,944 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 09:42:46,945 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 09:42:46,945 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 09:42:46,970 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 09:42:46,970 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:42:46,971 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 09:42:46,980 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:42:46,982 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:42:46,982 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 09:42:46,982 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,984 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 09:42:46,985 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,986 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 09:42:46,987 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,989 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 09:42:46,989 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,991 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 09:42:46,991 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,992 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 09:42:46,993 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:46,993 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:42:46,994 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 09:42:46,999 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:42:47,002 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:42:47,003 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 09:42:47,003 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,006 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 09:42:47,006 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,007 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 09:42:47,013 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 09:42:47,014 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 09:42:47,015 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:42:47,015 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 09:42:47,029 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:42:47,030 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:42:47,031 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 09:42:47,031 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,033 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 09:42:47,034 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,036 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 09:42:47,036 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,038 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 09:42:47,039 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,040 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 09:42:47,041 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,042 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 09:42:47,043 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,044 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 09:42:47,045 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,047 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 09:42:47,048 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,049 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 09:42:47,050 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,050 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:42:47,051 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 09:42:47,057 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:42:47,060 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:42:47,060 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 09:42:47,061 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,062 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 09:42:47,063 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,064 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 09:42:47,064 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:42:47,065 [INFO] pc_project: Starting merge pipeline...
2025-10-26 09:42:47,065 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 09:42:47,074 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 09:42:47,079 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 09:42:47,085 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 09:42:47,088 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 09:42:47,102 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 09:42:47,102 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 09:42:47,112 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 09:42:47,114 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 09:42:47,123 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 09:42:47,124 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 09:42:47,150 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 09:42:47,184 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 09:42:47,191 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 09:42:47,196 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 09:42:47,206 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 09:42:47,210 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 09:42:47,213 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 09:42:47,217 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 09:42:47,222 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 09:42:47,227 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 09:42:47,227 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 09:42:47,235 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 09:42:47,240 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 09:42:47,247 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 09:42:47,254 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 09:42:47,260 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 09:42:47,264 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 09:42:47,271 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 09:42:47,272 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 09:42:47,277 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 09:42:47,281 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 09:42:47,287 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 09:42:47,294 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 09:42:47,299 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 09:42:47,303 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 09:42:47,327 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 09:42:47,327 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 09:42:47,329 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 09:51:01,157 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:51:01,157 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 09:51:01,172 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:51:01,175 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:51:01,176 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 09:51:01,176 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,178 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 09:51:01,179 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,181 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 09:51:01,181 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,183 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 09:51:01,184 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,186 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 09:51:01,187 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,189 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 09:51:01,191 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 09:51:01,192 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 09:51:01,192 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 09:51:01,192 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 09:51:01,199 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 09:51:01,200 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:51:01,200 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 09:51:01,209 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:51:01,212 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:51:01,213 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 09:51:01,213 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,214 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 09:51:01,215 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,217 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 09:51:01,218 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,219 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 09:51:01,220 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,221 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 09:51:01,222 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,223 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 09:51:01,223 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,224 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:51:01,225 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 09:51:01,230 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:51:01,232 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:51:01,233 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 09:51:01,233 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,235 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 09:51:01,236 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,236 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 09:51:01,241 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 09:51:01,242 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 09:51:01,243 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:51:01,243 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 09:51:01,253 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:51:01,255 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:51:01,255 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 09:51:01,255 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,256 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 09:51:01,257 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,259 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 09:51:01,259 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,261 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 09:51:01,262 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,263 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 09:51:01,263 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,265 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 09:51:01,265 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,267 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 09:51:01,268 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,270 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 09:51:01,270 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,272 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 09:51:01,272 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,273 [INFO] pc_project: Starting data cleaning.
2025-10-26 09:51:01,274 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 09:51:01,280 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 09:51:01,282 [INFO] pc_project: Data cleaning complete.
2025-10-26 09:51:01,283 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 09:51:01,283 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,285 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 09:51:01,286 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,287 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 09:51:01,287 [INFO] pc_project: --------------------------------------------------
2025-10-26 09:51:01,288 [INFO] pc_project: Starting merge pipeline...
2025-10-26 09:51:01,288 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 09:51:01,292 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 09:51:01,295 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 09:51:01,298 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 09:51:01,299 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 09:51:01,306 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 09:51:01,307 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 09:51:01,312 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 09:51:01,314 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 09:51:01,320 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 09:51:01,321 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 09:51:01,330 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 09:51:01,340 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 09:51:01,346 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 09:51:01,352 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 09:51:01,358 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 09:51:01,362 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 09:51:01,365 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 09:51:01,370 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 09:51:01,373 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 09:51:01,377 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 09:51:01,377 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 09:51:01,382 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 09:51:01,389 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 09:51:01,394 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 09:51:01,397 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 09:51:01,403 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 09:51:01,407 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 09:51:01,411 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 09:51:01,411 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 09:51:01,417 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 09:51:01,422 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 09:51:01,426 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 09:51:01,433 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 09:51:01,437 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 09:51:01,441 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 09:51:01,468 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 09:51:01,469 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 09:51:01,471 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 09:51:01,512 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 09:51:01,512 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'exit_date']
2025-10-26 09:51:01,514 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'exit_date': 0}
2025-10-26 10:03:57,457 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:03:57,457 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:03:57,472 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:03:57,474 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:03:57,474 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:03:57,474 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,476 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:03:57,477 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,478 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:03:57,479 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,480 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:03:57,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,482 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:03:57,483 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,485 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:03:57,487 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:03:57,487 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:03:57,487 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:03:57,487 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:03:57,493 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:03:57,494 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:03:57,494 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:03:57,505 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:03:57,508 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:03:57,508 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:03:57,508 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,510 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:03:57,510 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,511 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:03:57,512 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,513 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:03:57,514 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,515 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:03:57,516 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,517 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:03:57,518 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,518 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:03:57,519 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:03:57,524 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:03:57,526 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:03:57,527 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:03:57,527 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,528 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:03:57,529 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,530 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:03:57,536 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:03:57,537 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:03:57,538 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:03:57,538 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:03:57,548 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:03:57,550 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:03:57,551 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:03:57,551 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,553 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:03:57,554 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,555 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:03:57,556 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,557 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:03:57,558 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,560 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:03:57,560 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,562 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:03:57,563 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,565 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:03:57,565 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,567 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:03:57,567 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,569 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:03:57,569 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,570 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:03:57,570 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:03:57,575 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:03:57,578 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:03:57,578 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:03:57,579 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,580 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:03:57,580 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,581 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:03:57,582 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:03:57,582 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:03:57,583 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:03:57,586 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:03:57,589 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:03:57,594 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:03:57,596 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:03:57,601 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:03:57,602 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:03:57,609 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:03:57,610 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:03:57,618 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:03:57,619 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:03:57,627 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:03:57,635 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:03:57,640 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:03:57,646 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:03:57,650 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:03:57,653 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:03:57,656 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:03:57,661 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:03:57,665 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:03:57,668 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:03:57,669 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:03:57,676 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:03:57,681 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:03:57,686 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:03:57,691 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:03:57,696 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:03:57,700 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:03:57,703 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:03:57,703 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:03:57,709 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:03:57,713 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:03:57,718 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:03:57,725 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:03:57,729 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:03:57,732 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:03:57,756 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:03:57,756 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:03:57,759 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:03:57,799 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:03:57,800 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:03:57,801 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:06:26,188 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:06:26,189 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:06:26,205 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:06:26,209 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:06:26,210 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:06:26,210 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,212 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:06:26,213 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,216 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:06:26,217 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,219 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:06:26,219 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,221 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:06:26,222 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,227 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:06:26,230 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:06:26,231 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:06:26,232 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:06:26,232 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:06:26,238 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:06:26,238 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:06:26,239 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:06:26,254 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:06:26,256 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:06:26,257 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:06:26,257 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,260 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:06:26,260 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,262 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:06:26,263 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,264 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:06:26,265 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,266 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:06:26,267 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,268 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:06:26,268 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,269 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:06:26,269 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:06:26,276 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:06:26,278 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:06:26,279 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:06:26,279 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,280 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:06:26,281 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,281 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:06:26,287 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:06:26,288 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:06:26,290 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:06:26,290 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:06:26,300 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:06:26,303 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:06:26,304 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:06:26,304 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,305 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:06:26,306 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,307 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:06:26,308 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,309 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:06:26,310 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,312 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:06:26,312 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,314 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:06:26,314 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,315 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:06:26,316 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,317 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:06:26,318 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,320 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:06:26,320 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,321 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:06:26,321 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:06:26,327 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:06:26,329 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:06:26,330 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:06:26,330 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,331 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:06:26,332 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,333 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:06:26,334 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:06:26,334 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:06:26,336 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:06:26,339 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:06:26,344 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:06:26,348 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:06:26,351 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:06:26,356 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:06:26,357 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:06:26,363 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:06:26,366 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:06:26,372 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:06:26,372 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:06:26,382 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:06:26,393 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:06:26,401 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:06:26,406 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:06:26,410 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:06:26,413 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:06:26,416 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:06:26,421 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:06:26,424 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:06:26,427 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:06:26,427 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:06:26,433 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:06:26,438 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:06:26,444 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:06:26,449 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:06:26,453 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:06:26,456 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:06:26,460 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:06:26,460 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:06:26,466 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:06:26,470 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:06:26,473 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:06:26,479 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:06:26,483 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:06:26,486 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:06:26,514 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:06:26,514 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:06:26,517 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:06:26,564 [INFO] pc_project: clean_data_fund: rows=6 facilities=5
2025-10-26 10:06:26,564 [INFO] pc_project: clean_data_fund: columns=['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'credit_line', 'finance_draw_row', 'finance_draw_cum', 'undrawn', 'exit_date']
2025-10-26 10:07:38,797 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:38,798 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:07:38,806 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:38,811 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:38,812 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:07:38,812 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,814 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:07:38,815 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,817 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:07:38,818 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,820 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:07:38,821 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,822 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:07:38,823 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,825 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:07:38,827 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:07:38,828 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:07:38,828 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:07:38,828 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:07:38,833 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:07:38,834 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:38,834 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:07:38,845 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:38,846 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:38,847 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:07:38,847 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,849 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:07:38,849 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,851 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:07:38,851 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,853 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:07:38,853 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,855 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:07:38,855 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,856 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:07:38,857 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,858 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:38,858 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:07:38,862 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:38,865 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:38,865 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:07:38,865 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,866 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:07:38,867 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,867 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:07:38,872 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:07:38,874 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:07:38,874 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:38,875 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:07:38,884 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:38,886 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:38,887 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:07:38,887 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,889 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:07:38,889 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,891 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:07:38,892 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,893 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:07:38,894 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,895 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:07:38,896 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,897 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:07:38,897 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,899 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:07:38,900 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,901 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:07:38,902 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,904 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:07:38,905 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,905 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:38,905 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:07:38,910 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:38,912 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:38,912 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:07:38,913 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,914 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:07:38,914 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,915 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:07:38,916 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:38,916 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:07:38,917 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:07:38,920 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:07:38,924 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:07:38,928 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:07:38,929 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:07:38,935 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:07:38,936 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:07:38,941 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:07:38,943 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:07:38,951 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:07:38,951 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:07:38,957 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:07:38,965 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:07:38,970 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:07:38,976 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:07:38,980 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:07:38,983 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:07:38,986 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:07:38,990 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:07:38,993 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:07:38,996 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:07:38,997 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:07:39,003 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:07:39,008 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:07:39,013 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:07:39,019 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:07:39,023 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:07:39,027 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:07:39,033 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:07:39,033 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:07:39,038 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:07:39,042 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:07:39,047 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:07:39,054 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:07:39,058 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:07:39,062 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:07:39,083 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:07:39,083 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:07:39,084 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:07:39,119 [INFO] pc_project: clean_data_fund: rows=6 facilities=5
2025-10-26 10:07:39,120 [INFO] pc_project: clean_data_fund: columns=['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'credit_line', 'finance_draw_row', 'finance_draw_cum', 'undrawn', 'exit_date']
2025-10-26 10:07:54,577 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:54,577 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:07:54,587 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:54,591 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:54,591 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:07:54,592 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,593 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:07:54,594 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,596 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:07:54,596 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,598 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:07:54,599 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,601 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:07:54,601 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,604 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:07:54,606 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:07:54,606 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:07:54,606 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:07:54,607 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:07:54,611 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:07:54,612 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:54,613 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:07:54,621 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:54,624 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:54,624 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:07:54,624 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,626 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:07:54,627 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,629 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:07:54,630 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,631 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:07:54,632 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,633 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:07:54,634 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,635 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:07:54,635 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,636 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:54,636 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:07:54,640 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:54,642 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:54,642 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:07:54,642 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,645 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:07:54,645 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,646 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:07:54,650 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:07:54,651 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:07:54,652 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:54,652 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:07:54,662 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:54,664 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:54,665 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:07:54,665 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,667 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:07:54,667 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,669 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:07:54,669 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,671 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:07:54,671 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,672 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:07:54,673 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,674 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:07:54,674 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,677 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:07:54,678 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,680 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:07:54,680 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,681 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:07:54,682 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,682 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:07:54,683 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:07:54,689 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:07:54,692 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:07:54,693 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:07:54,693 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,695 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:07:54,695 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,697 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:07:54,697 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:07:54,697 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:07:54,698 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:07:54,700 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:07:54,704 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:07:54,706 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:07:54,709 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:07:54,714 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:07:54,715 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:07:54,720 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:07:54,722 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:07:54,730 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:07:54,730 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:07:54,738 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:07:54,748 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:07:54,756 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:07:54,762 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:07:54,766 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:07:54,769 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:07:54,773 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:07:54,776 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:07:54,780 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:07:54,784 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:07:54,784 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:07:54,790 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:07:54,795 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:07:54,799 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:07:54,803 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:07:54,807 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:07:54,811 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:07:54,815 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:07:54,815 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:07:54,820 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:07:54,824 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:07:54,829 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:07:54,837 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:07:54,840 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:07:54,845 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:07:54,868 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:07:54,869 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:07:54,870 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:07:54,906 [INFO] pc_project: clean_data_fund: rows=6 facilities=5
2025-10-26 10:07:54,906 [INFO] pc_project: clean_data_fund: columns=['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'credit_line', 'finance_draw_row', 'finance_draw_cum', 'undrawn', 'exit_date']
2025-10-26 10:08:11,911 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:08:11,912 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:08:11,922 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:08:11,926 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:08:11,926 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:08:11,926 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,929 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:08:11,929 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,931 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:08:11,931 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,934 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:08:11,934 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,936 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:08:11,936 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,939 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:08:11,940 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:08:11,941 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:08:11,941 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:08:11,941 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:08:11,947 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:08:11,947 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:08:11,948 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:08:11,956 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:08:11,959 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:08:11,959 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:08:11,960 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,962 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:08:11,962 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,964 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:08:11,965 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,966 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:08:11,966 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,968 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:08:11,968 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,970 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:08:11,970 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,970 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:08:11,971 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:08:11,975 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:08:11,977 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:08:11,979 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:08:11,979 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,981 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:08:11,982 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:11,982 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:08:11,987 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:08:11,988 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:08:11,988 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:08:11,989 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:08:11,999 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:08:12,002 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:08:12,002 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:08:12,002 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,004 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:08:12,004 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,005 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:08:12,006 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,007 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:08:12,007 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,009 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:08:12,010 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,011 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:08:12,012 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,014 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:08:12,014 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,016 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:08:12,016 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,017 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:08:12,018 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,018 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:08:12,019 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:08:12,023 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:08:12,026 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:08:12,026 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:08:12,027 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,028 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:08:12,028 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,031 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:08:12,031 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:08:12,031 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:08:12,032 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:08:12,035 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:08:12,038 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:08:12,044 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:08:12,046 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:08:12,051 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:08:12,051 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:08:12,056 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:08:12,059 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:08:12,065 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:08:12,065 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:08:12,073 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:08:12,082 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:08:12,089 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:08:12,094 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:08:12,098 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:08:12,101 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:08:12,105 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:08:12,108 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:08:12,112 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:08:12,116 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:08:12,116 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:08:12,122 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:08:12,127 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:08:12,132 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:08:12,138 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:08:12,144 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:08:12,148 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:08:12,151 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:08:12,152 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:08:12,155 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:08:12,158 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:08:12,163 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:08:12,169 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:08:12,181 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:08:12,218 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:08:12,356 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:08:12,364 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:08:12,366 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:08:12,432 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:08:12,432 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:08:12,434 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:12:13,974 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:12:13,975 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:12:13,989 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:12:13,991 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:12:13,992 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:12:13,993 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:13,994 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:12:13,995 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:13,997 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:12:13,997 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,000 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:12:14,000 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,001 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:12:14,002 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,004 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:12:14,006 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:12:14,006 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:12:14,007 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:12:14,007 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:12:14,013 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:12:14,013 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:12:14,014 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:12:14,023 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:12:14,025 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:12:14,026 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:12:14,026 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,027 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:12:14,028 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,029 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:12:14,029 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,031 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:12:14,031 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,033 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:12:14,033 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,035 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:12:14,035 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,035 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:12:14,036 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:12:14,041 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:12:14,043 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:12:14,044 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:12:14,044 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,045 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:12:14,046 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,047 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:12:14,052 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:12:14,053 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:12:14,054 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:12:14,054 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:12:14,067 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:12:14,070 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:12:14,070 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:12:14,070 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,072 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:12:14,072 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,074 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:12:14,074 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,075 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:12:14,076 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,077 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:12:14,078 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,080 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:12:14,081 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,082 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:12:14,083 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,084 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:12:14,085 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,086 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:12:14,086 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,087 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:12:14,088 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:12:14,093 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:12:14,096 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:12:14,096 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:12:14,097 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,098 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:12:14,099 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,100 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:12:14,101 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:12:14,101 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:12:14,101 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:12:14,104 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:12:14,108 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:12:14,113 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:12:14,116 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:12:14,122 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:12:14,123 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:12:14,129 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:12:14,132 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:12:14,138 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:12:14,138 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:12:14,147 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:12:14,154 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:12:14,161 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:12:14,168 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:12:14,172 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:12:14,176 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:12:14,180 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:12:14,184 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:12:14,186 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:12:14,191 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:12:14,192 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:12:14,198 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:12:14,203 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:12:14,210 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:12:14,215 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:12:14,220 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:12:14,224 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:12:14,228 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:12:14,228 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:12:14,233 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:12:14,238 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:12:14,243 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:12:14,250 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:12:14,254 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:12:14,258 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:12:14,282 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:12:14,283 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:12:14,285 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:12:14,318 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:12:14,318 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:12:14,320 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:13:46,145 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:13:46,146 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:13:46,157 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:13:46,160 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:13:46,160 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:13:46,161 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,162 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:13:46,163 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,164 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:13:46,165 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,166 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:13:46,166 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,168 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:13:46,169 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,172 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:13:46,173 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:13:46,174 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:13:46,174 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:13:46,175 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:13:46,182 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:13:46,182 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:13:46,182 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:13:46,192 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:13:46,195 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:13:46,195 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:13:46,196 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,197 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:13:46,198 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,200 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:13:46,200 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,201 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:13:46,202 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,204 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:13:46,206 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,209 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:13:46,210 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,210 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:13:46,211 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:13:46,216 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:13:46,218 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:13:46,218 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:13:46,219 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,220 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:13:46,221 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,221 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:13:46,227 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:13:46,228 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:13:46,229 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:13:46,229 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:13:46,240 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:13:46,242 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:13:46,243 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:13:46,243 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,245 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:13:46,246 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,248 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:13:46,248 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,250 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:13:46,250 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,254 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:13:46,254 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,256 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:13:46,256 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,258 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:13:46,258 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,260 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:13:46,260 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,262 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:13:46,263 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,263 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:13:46,264 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:13:46,269 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:13:46,271 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:13:46,272 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:13:46,272 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,273 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:13:46,274 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,275 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:13:46,275 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:13:46,276 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:13:46,276 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:13:46,280 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:13:46,283 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:13:46,287 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:13:46,289 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:13:46,294 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:13:46,295 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:13:46,300 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:13:46,303 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:13:46,310 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:13:46,311 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:13:46,320 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:13:46,329 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:13:46,335 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:13:46,340 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:13:46,344 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:13:46,349 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:13:46,352 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:13:46,356 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:13:46,358 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:13:46,361 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:13:46,362 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:13:46,367 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:13:46,373 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:13:46,379 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:13:46,384 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:13:46,388 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:13:46,392 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:13:46,396 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:13:46,397 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:13:46,401 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:13:46,405 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:13:46,411 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:13:46,418 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:13:46,422 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:13:46,427 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:13:46,450 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:13:46,450 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:13:46,452 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:13:46,493 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:13:46,493 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:13:46,495 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:14:25,893 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:25,893 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:14:25,905 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:25,908 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:25,908 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:14:25,909 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,911 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:14:25,911 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,913 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:14:25,914 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,916 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:14:25,917 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,918 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:14:25,919 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,921 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:14:25,924 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:14:25,924 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:14:25,924 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:14:25,925 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:14:25,930 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:14:25,931 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:25,931 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:14:25,943 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:25,946 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:25,946 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:14:25,946 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,948 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:14:25,949 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,951 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:14:25,951 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,953 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:14:25,953 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,955 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:14:25,955 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,957 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:14:25,957 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,958 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:25,958 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:14:25,963 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:25,967 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:25,967 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:14:25,967 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,969 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:14:25,969 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:25,969 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:14:25,975 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:14:25,977 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:14:25,977 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:25,978 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:14:26,001 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:26,003 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:26,003 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:14:26,004 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,005 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:14:26,007 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,011 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:14:26,011 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,014 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:14:26,015 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,016 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:14:26,017 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,019 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:14:26,020 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,022 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:14:26,022 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,025 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:14:26,025 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,026 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:14:26,027 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,027 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:26,028 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:14:26,035 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:26,038 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:26,038 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:14:26,038 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,040 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:14:26,041 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,043 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:14:26,043 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:26,045 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:14:26,045 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:14:26,049 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:14:26,053 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:14:26,058 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:14:26,061 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:14:26,067 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:14:26,067 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:14:26,075 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:14:26,079 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:14:26,087 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:14:26,087 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:14:26,098 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:14:26,105 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:14:26,112 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:14:26,118 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:14:26,124 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:14:26,129 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:14:26,132 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:14:26,135 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:14:26,139 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:14:26,143 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:14:26,144 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:14:26,150 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:14:26,155 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:14:26,160 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:14:26,165 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:14:26,171 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:14:26,175 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:14:26,179 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:14:26,179 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:14:26,184 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:14:26,190 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:14:26,196 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:14:26,203 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:14:26,208 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:14:26,212 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:14:26,237 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:14:26,237 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:14:26,241 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:14:26,297 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:14:26,297 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:14:26,299 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:14:34,288 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:34,288 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:14:34,300 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:34,304 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:34,304 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:14:34,304 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,306 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:14:34,307 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,309 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:14:34,309 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,311 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:14:34,312 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,313 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:14:34,313 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,316 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:14:34,319 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:14:34,319 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:14:34,319 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:14:34,320 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:14:34,325 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:14:34,325 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:34,325 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:14:34,336 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:34,338 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:34,339 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:14:34,339 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,341 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:14:34,341 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,343 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:14:34,343 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,344 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:14:34,344 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,345 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:14:34,346 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,347 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:14:34,348 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,348 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:34,349 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:14:34,354 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:34,357 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:34,357 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:14:34,358 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,359 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:14:34,359 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,360 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:14:34,364 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:14:34,366 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:14:34,367 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:34,367 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:14:34,376 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:34,379 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:34,379 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:14:34,379 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,382 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:14:34,383 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,385 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:14:34,385 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,387 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:14:34,387 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,389 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:14:34,390 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,392 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:14:34,392 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,394 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:14:34,394 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,395 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:14:34,396 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,398 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:14:34,398 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,399 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:14:34,399 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:14:34,404 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:14:34,406 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:14:34,406 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:14:34,407 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,408 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:14:34,409 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,410 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:14:34,410 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:14:34,410 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:14:34,411 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:14:34,414 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:14:34,418 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:14:34,422 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:14:34,424 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:14:34,428 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:14:34,429 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:14:34,436 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:14:34,439 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:14:34,447 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:14:34,447 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:14:34,456 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:14:34,469 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:14:34,476 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:14:34,484 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:14:34,489 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:14:34,494 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:14:34,497 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:14:34,502 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:14:34,506 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:14:34,511 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:14:34,512 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:14:34,518 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:14:34,523 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:14:34,528 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:14:34,532 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:14:34,536 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:14:34,540 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:14:34,544 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:14:34,545 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:14:34,550 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:14:34,555 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:14:34,561 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:14:34,569 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:14:34,573 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:14:34,577 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:14:34,599 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:14:34,600 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:14:34,601 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:14:34,631 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:14:34,632 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:14:34,633 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:17:32,982 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:17:32,982 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:17:32,992 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:17:32,994 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:17:32,994 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:17:32,995 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:32,997 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:17:32,998 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:32,999 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:17:32,999 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,001 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:17:33,001 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,003 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:17:33,003 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,006 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:17:33,009 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:17:33,009 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:17:33,009 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:17:33,010 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:17:33,017 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:17:33,017 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:17:33,017 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:17:33,030 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:17:33,032 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:17:33,033 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:17:33,033 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,034 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:17:33,035 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,037 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:17:33,037 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,038 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:17:33,039 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,040 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:17:33,041 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,042 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:17:33,042 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,043 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:17:33,044 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:17:33,049 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:17:33,051 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:17:33,052 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:17:33,052 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,053 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:17:33,054 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,055 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:17:33,062 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:17:33,063 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:17:33,064 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:17:33,064 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:17:33,075 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:17:33,078 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:17:33,078 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:17:33,078 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,080 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:17:33,081 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,083 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:17:33,083 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,084 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:17:33,085 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,087 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:17:33,087 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,088 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:17:33,089 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,090 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:17:33,091 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,093 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:17:33,093 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,094 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:17:33,095 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,096 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:17:33,096 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:17:33,101 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:17:33,104 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:17:33,105 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:17:33,105 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,107 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:17:33,107 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,108 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:17:33,109 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:17:33,109 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:17:33,109 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:17:33,112 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:17:33,116 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:17:33,120 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:17:33,121 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:17:33,126 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:17:33,126 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:17:33,133 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:17:33,136 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:17:33,142 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:17:33,142 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:17:33,152 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:17:33,161 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:17:33,169 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:17:33,175 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:17:33,179 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:17:33,184 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:17:33,189 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:17:33,192 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:17:33,196 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:17:33,200 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:17:33,200 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:17:33,207 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:17:33,212 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:17:33,217 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:17:33,222 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:17:33,227 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:17:33,230 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:17:33,234 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:17:33,234 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:17:33,240 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:17:33,243 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:17:33,247 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:17:33,253 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:17:33,256 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:17:33,260 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:17:33,286 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:17:33,287 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:17:33,289 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:17:33,329 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:17:33,330 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:17:33,332 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:17:33,339 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 10:18:40,886 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:18:40,887 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:18:40,895 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:18:40,897 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:18:40,897 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:18:40,898 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,900 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:18:40,901 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,902 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:18:40,903 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,904 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:18:40,905 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,906 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:18:40,906 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,908 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:18:40,911 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:18:40,911 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:18:40,911 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:18:40,912 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:18:40,919 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:18:40,919 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:18:40,920 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:18:40,928 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:18:40,929 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:18:40,930 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:18:40,930 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,931 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:18:40,933 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,934 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:18:40,935 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,936 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:18:40,937 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,938 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:18:40,938 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,939 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:18:40,940 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,941 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:18:40,941 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:18:40,945 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:18:40,947 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:18:40,948 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:18:40,949 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,950 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:18:40,950 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,951 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:18:40,955 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:18:40,956 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:18:40,957 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:18:40,957 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:18:40,970 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:18:40,972 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:18:40,973 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:18:40,973 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,975 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:18:40,976 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,977 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:18:40,977 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,979 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:18:40,980 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,981 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:18:40,982 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,983 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:18:40,984 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,986 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:18:40,986 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,987 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:18:40,988 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,989 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:18:40,989 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,989 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:18:40,990 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:18:40,995 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:18:40,997 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:18:40,998 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:18:40,998 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:40,999 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:18:41,000 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:41,002 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:18:41,002 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:18:41,003 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:18:41,003 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:18:41,006 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:18:41,011 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:18:41,015 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:18:41,017 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:18:41,023 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:18:41,023 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:18:41,029 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:18:41,032 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:18:41,040 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:18:41,040 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:18:41,048 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:18:41,056 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:18:41,062 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:18:41,068 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:18:41,072 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:18:41,076 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:18:41,079 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:18:41,082 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:18:41,085 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:18:41,089 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:18:41,090 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:18:41,096 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:18:41,100 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:18:41,106 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:18:41,109 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:18:41,125 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:18:41,145 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:18:41,169 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:18:41,191 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:18:41,227 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:18:41,236 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:18:41,254 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:18:41,274 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:18:41,316 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:18:41,328 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:18:41,380 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:18:41,380 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:18:41,383 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:18:41,453 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:18:41,454 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'undrawn', 'exit_date']
2025-10-26 10:18:41,456 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'undrawn': 0, 'exit_date': 0}
2025-10-26 10:18:41,464 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 10:38:24,128 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:24,128 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:38:24,138 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:24,142 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:24,142 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:38:24,142 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,145 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:38:24,145 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,148 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:38:24,148 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,150 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:38:24,151 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,153 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:38:24,153 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,156 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:38:24,157 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:38:24,157 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:38:24,158 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:38:24,158 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:38:24,162 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:38:24,163 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:24,163 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:38:24,172 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:24,175 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:24,176 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:38:24,176 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,177 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:38:24,178 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,179 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:38:24,179 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,181 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:38:24,182 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,184 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:38:24,184 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,186 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:38:24,186 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,186 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:24,187 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:38:24,193 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:24,196 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:24,196 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:38:24,197 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,198 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:38:24,199 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,199 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:38:24,205 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:38:24,206 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:38:24,207 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:24,207 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:38:24,215 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:24,218 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:24,218 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:38:24,218 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,220 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:38:24,221 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,222 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:38:24,223 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,224 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:38:24,224 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,225 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:38:24,226 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,226 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:38:24,228 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,229 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:38:24,229 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,231 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:38:24,232 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,234 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:38:24,234 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,235 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:24,235 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:38:24,241 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:24,243 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:24,244 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:38:24,244 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,245 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:38:24,245 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,247 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:38:24,247 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:24,248 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:38:24,248 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:38:24,252 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:38:24,256 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:38:24,260 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:38:24,262 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:38:24,267 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:38:24,267 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:38:24,274 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:38:24,276 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:38:24,282 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:38:24,282 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:38:24,291 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:38:24,300 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:38:24,306 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:38:24,311 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:38:24,315 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:38:24,320 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:38:24,324 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:38:24,328 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:38:24,331 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:38:24,336 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:38:24,336 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:38:24,343 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:38:24,350 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:38:24,357 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:38:24,361 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:38:24,367 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:38:24,371 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:38:24,374 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:38:24,374 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:38:24,379 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:38:24,383 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:38:24,387 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:38:24,392 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:38:24,395 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:38:24,400 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:38:24,423 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:38:24,424 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:38:24,425 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:38:24,468 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:38:24,468 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 10:38:24,469 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 10:38:57,555 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:57,555 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 10:38:57,568 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:57,570 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:57,571 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 10:38:57,571 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,573 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 10:38:57,573 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,575 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 10:38:57,575 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,577 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 10:38:57,577 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,579 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 10:38:57,580 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,582 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 10:38:57,584 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 10:38:57,584 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 10:38:57,585 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 10:38:57,585 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 10:38:57,590 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 10:38:57,590 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:57,591 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 10:38:57,602 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:57,604 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:57,605 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 10:38:57,605 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,606 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:38:57,607 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,608 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 10:38:57,609 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,610 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 10:38:57,611 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,612 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 10:38:57,612 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,614 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 10:38:57,614 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,615 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:57,615 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 10:38:57,620 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:57,623 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:57,623 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 10:38:57,623 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,624 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 10:38:57,625 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,625 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 10:38:57,630 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 10:38:57,631 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 10:38:57,632 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:57,632 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 10:38:57,643 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:57,644 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:57,645 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 10:38:57,645 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,646 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 10:38:57,647 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,648 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 10:38:57,649 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,650 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 10:38:57,651 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,652 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 10:38:57,653 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,655 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 10:38:57,655 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,656 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 10:38:57,657 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,659 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 10:38:57,661 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,662 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 10:38:57,662 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,663 [INFO] pc_project: Starting data cleaning.
2025-10-26 10:38:57,663 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 10:38:57,669 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 10:38:57,671 [INFO] pc_project: Data cleaning complete.
2025-10-26 10:38:57,671 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 10:38:57,671 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,673 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 10:38:57,673 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,675 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 10:38:57,675 [INFO] pc_project: --------------------------------------------------
2025-10-26 10:38:57,676 [INFO] pc_project: Starting merge pipeline...
2025-10-26 10:38:57,676 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 10:38:57,679 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 10:38:57,682 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 10:38:57,686 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 10:38:57,689 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 10:38:57,694 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 10:38:57,694 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 10:38:57,700 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 10:38:57,703 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 10:38:57,709 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 10:38:57,709 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 10:38:57,717 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 10:38:57,726 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:38:57,730 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 10:38:57,739 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 10:38:57,743 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 10:38:57,746 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 10:38:57,750 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 10:38:57,754 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 10:38:57,758 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:38:57,761 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 10:38:57,761 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 10:38:57,766 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:38:57,772 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 10:38:57,777 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 10:38:57,781 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 10:38:57,786 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 10:38:57,789 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:38:57,793 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 10:38:57,794 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 10:38:57,799 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 10:38:57,804 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 10:38:57,808 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 10:38:57,815 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 10:38:57,818 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 10:38:57,822 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 10:38:57,843 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 10:38:57,844 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 10:38:57,845 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 10:38:57,883 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 10:38:57,883 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 10:38:57,885 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 10:38:57,899 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:02:40,843 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:02:40,844 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:02:40,855 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:02:40,858 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:02:40,858 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:02:40,859 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,860 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:02:40,861 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,862 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:02:40,863 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,865 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:02:40,865 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,867 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:02:40,868 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,871 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:02:40,874 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:02:40,875 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:02:40,875 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:02:40,875 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:02:40,880 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:02:40,881 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:02:40,881 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:02:40,893 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:02:40,896 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:02:40,896 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:02:40,896 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,898 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:02:40,898 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,900 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:02:40,901 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,902 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:02:40,903 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,904 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:02:40,904 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,906 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:02:40,906 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,907 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:02:40,907 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:02:40,913 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:02:40,915 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:02:40,915 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:02:40,915 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,917 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:02:40,918 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,918 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:02:40,924 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:02:40,925 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:02:40,926 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:02:40,926 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:02:40,939 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:02:40,941 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:02:40,942 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:02:40,942 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,944 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:02:40,944 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,946 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:02:40,946 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,947 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:02:40,948 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,950 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:02:40,950 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,952 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:02:40,952 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,953 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:02:40,954 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,956 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:02:40,956 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,958 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:02:40,958 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,959 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:02:40,959 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:02:40,964 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:02:40,967 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:02:40,967 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:02:40,968 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,969 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:02:40,969 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,971 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:02:40,972 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:02:40,972 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:02:40,972 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:02:40,976 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:02:40,979 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:02:40,987 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:02:40,989 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:02:40,995 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:02:40,995 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:02:41,003 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:02:41,006 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:02:41,013 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:02:41,014 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:02:41,023 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:02:41,032 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:02:41,038 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:02:41,043 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:02:41,048 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:02:41,051 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:02:41,055 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:02:41,058 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:02:41,062 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:02:41,066 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:02:41,067 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:02:41,072 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:02:41,077 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:02:41,082 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:02:41,087 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:02:41,091 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:02:41,094 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:02:41,097 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:02:41,098 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:02:41,102 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:02:41,107 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:02:41,111 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:02:41,118 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:02:41,123 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:02:41,127 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:02:41,148 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:02:41,148 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:02:41,149 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:02:41,183 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:02:41,184 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:02:41,186 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:02:41,199 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:05:29,513 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:05:29,513 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:05:29,525 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:05:29,527 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:05:29,528 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:05:29,528 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,530 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:05:29,531 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,532 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:05:29,533 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,535 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:05:29,535 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,536 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:05:29,537 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,539 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:05:29,541 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:05:29,542 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:05:29,542 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:05:29,542 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:05:29,547 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:05:29,548 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:05:29,548 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:05:29,558 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:05:29,561 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:05:29,561 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:05:29,562 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,563 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:05:29,563 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,565 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:05:29,565 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,567 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:05:29,567 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,569 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:05:29,570 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,571 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:05:29,571 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,572 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:05:29,572 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:05:29,577 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:05:29,579 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:05:29,579 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:05:29,580 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,581 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:05:29,581 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,582 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:05:29,587 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:05:29,589 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:05:29,589 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:05:29,590 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:05:29,600 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:05:29,601 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:05:29,602 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:05:29,602 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,604 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:05:29,604 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,606 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:05:29,606 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,607 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:05:29,608 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,609 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:05:29,609 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,612 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:05:29,613 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,614 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:05:29,615 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,616 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:05:29,617 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,618 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:05:29,618 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,618 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:05:29,619 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:05:29,624 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:05:29,626 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:05:29,626 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:05:29,626 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,628 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:05:29,629 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,631 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:05:29,631 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:05:29,632 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:05:29,632 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:05:29,635 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:05:29,638 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:05:29,643 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:05:29,644 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:05:29,649 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:05:29,650 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:05:29,656 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:05:29,658 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:05:29,665 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:05:29,665 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:05:29,672 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:05:29,681 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:05:29,687 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:05:29,692 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:05:29,697 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:05:29,700 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:05:29,703 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:05:29,706 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:05:29,711 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:05:29,714 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:05:29,714 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:05:29,720 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:05:29,726 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:05:29,732 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:05:29,737 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:05:29,741 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:05:29,745 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:05:29,748 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:05:29,748 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:05:29,753 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:05:29,756 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:05:29,761 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:05:29,768 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:05:29,772 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:05:29,775 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:05:29,799 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:05:29,799 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:05:29,801 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:05:29,838 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:05:29,838 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:05:29,840 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:05:29,849 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:07:35,437 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:07:35,437 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:07:35,461 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:07:35,464 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:07:35,464 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:07:35,464 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,467 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:07:35,468 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,470 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:07:35,470 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,472 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:07:35,475 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,481 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:07:35,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,484 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:07:35,486 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:07:35,487 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:07:35,487 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:07:35,488 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:07:35,496 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:07:35,497 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:07:35,497 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:07:35,511 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:07:35,515 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:07:35,516 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:07:35,516 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,518 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:07:35,518 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,520 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:07:35,521 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,523 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:07:35,523 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,529 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:07:35,530 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,533 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:07:35,534 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,534 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:07:35,535 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:07:35,540 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:07:35,543 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:07:35,543 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:07:35,544 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,547 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:07:35,548 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,549 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:07:35,558 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:07:35,560 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:07:35,561 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:07:35,561 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:07:35,575 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:07:35,579 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:07:35,580 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:07:35,580 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,582 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:07:35,582 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,584 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:07:35,584 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,586 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:07:35,586 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,588 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:07:35,588 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,589 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:07:35,590 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,591 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:07:35,592 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,593 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:07:35,594 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,597 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:07:35,597 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,598 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:07:35,598 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:07:35,604 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:07:35,606 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:07:35,607 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:07:35,607 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,608 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:07:35,609 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,610 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:07:35,611 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:07:35,612 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:07:35,613 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:07:35,617 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:07:35,622 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:07:35,629 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:07:35,631 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:07:35,638 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:07:35,639 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:07:35,648 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:07:35,652 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:07:35,659 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:07:35,660 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:07:35,667 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:07:35,677 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:07:35,685 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:07:35,692 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:07:35,697 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:07:35,700 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:07:35,704 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:07:35,708 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:07:35,714 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:07:35,717 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:07:35,718 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:07:35,730 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:07:35,738 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:07:35,750 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:07:35,763 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:07:35,770 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:07:35,774 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:07:35,783 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:07:35,785 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:07:35,791 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:07:35,797 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:07:35,804 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:07:35,820 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:07:35,832 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:07:35,839 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:07:35,872 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:07:35,872 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:07:35,875 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:07:35,926 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:07:35,926 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:07:35,929 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:07:35,940 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:12:30,291 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:12:30,291 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:12:30,310 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:12:30,312 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:12:30,312 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:12:30,312 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,314 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:12:30,315 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,316 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:12:30,317 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,318 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:12:30,319 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,320 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:12:30,320 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,324 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:12:30,325 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:12:30,325 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:12:30,326 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:12:30,326 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:12:30,331 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:12:30,332 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:12:30,332 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:12:30,342 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:12:30,343 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:12:30,344 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:12:30,344 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,345 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:12:30,345 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,347 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:12:30,347 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,347 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:12:30,347 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,352 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:12:30,353 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,354 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:12:30,354 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,355 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:12:30,355 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:12:30,360 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:12:30,361 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:12:30,362 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:12:30,362 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,364 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:12:30,364 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,364 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:12:30,371 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:12:30,372 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:12:30,373 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:12:30,374 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:12:30,385 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:12:30,388 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:12:30,388 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:12:30,389 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,390 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:12:30,390 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,391 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:12:30,391 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,392 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:12:30,393 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,394 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:12:30,394 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,396 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:12:30,397 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,397 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:12:30,397 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,401 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:12:30,401 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,402 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:12:30,403 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,403 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:12:30,403 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:12:30,408 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:12:30,410 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:12:30,411 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:12:30,411 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,413 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:12:30,414 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,414 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:12:30,414 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:12:30,414 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:12:30,414 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:12:30,421 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:12:30,425 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:12:30,429 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:12:30,430 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:12:30,436 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:12:30,437 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:12:30,441 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:12:30,444 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:12:30,451 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:12:30,451 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:12:30,459 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:12:30,468 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:12:30,475 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:12:30,480 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:12:30,485 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:12:30,490 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:12:30,493 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:12:30,495 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:12:30,499 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:12:30,503 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:12:30,503 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:12:30,508 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:12:30,512 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:12:30,517 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:12:30,521 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:12:30,525 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:12:30,529 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:12:30,534 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:12:30,534 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:12:30,540 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:12:30,543 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:12:30,547 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:12:30,553 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:12:30,557 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:12:30,560 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:12:30,584 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:12:30,585 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:12:30,586 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:12:30,624 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:12:30,625 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:12:30,627 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:12:30,638 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:13:13,270 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:13:13,270 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:13:13,279 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:13:13,281 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:13:13,281 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:13:13,282 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,284 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:13:13,284 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,286 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:13:13,286 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,287 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:13:13,288 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,289 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:13:13,290 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,293 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:13:13,295 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:13:13,296 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:13:13,296 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:13:13,296 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:13:13,302 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:13:13,303 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:13:13,303 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:13:13,313 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:13:13,317 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:13:13,317 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:13:13,317 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,319 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:13:13,319 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,321 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:13:13,321 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,323 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:13:13,323 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,325 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:13:13,325 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,327 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:13:13,328 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,328 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:13:13,328 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:13:13,334 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:13:13,337 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:13:13,337 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:13:13,337 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,339 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:13:13,339 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,340 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:13:13,346 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:13:13,347 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:13:13,348 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:13:13,348 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:13:13,361 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:13:13,363 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:13:13,364 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:13:13,364 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,366 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:13:13,366 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,368 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:13:13,368 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,369 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:13:13,370 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,371 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:13:13,372 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,374 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:13:13,374 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,376 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:13:13,377 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,378 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:13:13,379 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,380 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:13:13,381 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,382 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:13:13,382 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:13:13,388 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:13:13,390 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:13:13,391 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:13:13,391 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,393 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:13:13,394 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,395 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:13:13,395 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:13:13,396 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:13:13,396 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:13:13,400 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:13:13,403 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:13:13,408 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:13:13,410 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:13:13,417 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:13:13,418 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:13:13,425 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:13:13,428 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:13:13,434 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:13:13,434 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:13:13,444 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:13:13,452 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:13:13,459 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:13:13,466 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:13:13,471 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:13:13,475 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:13:13,478 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:13:13,482 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:13:13,485 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:13:13,489 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:13:13,489 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:13:13,497 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:13:13,501 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:13:13,507 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:13:13,512 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:13:13,516 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:13:13,522 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:13:13,526 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:13:13,526 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:13:13,530 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:13:13,534 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:13:13,538 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:13:13,546 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:13:13,551 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:13:13,554 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:13:13,576 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:13:13,577 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:13:13,579 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:13:13,620 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:13:13,620 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:13:13,622 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:13:13,635 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:18:55,854 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:18:55,854 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:18:55,867 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:18:55,870 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:18:55,871 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:18:55,872 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,874 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:18:55,874 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,876 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:18:55,876 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,879 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:18:55,880 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,881 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:18:55,881 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,884 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:18:55,886 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:18:55,886 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:18:55,886 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:18:55,887 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:18:55,893 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:18:55,894 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:18:55,894 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:18:55,906 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:18:55,910 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:18:55,910 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:18:55,910 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,912 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:18:55,913 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,914 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:18:55,914 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,916 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:18:55,916 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,918 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:18:55,919 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,921 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:18:55,921 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,921 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:18:55,922 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:18:55,928 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:18:55,931 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:18:55,931 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:18:55,932 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,934 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:18:55,934 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,935 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:18:55,941 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:18:55,942 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:18:55,943 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:18:55,943 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:18:55,954 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:18:55,957 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:18:55,957 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:18:55,957 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,959 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:18:55,960 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,961 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:18:55,962 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,963 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:18:55,963 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,965 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:18:55,965 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,967 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:18:55,967 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,969 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:18:55,970 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,971 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:18:55,972 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,973 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:18:55,973 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,974 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:18:55,975 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:18:55,980 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:18:55,982 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:18:55,983 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:18:55,984 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,985 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:18:55,986 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,987 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:18:55,988 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:18:55,988 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:18:55,988 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:18:55,992 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:18:55,995 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:18:56,000 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:18:56,002 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:18:56,007 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:18:56,008 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:18:56,012 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:18:56,015 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:18:56,022 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:18:56,023 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:18:56,034 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:18:56,042 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:18:56,048 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:18:56,053 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:18:56,057 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:18:56,061 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:18:56,064 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:18:56,068 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:18:56,071 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:18:56,074 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:18:56,074 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:18:56,081 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:18:56,086 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:18:56,090 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:18:56,095 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:18:56,099 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:18:56,102 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:18:56,105 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:18:56,106 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:18:56,111 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:18:56,115 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:18:56,119 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:18:56,125 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:18:56,128 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:18:56,132 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:18:56,152 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:18:56,152 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:18:56,154 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:18:56,190 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:18:56,191 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:18:56,192 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:18:56,202 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:19:12,532 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:19:12,532 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:19:12,545 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:19:12,548 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:19:12,548 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:19:12,548 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,552 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:19:12,552 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,554 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:19:12,555 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,556 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:19:12,557 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,559 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:19:12,560 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,562 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:19:12,563 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:19:12,564 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:19:12,564 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:19:12,564 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:19:12,571 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:19:12,571 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:19:12,572 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:19:12,581 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:19:12,585 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:19:12,585 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:19:12,586 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,587 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:19:12,588 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,589 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:19:12,590 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,591 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:19:12,591 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,593 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:19:12,593 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,594 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:19:12,595 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,595 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:19:12,595 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:19:12,600 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:19:12,603 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:19:12,603 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:19:12,604 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,605 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:19:12,606 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,606 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:19:12,610 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:19:12,611 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:19:12,612 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:19:12,612 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:19:12,622 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:19:12,623 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:19:12,624 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:19:12,624 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,625 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:19:12,626 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,627 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:19:12,627 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,629 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:19:12,629 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,630 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:19:12,631 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,632 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:19:12,632 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,634 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:19:12,634 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,636 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:19:12,636 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,638 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:19:12,639 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,639 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:19:12,639 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:19:12,646 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:19:12,648 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:19:12,649 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:19:12,649 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,651 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:19:12,652 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,654 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:19:12,654 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:19:12,655 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:19:12,655 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:19:12,659 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:19:12,663 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:19:12,668 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:19:12,670 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:19:12,675 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:19:12,675 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:19:12,681 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:19:12,684 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:19:12,691 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:19:12,691 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:19:12,698 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:19:12,706 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:19:12,713 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:19:12,718 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:19:12,722 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:19:12,727 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:19:12,730 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:19:12,733 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:19:12,738 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:19:12,742 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:19:12,742 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:19:12,749 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:19:12,754 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:19:12,760 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:19:12,764 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:19:12,767 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:19:12,771 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:19:12,774 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:19:12,775 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:19:12,780 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:19:12,784 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:19:12,790 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:19:12,796 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:19:12,799 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:19:12,805 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:19:12,833 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:19:12,833 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:19:12,836 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:19:12,871 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:19:12,872 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:19:12,873 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:19:12,886 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:25:52,493 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:25:52,493 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:25:52,504 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:25:52,506 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:25:52,507 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:25:52,507 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,509 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:25:52,509 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,511 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:25:52,511 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,513 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:25:52,513 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,515 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:25:52,515 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,517 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:25:52,519 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:25:52,520 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:25:52,520 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:25:52,521 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:25:52,526 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:25:52,527 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:25:52,527 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:25:52,536 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:25:52,540 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:25:52,540 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:25:52,540 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,542 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:25:52,543 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,544 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:25:52,545 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,547 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:25:52,547 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,549 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:25:52,550 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,552 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:25:52,552 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,553 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:25:52,553 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:25:52,560 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:25:52,562 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:25:52,563 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:25:52,564 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,565 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:25:52,566 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,566 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:25:52,571 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:25:52,572 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:25:52,573 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:25:52,573 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:25:52,584 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:25:52,586 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:25:52,587 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:25:52,587 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,589 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:25:52,589 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,591 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:25:52,592 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,593 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:25:52,594 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,595 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:25:52,596 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,598 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:25:52,598 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,600 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:25:52,600 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,601 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:25:52,602 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,604 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:25:52,605 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,605 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:25:52,606 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:25:52,612 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:25:52,615 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:25:52,615 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:25:52,616 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,617 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:25:52,618 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,619 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:25:52,620 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:25:52,620 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:25:52,621 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:25:52,625 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:25:52,630 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:25:52,635 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:25:52,637 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:25:52,645 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:25:52,645 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:25:52,651 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:25:52,655 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:25:52,664 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:25:52,664 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:25:52,673 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:25:52,681 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:25:52,687 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:25:52,694 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:25:52,699 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:25:52,703 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:25:52,707 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:25:52,711 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:25:52,715 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:25:52,719 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:25:52,719 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:25:52,726 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:25:52,733 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:25:52,738 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:25:52,744 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:25:52,749 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:25:52,753 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:25:52,757 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:25:52,757 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:25:52,762 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:25:52,767 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:25:52,771 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:25:52,779 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:25:52,784 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:25:52,788 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:25:52,813 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:25:52,813 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:25:52,816 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:25:52,856 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:25:52,856 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:25:52,858 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:25:52,872 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:25:52,896 [INFO] pc_project: expand_and_join_curve: produced 63 fund×month rows across 2 funds.
2025-10-26 11:25:52,897 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 11:26:09,004 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:26:09,004 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:26:09,013 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:26:09,015 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:26:09,016 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:26:09,016 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,018 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:26:09,018 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,020 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:26:09,020 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,022 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:26:09,023 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,025 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:26:09,025 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,029 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:26:09,030 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:26:09,031 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:26:09,031 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:26:09,031 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:26:09,037 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:26:09,037 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:26:09,038 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:26:09,048 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:26:09,050 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:26:09,051 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:26:09,051 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,052 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:26:09,053 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,054 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:26:09,054 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,056 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:26:09,056 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,059 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:26:09,059 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,061 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:26:09,062 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,062 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:26:09,062 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:26:09,067 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:26:09,069 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:26:09,070 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:26:09,070 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,071 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:26:09,071 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,072 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:26:09,078 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:26:09,080 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:26:09,080 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:26:09,081 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:26:09,089 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:26:09,092 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:26:09,093 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:26:09,093 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,095 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:26:09,095 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,096 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:26:09,097 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,098 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:26:09,099 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,100 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:26:09,100 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,102 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:26:09,102 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,103 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:26:09,103 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,105 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:26:09,106 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,108 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:26:09,108 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,109 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:26:09,109 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:26:09,114 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:26:09,116 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:26:09,116 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:26:09,117 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,118 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:26:09,118 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,119 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:26:09,119 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:26:09,119 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:26:09,120 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:26:09,123 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:26:09,127 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:26:09,132 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:26:09,133 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:26:09,137 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:26:09,137 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:26:09,145 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:26:09,147 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:26:09,152 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:26:09,153 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:26:09,162 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:26:09,171 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:26:09,177 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:26:09,182 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:26:09,186 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:26:09,189 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:26:09,194 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:26:09,198 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:26:09,202 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:26:09,205 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:26:09,205 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:26:09,211 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:26:09,218 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:26:09,222 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:26:09,228 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:26:09,236 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:26:09,240 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:26:09,244 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:26:09,244 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:26:09,250 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:26:09,253 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:26:09,256 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:26:09,263 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:26:09,266 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:26:09,269 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:26:09,289 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:26:09,289 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:26:09,291 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:26:09,326 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:26:09,326 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:26:09,328 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:26:09,337 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:26:09,364 [INFO] pc_project: expand_and_join_curve: produced 63 fund×month rows across 2 funds.
2025-10-26 11:26:09,365 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 11:33:47,970 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:33:47,970 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:33:47,982 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:33:47,985 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:33:47,985 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:33:47,986 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:47,988 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:33:47,989 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:47,991 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:33:47,992 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:47,993 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:33:47,994 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:47,995 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:33:47,996 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:47,998 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:33:48,000 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:33:48,000 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:33:48,000 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:33:48,001 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:33:48,006 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:33:48,006 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:33:48,007 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:33:48,015 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:33:48,017 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:33:48,017 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:33:48,017 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,019 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:33:48,020 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,021 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:33:48,022 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,023 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:33:48,023 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,025 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:33:48,025 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,027 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:33:48,027 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,028 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:33:48,028 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:33:48,033 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:33:48,035 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:33:48,036 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:33:48,036 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,037 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:33:48,038 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,038 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:33:48,043 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:33:48,045 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:33:48,045 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:33:48,046 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:33:48,056 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:33:48,059 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:33:48,060 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:33:48,060 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,061 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:33:48,062 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,063 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:33:48,064 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,065 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:33:48,066 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,068 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:33:48,068 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,070 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:33:48,070 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,071 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:33:48,072 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,074 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:33:48,074 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,076 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:33:48,076 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,077 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:33:48,077 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:33:48,084 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:33:48,086 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:33:48,086 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:33:48,086 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,088 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:33:48,088 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,090 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:33:48,090 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:33:48,091 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:33:48,091 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:33:48,096 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:33:48,100 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:33:48,104 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:33:48,106 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:33:48,112 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:33:48,113 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:33:48,120 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:33:48,122 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:33:48,131 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:33:48,131 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:33:48,138 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:33:48,148 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:33:48,152 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:33:48,158 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:33:48,163 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:33:48,166 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:33:48,169 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:33:48,172 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:33:48,175 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:33:48,179 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:33:48,179 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:33:48,186 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:33:48,191 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:33:48,196 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:33:48,201 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:33:48,205 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:33:48,210 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:33:48,214 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:33:48,215 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:33:48,220 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:33:48,224 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:33:48,230 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:33:48,235 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:33:48,239 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:33:48,242 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:33:48,268 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:33:48,268 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:33:48,270 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:33:48,302 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:33:48,302 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:33:48,304 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:33:48,316 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:33:48,346 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 11:33:48,347 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 11:44:21,738 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:44:21,738 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:44:21,750 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:44:21,754 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:44:21,754 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:44:21,755 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,757 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:44:21,758 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,760 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:44:21,760 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,772 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:44:21,780 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,782 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:44:21,782 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,788 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:44:21,800 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:44:21,819 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:44:21,819 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:44:21,820 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:44:21,829 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:44:21,838 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:44:21,839 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:44:21,868 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:44:21,899 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:44:21,912 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:44:21,913 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,915 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:44:21,915 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,917 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:44:21,917 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,920 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:44:21,920 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,922 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:44:21,924 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,926 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:44:21,927 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,927 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:44:21,928 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:44:21,933 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:44:21,936 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:44:21,937 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:44:21,937 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,939 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:44:21,940 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:21,940 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:44:21,947 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:44:21,948 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:44:21,949 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:44:21,949 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:44:21,998 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:44:22,020 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:44:22,037 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:44:22,067 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,107 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:44:22,112 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,121 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:44:22,152 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,196 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:44:22,196 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,210 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:44:22,227 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,254 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:44:22,260 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,297 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:44:22,307 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,338 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:44:22,339 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,341 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:44:22,342 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,343 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:44:22,344 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:44:22,351 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:44:22,353 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:44:22,354 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:44:22,354 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,355 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:44:22,356 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,359 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:44:22,359 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:44:22,360 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:44:22,361 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:44:22,364 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:44:22,369 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:44:22,374 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:44:22,376 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:44:22,382 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:44:22,382 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:44:22,393 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:44:22,398 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:44:22,429 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:44:22,431 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:44:22,480 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:44:22,535 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:44:22,540 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:44:22,546 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:44:22,551 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:44:22,555 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:44:22,560 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:44:22,567 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:44:22,587 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:44:22,660 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:44:22,700 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:44:22,709 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:44:22,716 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:44:22,722 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:44:22,727 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:44:22,733 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:44:22,737 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:44:22,748 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:44:22,749 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:44:22,758 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:44:22,779 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:44:22,846 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:44:22,886 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:44:22,890 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:44:22,893 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:44:22,925 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:44:22,938 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:44:22,941 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:44:23,086 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:44:23,086 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:44:23,088 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:44:23,113 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:44:23,212 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 11:44:23,221 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 11:46:39,305 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:46:39,306 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:46:39,320 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:46:39,324 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:46:39,324 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:46:39,324 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,327 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:46:39,328 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,331 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:46:39,331 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,333 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:46:39,333 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,335 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:46:39,335 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,338 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:46:39,339 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:46:39,339 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:46:39,340 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:46:39,340 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:46:39,347 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:46:39,348 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:46:39,348 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:46:39,357 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:46:39,360 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:46:39,361 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:46:39,362 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,363 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:46:39,363 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,365 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:46:39,365 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,367 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:46:39,367 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,368 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:46:39,369 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,371 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:46:39,371 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,372 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:46:39,372 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:46:39,380 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:46:39,383 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:46:39,383 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:46:39,383 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,385 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:46:39,385 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,385 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:46:39,393 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:46:39,394 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:46:39,395 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:46:39,395 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:46:39,409 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:46:39,411 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:46:39,412 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:46:39,412 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,414 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:46:39,414 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,416 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:46:39,417 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,418 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:46:39,418 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,420 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:46:39,421 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,422 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:46:39,423 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,424 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:46:39,425 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,427 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:46:39,428 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,430 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:46:39,430 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,431 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:46:39,431 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:46:39,437 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:46:39,439 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:46:39,440 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:46:39,440 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,441 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:46:39,442 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,443 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:46:39,444 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:46:39,445 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:46:39,445 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:46:39,449 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:46:39,453 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:46:39,457 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:46:39,459 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:46:39,466 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:46:39,466 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:46:39,472 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:46:39,474 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:46:39,481 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:46:39,481 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:46:39,489 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:46:39,499 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:46:39,505 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:46:39,510 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:46:39,514 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:46:39,520 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:46:39,523 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:46:39,526 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:46:39,530 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:46:39,534 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:46:39,535 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:46:39,540 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:46:39,546 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:46:39,553 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:46:39,557 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:46:39,561 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:46:39,564 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:46:39,568 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:46:39,569 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:46:39,573 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:46:39,576 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:46:39,580 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:46:39,586 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:46:39,589 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:46:39,592 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:46:39,618 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:46:39,618 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:46:39,620 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:46:39,658 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:46:39,659 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:46:39,661 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:46:39,672 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:46:39,699 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 11:46:39,700 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 11:46:39,709 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 11:46:39,711 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 11:51:12,205 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:51:12,205 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:51:12,214 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:51:12,218 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:51:12,218 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:51:12,218 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,221 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:51:12,222 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,224 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:51:12,224 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,225 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:51:12,226 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,227 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:51:12,228 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,231 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:51:12,233 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:51:12,233 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:51:12,233 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:51:12,234 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:51:12,241 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:51:12,242 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:51:12,242 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:51:12,250 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:51:12,255 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:51:12,256 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:51:12,256 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,257 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:51:12,258 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,259 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:51:12,260 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,261 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:51:12,261 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,263 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:51:12,263 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,265 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:51:12,265 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,266 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:51:12,266 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:51:12,271 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:51:12,274 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:51:12,274 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:51:12,274 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,276 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:51:12,276 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,276 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:51:12,281 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:51:12,283 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:51:12,283 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:51:12,284 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:51:12,294 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:51:12,297 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:51:12,297 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:51:12,297 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,299 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:51:12,300 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,301 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:51:12,302 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,303 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:51:12,304 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,306 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:51:12,307 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,308 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:51:12,308 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,310 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:51:12,310 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,312 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:51:12,312 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,313 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:51:12,314 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,314 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:51:12,314 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:51:12,319 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:51:12,322 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:51:12,323 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:51:12,323 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,325 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:51:12,325 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,326 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:51:12,327 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:51:12,327 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:51:12,327 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:51:12,331 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:51:12,335 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:51:12,340 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:51:12,341 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:51:12,346 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:51:12,347 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:51:12,351 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:51:12,355 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:51:12,363 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:51:12,363 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:51:12,371 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:51:12,380 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:51:12,385 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:51:12,391 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:51:12,396 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:51:12,399 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:51:12,402 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:51:12,406 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:51:12,409 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:51:12,413 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:51:12,414 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:51:12,418 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:51:12,423 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:51:12,429 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:51:12,433 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:51:12,437 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:51:12,440 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:51:12,444 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:51:12,444 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:51:12,448 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:51:12,451 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:51:12,456 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:51:12,461 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:51:12,464 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:51:12,467 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:51:12,495 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:51:12,496 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:51:12,498 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:51:12,533 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:51:12,533 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:51:12,535 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:51:12,546 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:51:12,577 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 11:51:12,578 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 11:51:12,586 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 11:51:12,588 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 11:56:23,920 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:23,920 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:56:23,920 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:23,937 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:23,937 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:56:23,938 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,940 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:56:23,941 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,943 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:56:23,944 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,946 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:56:23,946 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,948 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:56:23,948 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,950 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:56:23,952 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:56:23,953 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:56:23,953 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:56:23,953 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:56:23,958 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:56:23,959 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:23,959 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:56:23,970 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:23,972 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:23,972 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:56:23,973 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,974 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:56:23,975 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,975 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:56:23,975 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,980 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:56:23,981 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,982 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:56:23,983 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,984 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:56:23,985 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,985 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:23,985 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:56:23,989 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:23,991 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:23,991 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:56:23,992 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,992 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:56:23,992 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:23,992 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:56:24,000 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:56:24,002 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:56:24,002 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:24,003 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:56:24,012 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:24,015 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:24,015 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:56:24,015 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,017 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:56:24,017 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,019 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:56:24,019 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,020 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:56:24,021 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,022 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:56:24,022 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,023 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:56:24,024 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,025 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:56:24,025 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,025 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:56:24,028 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,030 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:56:24,030 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,031 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:24,031 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:56:24,036 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:24,038 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:24,039 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:56:24,039 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,040 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:56:24,040 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,042 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:56:24,042 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:24,042 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:56:24,042 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:56:24,047 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:56:24,051 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:56:24,056 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:56:24,058 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:56:24,064 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:56:24,065 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:56:24,071 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:56:24,073 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:56:24,081 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:56:24,081 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:56:24,089 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:56:24,098 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:56:24,104 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:56:24,108 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:56:24,114 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:56:24,117 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:56:24,121 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:56:24,125 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:56:24,125 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:56:24,134 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:56:24,134 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:56:24,139 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:56:24,145 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:56:24,150 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:56:24,154 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:56:24,158 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:56:24,163 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:56:24,167 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:56:24,167 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:56:24,173 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:56:24,175 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:56:24,182 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:56:24,188 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:56:24,192 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:56:24,198 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:56:24,220 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:56:24,220 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:56:24,222 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:56:24,247 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 11:56:24,259 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:56:24,260 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:56:24,261 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:56:24,261 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 11:56:24,271 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:56:44,707 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:44,708 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:56:44,725 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:44,728 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:44,728 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:56:44,729 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,731 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:56:44,732 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,733 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:56:44,733 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,734 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:56:44,735 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,737 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:56:44,737 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,740 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:56:44,742 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:56:44,742 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:56:44,742 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:56:44,743 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:56:44,748 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:56:44,749 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:44,749 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:56:44,758 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:44,761 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:44,761 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:56:44,761 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,764 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:56:44,764 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,766 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:56:44,766 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,767 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:56:44,768 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,769 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:56:44,770 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,771 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:56:44,772 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,772 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:44,773 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:56:44,779 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:44,781 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:44,782 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:56:44,782 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,783 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:56:44,784 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,784 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:56:44,790 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:56:44,791 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:56:44,792 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:44,794 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:56:44,805 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:44,808 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:44,809 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:56:44,809 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,811 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:56:44,812 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,814 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:56:44,814 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,816 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:56:44,816 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,818 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:56:44,818 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,820 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:56:44,820 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,822 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:56:44,823 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,825 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:56:44,826 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,827 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:56:44,828 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,828 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:56:44,829 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:56:44,834 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:56:44,836 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:56:44,837 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:56:44,837 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,839 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:56:44,840 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,842 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:56:44,842 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:56:44,842 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:56:44,843 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:56:44,846 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:56:44,850 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:56:44,854 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:56:44,856 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:56:44,862 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:56:44,862 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:56:44,867 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:56:44,870 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:56:44,879 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:56:44,880 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:56:44,890 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:56:44,899 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:56:44,907 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:56:44,914 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:56:44,918 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:56:44,922 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:56:44,926 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:56:44,930 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:56:44,933 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:56:44,938 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:56:44,938 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:56:44,946 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:56:44,953 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:56:44,958 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:56:44,963 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:56:44,967 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:56:44,972 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:56:44,976 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:56:44,977 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:56:44,982 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:56:44,986 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:56:44,992 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:56:44,998 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:56:45,002 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:56:45,005 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:56:45,030 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:56:45,030 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:56:45,033 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:56:45,056 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 11:56:45,070 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:56:45,070 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:56:45,072 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:56:45,072 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 11:56:45,085 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:57:15,160 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:57:15,160 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 11:57:15,173 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:57:15,176 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:57:15,176 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 11:57:15,177 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,179 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 11:57:15,180 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,182 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 11:57:15,182 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,184 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 11:57:15,185 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,186 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 11:57:15,187 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,189 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 11:57:15,191 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 11:57:15,192 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 11:57:15,192 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 11:57:15,192 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 11:57:15,197 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 11:57:15,198 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:57:15,198 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 11:57:15,207 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:57:15,209 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:57:15,210 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 11:57:15,210 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,212 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:57:15,212 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,214 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 11:57:15,215 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,216 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 11:57:15,217 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,219 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 11:57:15,219 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,221 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 11:57:15,221 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,222 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:57:15,222 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 11:57:15,227 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:57:15,230 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:57:15,230 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 11:57:15,231 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,232 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 11:57:15,233 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,234 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 11:57:15,240 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 11:57:15,241 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 11:57:15,242 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:57:15,243 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 11:57:15,254 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:57:15,256 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:57:15,257 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 11:57:15,257 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,258 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 11:57:15,259 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,261 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 11:57:15,261 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,264 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 11:57:15,264 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,266 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 11:57:15,266 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,268 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 11:57:15,268 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,270 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 11:57:15,270 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,271 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 11:57:15,272 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,273 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 11:57:15,273 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,274 [INFO] pc_project: Starting data cleaning.
2025-10-26 11:57:15,274 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 11:57:15,279 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 11:57:15,282 [INFO] pc_project: Data cleaning complete.
2025-10-26 11:57:15,282 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 11:57:15,282 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,284 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 11:57:15,284 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,286 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 11:57:15,286 [INFO] pc_project: --------------------------------------------------
2025-10-26 11:57:15,286 [INFO] pc_project: Starting merge pipeline...
2025-10-26 11:57:15,286 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 11:57:15,289 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 11:57:15,292 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 11:57:15,297 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 11:57:15,300 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 11:57:15,305 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 11:57:15,305 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 11:57:15,313 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 11:57:15,316 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 11:57:15,323 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 11:57:15,323 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 11:57:15,333 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 11:57:15,341 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:57:15,348 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 11:57:15,354 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 11:57:15,358 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 11:57:15,363 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 11:57:15,366 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 11:57:15,369 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 11:57:15,372 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:57:15,375 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 11:57:15,376 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 11:57:15,382 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:57:15,387 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 11:57:15,392 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 11:57:15,397 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 11:57:15,401 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 11:57:15,404 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:57:15,409 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 11:57:15,409 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 11:57:15,415 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 11:57:15,419 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 11:57:15,424 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 11:57:15,430 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 11:57:15,434 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 11:57:15,437 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 11:57:15,459 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 11:57:15,459 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 11:57:15,461 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 11:57:15,481 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 11:57:15,493 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 11:57:15,494 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 11:57:15,496 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 11:57:15,497 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 11:57:15,509 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 11:57:15,514 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 11:57:15,535 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 11:57:15,536 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 11:57:15,540 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 11:57:15,546 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 11:57:15,548 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 11:57:15,551 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 11:57:15,552 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:33:02,863 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:02,864 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:33:02,874 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:02,876 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:02,876 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:33:02,876 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,879 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:33:02,879 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,881 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:33:02,881 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,883 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:33:02,883 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,885 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:33:02,885 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,888 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:33:02,891 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:33:02,891 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:33:02,892 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:33:02,892 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:33:02,912 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:33:02,912 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:02,913 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:33:02,925 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:02,926 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:02,927 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:33:02,927 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,928 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:33:02,928 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,930 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:33:02,931 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,933 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:33:02,933 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,935 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:33:02,936 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,937 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:33:02,937 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,938 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:02,938 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:33:02,943 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:02,946 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:02,946 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:33:02,946 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,948 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:33:02,949 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,949 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:33:02,955 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:33:02,956 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:33:02,957 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:02,957 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:33:02,969 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:02,971 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:02,971 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:33:02,972 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,973 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:33:02,973 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,975 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:33:02,975 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,976 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:33:02,977 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,978 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:33:02,979 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,980 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:33:02,981 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,983 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:33:02,984 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,985 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:33:02,986 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,988 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:33:02,988 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:02,988 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:02,989 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:33:02,995 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:02,997 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:02,998 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:33:02,998 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:03,000 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:33:03,001 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:03,003 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:33:03,003 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:03,003 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:33:03,004 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:33:03,010 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:33:03,014 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:33:03,020 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:33:03,022 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:33:03,029 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:33:03,029 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:33:03,038 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:33:03,040 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:33:03,046 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:33:03,046 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:33:03,070 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:33:03,099 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:33:03,104 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:33:03,110 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:33:03,119 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:33:03,123 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:33:03,126 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:33:03,130 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:33:03,133 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:33:03,138 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:33:03,139 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:33:03,143 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:33:03,147 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:33:03,155 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:33:03,159 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:33:03,163 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:33:03,166 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:33:03,170 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:33:03,171 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:33:03,175 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:33:03,178 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:33:03,182 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:33:03,188 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:33:03,190 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:33:03,193 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:33:03,214 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:33:03,214 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:33:03,216 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:33:03,236 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:33:03,251 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:33:03,252 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:33:03,253 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:33:03,254 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:33:03,268 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:33:03,271 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:33:03,298 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:33:03,299 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:33:03,304 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:33:03,310 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:33:03,311 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:33:03,315 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:33:03,315 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:33:39,412 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:39,413 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:33:39,427 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:39,430 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:39,430 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:33:39,431 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,433 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:33:39,433 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,435 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:33:39,435 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,438 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:33:39,438 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,441 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:33:39,441 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,444 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:33:39,445 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:33:39,445 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:33:39,446 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:33:39,446 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:33:39,451 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:33:39,451 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:39,451 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:33:39,460 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:39,463 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:39,463 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:33:39,464 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,465 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:33:39,466 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,467 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:33:39,468 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,469 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:33:39,471 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,473 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:33:39,473 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,474 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:33:39,474 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,475 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:39,475 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:33:39,479 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:39,482 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:39,482 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:33:39,483 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,484 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:33:39,485 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,485 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:33:39,490 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:33:39,491 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:33:39,491 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:39,492 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:33:39,501 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:39,505 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:39,506 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:33:39,506 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,508 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:33:39,508 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,509 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:33:39,510 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,511 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:33:39,512 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,514 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:33:39,514 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,516 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:33:39,517 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,518 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:33:39,519 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,520 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:33:39,521 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,522 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:33:39,523 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,523 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:33:39,523 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:33:39,527 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:33:39,530 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:33:39,530 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:33:39,530 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,532 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:33:39,532 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,534 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:33:39,535 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:33:39,535 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:33:39,535 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:33:39,538 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:33:39,541 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:33:39,545 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:33:39,547 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:33:39,552 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:33:39,553 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:33:39,558 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:33:39,560 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:33:39,568 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:33:39,568 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:33:39,575 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:33:39,583 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:33:39,588 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:33:39,593 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:33:39,598 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:33:39,602 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:33:39,606 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:33:39,609 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:33:39,611 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:33:39,616 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:33:39,617 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:33:39,623 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:33:39,628 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:33:39,635 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:33:39,640 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:33:39,644 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:33:39,649 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:33:39,653 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:33:39,653 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:33:39,658 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:33:39,662 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:33:39,667 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:33:39,672 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:33:39,676 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:33:39,678 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:33:39,699 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:33:39,700 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:33:39,701 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:33:39,722 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:33:39,734 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:33:39,734 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:33:39,735 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:33:39,736 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:33:39,747 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:33:39,752 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:33:39,773 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:33:39,774 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:33:39,777 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:33:39,786 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:33:39,787 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:33:39,791 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:33:39,791 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:34:18,441 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:34:18,441 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:34:18,453 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:34:18,456 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:34:18,456 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:34:18,456 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,458 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:34:18,458 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,461 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:34:18,461 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,463 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:34:18,463 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,465 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:34:18,466 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,469 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:34:18,470 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:34:18,471 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:34:18,471 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:34:18,471 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:34:18,478 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:34:18,479 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:34:18,479 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:34:18,489 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:34:18,492 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:34:18,493 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:34:18,493 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,495 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:34:18,495 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,497 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:34:18,497 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,498 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:34:18,499 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,500 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:34:18,500 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,502 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:34:18,503 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,503 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:34:18,503 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:34:18,510 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:34:18,512 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:34:18,512 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:34:18,513 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,514 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:34:18,515 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,515 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:34:18,520 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:34:18,521 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:34:18,522 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:34:18,522 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:34:18,533 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:34:18,535 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:34:18,536 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:34:18,536 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,537 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:34:18,538 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,539 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:34:18,539 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,541 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:34:18,541 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,543 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:34:18,544 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,546 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:34:18,546 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,547 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:34:18,548 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,549 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:34:18,550 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,551 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:34:18,551 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,552 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:34:18,552 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:34:18,558 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:34:18,561 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:34:18,562 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:34:18,562 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,564 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:34:18,564 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,565 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:34:18,566 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:34:18,566 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:34:18,567 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:34:18,570 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:34:18,573 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:34:18,577 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:34:18,578 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:34:18,583 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:34:18,583 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:34:18,590 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:34:18,593 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:34:18,601 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:34:18,602 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:34:18,610 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:34:18,620 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:34:18,625 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:34:18,631 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:34:18,635 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:34:18,639 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:34:18,642 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:34:18,646 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:34:18,650 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:34:18,653 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:34:18,654 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:34:18,659 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:34:18,666 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:34:18,670 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:34:18,674 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:34:18,679 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:34:18,683 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:34:18,687 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:34:18,687 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:34:18,691 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:34:18,695 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:34:18,699 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:34:18,705 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:34:18,709 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:34:18,713 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:34:18,733 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:34:18,733 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:34:18,735 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:34:18,759 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:34:18,771 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:34:18,771 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:34:18,772 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:34:18,773 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:34:18,784 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:34:18,788 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:34:18,810 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:34:18,811 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:34:18,815 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:34:18,821 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:34:18,822 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:34:18,825 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:34:18,826 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:34:18,857 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:35:53,660 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:35:53,661 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:35:53,678 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:35:53,681 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:35:53,681 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:35:53,682 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,684 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:35:53,685 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,686 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:35:53,687 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,689 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:35:53,690 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,691 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:35:53,691 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,694 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:35:53,696 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:35:53,696 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:35:53,697 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:35:53,697 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:35:53,705 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:35:53,706 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:35:53,706 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:35:53,718 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:35:53,722 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:35:53,722 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:35:53,722 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,724 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:35:53,724 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,726 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:35:53,726 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,728 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:35:53,728 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,730 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:35:53,730 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,732 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:35:53,732 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,733 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:35:53,733 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:35:53,739 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:35:53,742 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:35:53,742 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:35:53,742 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,744 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:35:53,745 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,745 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:35:53,750 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:35:53,753 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:35:53,754 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:35:53,755 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:35:53,765 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:35:53,768 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:35:53,768 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:35:53,769 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,770 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:35:53,771 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,772 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:35:53,773 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,775 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:35:53,775 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,776 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:35:53,777 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,779 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:35:53,779 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,781 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:35:53,782 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,784 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:35:53,785 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,787 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:35:53,787 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,788 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:35:53,789 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:35:53,798 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:35:53,801 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:35:53,802 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:35:53,803 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,805 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:35:53,805 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,808 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:35:53,809 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:35:53,810 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:35:53,810 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:35:53,814 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:35:53,821 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:35:53,826 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:35:53,828 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:35:53,834 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:35:53,835 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:35:53,842 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:35:53,845 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:35:53,852 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:35:53,852 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:35:53,861 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:35:53,869 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:35:53,877 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:35:53,884 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:35:53,889 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:35:53,892 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:35:53,896 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:35:53,900 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:35:53,904 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:35:53,907 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:35:53,908 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:35:53,914 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:35:53,919 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:35:53,923 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:35:53,929 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:35:53,933 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:35:53,937 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:35:53,940 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:35:53,940 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:35:53,946 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:35:53,950 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:35:53,955 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:35:53,961 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:35:53,964 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:35:53,968 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:35:53,993 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:35:53,993 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:35:53,996 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:35:54,015 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:35:54,031 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:35:54,031 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:35:54,033 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:35:54,034 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:35:54,046 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:35:54,050 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:35:54,075 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:35:54,076 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:35:54,080 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:35:54,086 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:35:54,088 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:35:54,091 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:35:54,091 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:35:54,118 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:37:21,971 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:21,971 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:37:21,984 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:21,988 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:21,989 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:37:21,989 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:21,990 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:37:21,992 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:21,994 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:37:21,994 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:21,997 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:37:21,997 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:21,999 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:37:21,999 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,001 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:37:22,003 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:37:22,004 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:37:22,004 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:37:22,004 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:37:22,011 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:37:22,011 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:22,012 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:37:22,024 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:22,027 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:22,027 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:37:22,028 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,029 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:37:22,030 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,031 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:37:22,032 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,033 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:37:22,034 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,035 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:37:22,036 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,038 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:37:22,039 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,040 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:22,041 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:37:22,047 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:22,049 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:22,049 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:37:22,050 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,052 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:37:22,052 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,053 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:37:22,061 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:37:22,062 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:37:22,063 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:22,063 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:37:22,078 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:22,081 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:22,081 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:37:22,081 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,083 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:37:22,083 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,085 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:37:22,086 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,088 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:37:22,088 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,090 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:37:22,091 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,092 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:37:22,093 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,095 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:37:22,095 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,097 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:37:22,097 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,099 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:37:22,099 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,100 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:22,100 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:37:22,108 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:22,111 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:22,111 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:37:22,112 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,113 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:37:22,113 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,115 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:37:22,115 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:22,115 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:37:22,115 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:37:22,120 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:37:22,125 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:37:22,129 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:37:22,131 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:37:22,136 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:37:22,137 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:37:22,144 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:37:22,147 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:37:22,155 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:37:22,155 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:37:43,609 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:43,610 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:37:43,627 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:43,630 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:43,631 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:37:43,631 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,634 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:37:43,635 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,638 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:37:43,638 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,640 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:37:43,640 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,643 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:37:43,643 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,646 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:37:43,648 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:37:43,649 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:37:43,650 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:37:43,650 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:37:43,657 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:37:43,657 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:43,658 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:37:43,675 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:43,678 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:43,679 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:37:43,679 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,681 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:37:43,682 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,685 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:37:43,685 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,687 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:37:43,687 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,689 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:37:43,689 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,691 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:37:43,691 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,692 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:43,693 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:37:43,698 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:43,702 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:43,703 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:37:43,704 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,705 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:37:43,706 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,706 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:37:43,713 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:37:43,716 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:37:43,717 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:43,718 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:37:43,729 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:43,732 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:43,733 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:37:43,733 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,735 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:37:43,736 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,738 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:37:43,738 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,740 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:37:43,740 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,742 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:37:43,742 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,744 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:37:43,744 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,745 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:37:43,745 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,748 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:37:43,749 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,751 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:37:43,752 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,753 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:37:43,753 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:37:43,759 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:37:43,761 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:37:43,761 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:37:43,762 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,763 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:37:43,763 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,766 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:37:43,766 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:37:43,766 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:37:43,767 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:37:43,770 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:37:43,774 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:37:43,777 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:37:43,779 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:37:43,783 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:37:43,785 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:37:43,790 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:37:43,792 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:37:43,797 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:37:43,798 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:37:43,807 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:37:43,815 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:37:43,821 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:37:43,827 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:37:43,831 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:37:43,835 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:37:43,838 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:37:43,842 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:37:43,846 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:37:43,849 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:37:43,849 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:37:43,855 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:37:43,861 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:37:43,867 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:37:43,872 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:37:43,878 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:37:43,881 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:37:43,885 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:37:43,886 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:37:43,891 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:37:43,895 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:37:43,899 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:37:43,906 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:37:43,910 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:37:43,913 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:37:43,941 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:37:43,942 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:37:43,944 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:37:43,970 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:37:43,983 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:37:43,983 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:37:43,986 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:37:43,986 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:37:43,998 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:37:44,003 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:37:44,025 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:37:44,025 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:37:44,030 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:37:44,037 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:37:44,038 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:37:44,041 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:37:44,041 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:37:44,070 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:41:53,066 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:41:53,066 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:41:53,082 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:41:53,085 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:41:53,086 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:41:53,086 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,088 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:41:53,089 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,090 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:41:53,090 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,093 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:41:53,093 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,096 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:41:53,097 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,100 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:41:53,103 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:41:53,103 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:41:53,103 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:41:53,104 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:41:53,110 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:41:53,110 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:41:53,111 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:41:53,121 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:41:53,126 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:41:53,126 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:41:53,127 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,133 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:41:53,135 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,143 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:41:53,143 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,152 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:41:53,153 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,155 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:41:53,155 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,157 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:41:53,157 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,158 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:41:53,159 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:41:53,175 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:41:53,181 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:41:53,181 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:41:53,183 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,187 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:41:53,187 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,188 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:41:53,193 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:41:53,196 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:41:53,197 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:41:53,198 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:41:53,209 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:41:53,212 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:41:53,213 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:41:53,213 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,215 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:41:53,216 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,218 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:41:53,219 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,220 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:41:53,221 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,224 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:41:53,225 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,226 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:41:53,226 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,228 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:41:53,228 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,230 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:41:53,231 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,233 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:41:53,233 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,234 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:41:53,234 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:41:53,240 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:41:53,243 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:41:53,243 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:41:53,243 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,245 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:41:53,246 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,248 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:41:53,248 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:41:53,249 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:41:53,250 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:41:53,252 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:41:53,256 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:41:53,261 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:41:53,263 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:41:53,268 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:41:53,268 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:41:53,274 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:41:53,280 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:41:53,286 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:41:53,286 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:41:53,316 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:41:53,329 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:41:53,347 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:41:53,361 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:41:53,367 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:41:53,373 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:41:53,388 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:41:53,407 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:41:53,428 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:41:53,469 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:41:53,525 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:41:53,596 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:41:53,601 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:41:53,607 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:41:53,613 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:41:53,619 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:41:53,623 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:41:53,627 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:41:53,627 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:41:53,668 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:41:53,673 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:41:53,681 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:41:53,687 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:41:53,691 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:41:53,699 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:41:53,733 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:41:53,733 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:41:53,735 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:41:53,763 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:41:53,776 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:41:53,776 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:41:53,778 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:41:53,778 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:41:53,793 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:41:53,799 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:41:53,825 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:41:53,825 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:41:53,829 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:41:53,835 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:41:53,836 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:41:53,840 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:41:53,840 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:41:53,862 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:41:53,871 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:41:53,877 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:41:53,881 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:41:53,885 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:41:53,893 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 12:41:53,903 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 12:41:53,907 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:46:51,600 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:46:51,601 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:46:51,612 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:46:51,615 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:46:51,615 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:46:51,616 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,619 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:46:51,620 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,622 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:46:51,622 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,624 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:46:51,624 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,627 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:46:51,627 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,630 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:46:51,633 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:46:51,633 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:46:51,635 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:46:51,636 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:46:51,643 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:46:51,643 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:46:51,644 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:46:51,655 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:46:51,657 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:46:51,657 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:46:51,658 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,659 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:46:51,660 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,661 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:46:51,662 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,664 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:46:51,664 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,666 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:46:51,667 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,669 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:46:51,669 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,670 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:46:51,670 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:46:51,676 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:46:51,678 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:46:51,679 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:46:51,679 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,680 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:46:51,682 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,682 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:46:51,688 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:46:51,690 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:46:51,691 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:46:51,691 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:46:51,703 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:46:51,706 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:46:51,706 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:46:51,706 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,708 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:46:51,708 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,709 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:46:51,710 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,711 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:46:51,712 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,714 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:46:51,715 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,717 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:46:51,717 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,719 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:46:51,719 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,721 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:46:51,721 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,723 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:46:51,723 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,724 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:46:51,724 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:46:51,730 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:46:51,733 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:46:51,734 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:46:51,734 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,735 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:46:51,736 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,737 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:46:51,738 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:46:51,738 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:46:51,739 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:46:51,746 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:46:51,751 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:46:51,756 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:46:51,758 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:46:51,765 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:46:51,766 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:46:51,775 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:46:51,778 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:46:51,787 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:46:51,788 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:46:51,798 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:46:51,810 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:46:51,816 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:46:51,821 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:46:51,832 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:46:51,836 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:46:51,839 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:46:51,843 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:46:51,847 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:46:51,851 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:46:51,852 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:46:51,858 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:46:51,863 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:46:51,870 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:46:51,876 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:46:51,881 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:46:51,884 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:46:51,888 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:46:51,889 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:46:51,893 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:46:51,898 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:46:51,902 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:46:51,910 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:46:51,914 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:46:51,917 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:46:51,943 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:46:51,943 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:46:51,945 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:46:51,969 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:46:51,986 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:46:51,986 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:46:51,988 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:46:51,989 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:46:52,008 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:46:52,012 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:46:52,046 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:46:52,047 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:46:52,052 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:46:52,057 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:46:52,058 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:46:52,061 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:46:52,061 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:46:52,085 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:47:05,098 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:47:05,098 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:47:05,111 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:47:05,114 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:47:05,115 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:47:05,115 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,117 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:47:05,117 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,119 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:47:05,119 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,120 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:47:05,121 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,122 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:47:05,123 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,126 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:47:05,128 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:47:05,129 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:47:05,129 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:47:05,129 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:47:05,137 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:47:05,137 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:47:05,138 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:47:05,147 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:47:05,150 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:47:05,150 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:47:05,150 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,152 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:47:05,153 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,155 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:47:05,155 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,157 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:47:05,157 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,159 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:47:05,159 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,161 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:47:05,161 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,162 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:47:05,162 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:47:05,167 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:47:05,170 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:47:05,171 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:47:05,171 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,172 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:47:05,173 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,173 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:47:05,179 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:47:05,180 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:47:05,181 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:47:05,182 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:47:05,194 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:47:05,197 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:47:05,197 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:47:05,197 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,198 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:47:05,199 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,200 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:47:05,200 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,202 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:47:05,203 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,205 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:47:05,205 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,207 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:47:05,208 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,209 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:47:05,209 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,211 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:47:05,212 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,213 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:47:05,213 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,214 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:47:05,214 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:47:05,219 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:47:05,223 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:47:05,223 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:47:05,224 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,226 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:47:05,226 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,229 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:47:05,230 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:47:05,230 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:47:05,231 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:47:05,233 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:47:05,237 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:47:05,242 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:47:05,244 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:47:05,248 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:47:05,248 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:47:05,257 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:47:05,260 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:47:05,265 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:47:05,265 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:47:05,275 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:47:05,283 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:47:05,290 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:47:05,295 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:47:05,299 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:47:05,303 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:47:05,307 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:47:05,311 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:47:05,314 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:47:05,317 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:47:05,318 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:47:05,325 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:47:05,330 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:47:05,335 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:47:05,342 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:47:05,346 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:47:05,350 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:47:05,354 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:47:05,355 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:47:05,360 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:47:05,363 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:47:05,367 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:47:05,374 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:47:05,377 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:47:05,381 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:47:05,402 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:47:05,403 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:47:05,404 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:47:05,426 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:47:05,437 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:47:05,437 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:47:05,439 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:47:05,439 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:47:05,449 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:47:05,453 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:47:05,482 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:47:05,483 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:47:05,488 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:47:05,494 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:47:05,495 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:47:05,499 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:47:05,500 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:47:05,533 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:47:05,543 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:47:05,549 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:47:05,556 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:47:05,559 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:47:05,569 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 12:47:05,575 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 12:47:05,579 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:49:08,677 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:49:08,679 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:49:08,758 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:49:08,769 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:49:08,769 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:49:08,769 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,774 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:49:08,774 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,776 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:49:08,777 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,780 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:49:08,780 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,783 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:49:08,783 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,788 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:49:08,793 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:49:08,793 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:49:08,793 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:49:08,794 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:49:08,808 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:49:08,808 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:49:08,809 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:49:08,824 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:49:08,834 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:49:08,834 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:49:08,835 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,837 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:49:08,837 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,839 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:49:08,839 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,840 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:49:08,841 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,842 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:49:08,842 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,843 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:49:08,844 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,845 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:49:08,845 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:49:08,851 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:49:08,857 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:49:08,857 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:49:08,858 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,859 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:49:08,860 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,860 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:49:08,868 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:49:08,870 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:49:08,871 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:49:08,871 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:49:08,884 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:49:08,891 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:49:08,891 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:49:08,891 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,893 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:49:08,893 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,895 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:49:08,895 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,897 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:49:08,897 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,899 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:49:08,899 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,901 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:49:08,902 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,904 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:49:08,904 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,905 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:49:08,906 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,908 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:49:08,909 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,909 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:49:08,909 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:49:08,916 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:49:08,924 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:49:08,924 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:49:08,925 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,926 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:49:08,927 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,928 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:49:08,928 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:49:08,929 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:49:08,929 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:49:08,939 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:49:08,944 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:49:08,949 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:49:08,951 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:49:08,959 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:49:08,959 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:49:08,968 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:49:08,970 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:49:08,985 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:49:08,985 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:51:34,969 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:51:51,424 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:51:51,424 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:51:51,451 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:51:51,454 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:51:51,454 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:51:51,454 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,456 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:51:51,458 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,461 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:51:51,461 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,466 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:51:51,467 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,470 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:51:51,470 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,473 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:51:51,504 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:51:51,523 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:51:51,525 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:51:51,526 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:51:51,555 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:51:51,556 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:51:51,557 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:51:51,596 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:51:51,600 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:51:51,601 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:51:51,602 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,604 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:51:51,605 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,608 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:51:51,609 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,611 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:51:51,611 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,614 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:51:51,615 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,618 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:51:51,619 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,620 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:51:51,621 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:51:51,640 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:51:51,647 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:51:51,654 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:51:51,656 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,665 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:51:51,671 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,671 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:51:51,682 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:51:51,693 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:51:51,695 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:51:51,697 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:51:51,731 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:51:51,736 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:51:51,736 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:51:51,738 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,740 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:51:51,741 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,744 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:51:51,745 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,749 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:51:51,750 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,754 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:51:51,754 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,756 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:51:51,757 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,759 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:51:51,760 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,770 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:51:51,776 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,780 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:51:51,780 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,782 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:51:51,783 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:51:51,792 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:51:51,795 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:51:51,797 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:51:51,797 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,811 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:51:51,812 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,815 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:51:51,815 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:51:51,816 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:51:51,817 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:51:51,827 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:51:51,845 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:51:51,860 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:51:51,867 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:51:51,877 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:51:51,878 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:51:51,932 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:51:51,959 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:51:52,005 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:51:52,005 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:51:52,019 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:51:52,055 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:51:52,089 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:51:52,104 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:51:52,115 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:51:52,122 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:51:52,126 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:51:52,154 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:51:52,221 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:51:52,225 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:51:52,225 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:51:52,244 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:51:52,254 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:51:52,265 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:51:52,273 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:51:52,280 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:51:52,288 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:51:52,305 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:51:52,306 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:51:52,312 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:51:52,321 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:51:52,331 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:51:52,341 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:51:52,345 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:51:52,360 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:51:52,430 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:51:52,431 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:51:52,435 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:51:52,487 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:51:52,540 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:51:52,540 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:51:52,542 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:51:52,545 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:51:52,581 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:51:52,591 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:51:52,643 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:51:52,662 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:51:52,668 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:51:52,675 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:51:52,676 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:51:52,680 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:51:52,682 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:51:52,726 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:51:52,768 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:51:52,775 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:51:52,790 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:51:52,803 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:51:52,814 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 12:51:52,841 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 12:51:52,845 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:58:50,097 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:58:50,098 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:58:50,107 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:58:50,110 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:58:50,111 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:58:50,111 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,114 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:58:50,119 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,122 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:58:50,123 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,125 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:58:50,126 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,128 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:58:50,131 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,134 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:58:50,136 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:58:50,137 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:58:50,137 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:58:50,138 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:58:50,143 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:58:50,144 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:58:50,144 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:58:50,153 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:58:50,155 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:58:50,156 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:58:50,156 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,158 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:58:50,159 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,160 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:58:50,161 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,167 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:58:50,168 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,169 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:58:50,170 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,173 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:58:50,174 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,175 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:58:50,175 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:58:50,181 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:58:50,183 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:58:50,184 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:58:50,184 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,186 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:58:50,187 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,187 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:58:50,194 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:58:50,196 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:58:50,196 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:58:50,197 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:58:50,210 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:58:50,213 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:58:50,214 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:58:50,215 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,217 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:58:50,218 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,220 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:58:50,222 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,227 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:58:50,227 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,229 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:58:50,230 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,232 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:58:50,233 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,234 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:58:50,235 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,237 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:58:50,237 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,240 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:58:50,240 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,241 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:58:50,241 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:58:50,247 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:58:50,250 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:58:50,250 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:58:50,251 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,252 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:58:50,253 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,255 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:58:50,256 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:58:50,256 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:58:50,256 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:58:50,262 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:58:50,266 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:58:50,272 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:58:50,274 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:58:50,279 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:58:50,279 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:58:50,285 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:58:50,288 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:58:50,297 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:58:50,297 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:58:50,309 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 12:58:50,324 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 12:58:50,331 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 12:58:50,337 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:58:50,343 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:58:50,346 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:58:50,353 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:58:50,357 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:58:50,360 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:58:50,367 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 12:58:50,368 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 12:58:50,376 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 12:58:50,382 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 12:58:50,388 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:58:50,395 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:58:50,400 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:58:50,405 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:58:50,409 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 12:58:50,410 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:58:50,419 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:58:50,423 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:58:50,429 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:58:50,439 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:58:50,446 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:58:50,449 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:58:50,466 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:58:50,466 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:58:50,469 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:58:50,475 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:58:50,489 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:58:50,490 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:58:50,491 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:58:50,491 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:58:50,504 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:58:50,509 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:58:50,538 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:58:50,539 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:58:50,546 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:58:50,552 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:58:50,553 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:58:50,560 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:58:50,560 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:58:50,588 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:58:50,598 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:58:50,608 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:58:50,613 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:58:50,617 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:58:50,626 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 12:58:50,637 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 12:58:50,640 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:59:16,007 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:16,007 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:59:16,022 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:16,026 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:16,027 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:59:16,027 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,029 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:59:16,030 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,031 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:59:16,031 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,032 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:59:16,033 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,036 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:59:16,037 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,040 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:59:16,042 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:59:16,043 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:59:16,044 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:59:16,044 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:59:16,050 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:59:16,050 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:16,051 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:59:16,062 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:16,064 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:16,064 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:59:16,065 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,067 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:59:16,068 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,069 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:59:16,070 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,071 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:59:16,072 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,084 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:59:16,085 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,086 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:59:16,087 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,088 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:16,089 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:59:16,096 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:16,098 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:16,103 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:59:16,106 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,110 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:59:16,111 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,113 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:59:16,119 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:59:16,121 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:59:16,121 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:16,122 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:59:16,146 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:16,149 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:16,150 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:59:16,150 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,151 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:59:16,152 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,154 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:59:16,155 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,156 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:59:16,157 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,158 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:59:16,158 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,160 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:59:16,161 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,163 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:59:16,163 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,165 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:59:16,167 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,175 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:59:16,176 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,176 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:16,177 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:59:16,183 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:16,187 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:16,188 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:59:16,188 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,189 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:59:16,190 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,191 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:59:16,192 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:16,192 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:59:16,192 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:59:16,196 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:59:16,211 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:59:16,217 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:59:16,218 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:59:16,223 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:59:16,224 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:59:16,244 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:59:16,248 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:59:16,255 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:59:16,255 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:59:16,262 [INFO] pc_project: Computing metrics at level: ['entity_id', 'deal_id', 'fund']
2025-10-26 12:59:16,287 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:59:16,293 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'deal_id', 'fund'].
2025-10-26 12:59:16,301 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:59:16,320 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:59:16,323 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:59:16,327 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:59:16,332 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:59:16,350 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:59:16,355 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'deal_id', 'fund'] records.
2025-10-26 12:59:16,355 [INFO] pc_project: Computing metrics at level: ['deal_id', 'fund']
2025-10-26 12:59:16,370 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:59:16,377 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'fund'].
2025-10-26 12:59:16,383 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:59:16,388 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:59:16,457 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:59:16,472 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:59:16,475 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'fund'] records.
2025-10-26 12:59:16,476 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:59:16,483 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:59:16,498 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:59:16,505 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:59:16,512 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:59:16,515 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:59:16,519 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:59:16,534 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:59:16,534 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:59:16,536 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:59:16,540 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:59:16,554 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:59:16,554 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:59:16,556 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:59:16,556 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:59:16,570 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:59:16,574 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:59:16,598 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:59:16,599 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:59:16,603 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:59:16,609 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:59:16,610 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:59:16,615 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:59:16,616 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:59:16,643 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:59:16,654 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:59:16,661 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:59:16,666 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:59:16,671 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:59:16,682 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 12:59:16,688 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 12:59:16,694 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:59:54,375 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:54,375 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 12:59:54,388 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:54,392 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:54,392 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 12:59:54,392 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,395 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 12:59:54,395 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,397 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 12:59:54,402 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,415 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 12:59:54,416 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,417 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 12:59:54,418 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,421 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 12:59:54,423 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 12:59:54,424 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 12:59:54,424 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 12:59:54,425 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 12:59:54,431 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 12:59:54,432 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:54,432 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 12:59:54,466 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:54,469 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:54,469 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 12:59:54,469 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,471 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:59:54,471 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,473 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 12:59:54,474 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,476 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 12:59:54,477 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,492 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 12:59:54,493 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,495 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 12:59:54,495 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,496 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:54,496 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 12:59:54,502 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:54,504 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:54,505 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 12:59:54,505 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,507 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 12:59:54,508 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,508 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 12:59:54,523 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 12:59:54,525 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 12:59:54,526 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:54,526 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 12:59:54,542 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:54,544 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:54,545 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 12:59:54,545 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,547 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 12:59:54,548 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,550 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 12:59:54,550 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,552 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 12:59:54,552 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,553 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 12:59:54,554 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,555 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 12:59:54,556 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,557 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 12:59:54,558 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,559 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 12:59:54,560 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,565 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 12:59:54,565 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,566 [INFO] pc_project: Starting data cleaning.
2025-10-26 12:59:54,566 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 12:59:54,572 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 12:59:54,575 [INFO] pc_project: Data cleaning complete.
2025-10-26 12:59:54,575 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 12:59:54,576 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,583 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 12:59:54,583 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,585 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 12:59:54,585 [INFO] pc_project: --------------------------------------------------
2025-10-26 12:59:54,586 [INFO] pc_project: Starting merge pipeline...
2025-10-26 12:59:54,587 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 12:59:54,591 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 12:59:54,597 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 12:59:54,602 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 12:59:54,605 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 12:59:54,612 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 12:59:54,612 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 12:59:54,618 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 12:59:54,620 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 12:59:54,629 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 12:59:54,630 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 12:59:54,638 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 12:59:54,649 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 12:59:54,655 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 12:59:54,664 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 12:59:54,669 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 12:59:54,673 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 12:59:54,679 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 12:59:54,682 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 12:59:54,686 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:59:54,691 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 12:59:54,691 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 12:59:54,700 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 12:59:54,708 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 12:59:54,714 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 12:59:54,719 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 12:59:54,723 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 12:59:54,727 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:59:54,730 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 12:59:54,731 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:59:54,739 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:59:54,745 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:59:54,749 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:59:54,756 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 12:59:54,761 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 12:59:54,765 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 12:59:54,782 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 12:59:54,782 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 12:59:54,784 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 12:59:54,787 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 12:59:54,803 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 12:59:54,803 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 12:59:54,805 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 12:59:54,806 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 12:59:54,820 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 12:59:54,824 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 12:59:54,852 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 12:59:54,852 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 12:59:54,857 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 12:59:54,865 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 12:59:54,867 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 12:59:54,870 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 12:59:54,871 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 12:59:54,901 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 12:59:54,913 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 12:59:54,918 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 12:59:54,923 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 12:59:54,928 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 12:59:54,945 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 12:59:54,951 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 12:59:54,955 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:00:21,699 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:00:21,700 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:00:21,714 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:00:21,722 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:00:21,728 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:00:21,730 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,737 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:00:21,739 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,741 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:00:21,741 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,743 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:00:21,744 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,746 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:00:21,746 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,749 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:00:21,751 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:00:21,752 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:00:21,752 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:00:21,752 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:00:21,759 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:00:21,760 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:00:21,760 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:00:21,776 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:00:21,779 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:00:21,779 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:00:21,779 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,781 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:00:21,781 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,783 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:00:21,784 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,786 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:00:21,792 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,797 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:00:21,798 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,800 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:00:21,802 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,802 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:00:21,803 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:00:21,808 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:00:21,810 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:00:21,810 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:00:21,810 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,812 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:00:21,812 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,812 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:00:21,822 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:00:21,823 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:00:21,824 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:00:21,824 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:00:21,840 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:00:21,842 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:00:21,842 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:00:21,843 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,844 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:00:21,845 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,847 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:00:21,847 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,849 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:00:21,850 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,851 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:00:21,852 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,853 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:00:21,854 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,855 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:00:21,856 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,858 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:00:21,859 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,860 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:00:21,861 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,861 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:00:21,862 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:00:21,870 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:00:21,873 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:00:21,873 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:00:21,873 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,875 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:00:21,875 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,876 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:00:21,877 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:00:21,877 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:00:21,877 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:00:21,880 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:00:21,887 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:00:21,892 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:00:21,894 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:00:21,900 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:00:21,902 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:00:21,911 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:00:21,915 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:00:21,921 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:00:21,921 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:00:21,930 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:00:21,941 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:00:21,950 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:00:21,956 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:00:21,961 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:00:21,964 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:00:21,969 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:00:21,974 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:00:21,980 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:00:21,984 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:00:21,985 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:00:21,991 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:00:21,997 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:00:22,004 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:00:22,012 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:00:22,016 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:00:22,021 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:00:22,025 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:00:22,026 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:00:22,031 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:00:22,036 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:00:22,042 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:00:22,049 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:00:22,054 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:00:22,058 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:00:22,074 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:00:22,074 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:00:22,076 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 8, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:00:22,083 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:00:22,095 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:00:22,096 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:00:22,098 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:00:22,098 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:00:22,112 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:00:22,117 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:00:22,143 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:00:22,144 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:00:22,148 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:00:22,157 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:00:22,158 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:00:22,162 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:00:22,162 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:00:22,191 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:00:22,201 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:00:22,209 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:00:22,215 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:00:22,220 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:00:22,230 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:00:22,237 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:00:22,240 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:04:37,688 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:04:37,689 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:04:37,701 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:04:37,705 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:04:37,705 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:04:37,706 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,708 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:04:37,709 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,712 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:04:37,715 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,730 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:04:37,731 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,733 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:04:37,733 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,745 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:04:37,747 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:04:37,748 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:04:37,748 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:04:37,748 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:04:37,768 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:04:37,768 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:04:37,769 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:04:37,790 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:04:37,823 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:04:37,823 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:04:37,824 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,826 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:04:37,827 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,829 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:04:37,831 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,832 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:04:37,833 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,834 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:04:37,835 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,836 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:04:37,837 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,837 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:04:37,838 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:04:37,845 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:04:37,850 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:04:37,850 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:04:37,853 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,857 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:04:37,858 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,859 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:04:37,867 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:04:37,868 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:04:37,869 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:04:37,869 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:04:37,889 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:04:37,893 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:04:37,899 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:04:37,900 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,902 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:04:37,903 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,906 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:04:37,908 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,910 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:04:37,911 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,913 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:04:37,913 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,915 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:04:37,915 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,917 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:04:37,917 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,919 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:04:37,920 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,922 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:04:37,923 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,923 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:04:37,924 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:04:37,934 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:04:37,939 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:04:37,940 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:04:37,941 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,949 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:04:37,951 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,955 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:04:37,955 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:04:37,957 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:04:37,957 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:04:37,964 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:04:37,984 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:04:38,004 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:04:38,011 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:04:38,026 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:04:38,029 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:04:38,049 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:04:38,058 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:04:38,072 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:04:38,073 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:04:38,087 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:04:38,135 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:04:38,146 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:04:38,163 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:04:38,172 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:04:38,177 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:04:38,182 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:04:38,191 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:04:38,198 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:04:38,203 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:04:38,203 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:04:38,234 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:04:38,261 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:04:38,289 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:04:38,298 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:04:38,303 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:04:38,309 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:04:38,324 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:04:38,328 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:04:38,336 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:04:38,343 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:04:38,351 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:04:38,373 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:04:38,378 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:04:38,386 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:04:38,426 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:04:38,427 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:04:38,430 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:04:38,435 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:04:38,464 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:04:38,464 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:04:38,467 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:04:38,468 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:04:38,487 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:04:38,492 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:04:38,535 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:04:38,536 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:04:38,541 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:04:38,569 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:04:38,570 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:04:38,573 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:04:38,573 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:04:38,654 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:04:38,668 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:04:38,685 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:04:38,694 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:04:38,713 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:04:38,731 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:04:38,741 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:04:38,747 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:08:19,898 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:08:19,898 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:08:19,916 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:08:19,919 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:08:19,919 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:08:19,920 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,925 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:08:19,925 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,926 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:08:19,927 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,929 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:08:19,929 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,932 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:08:19,932 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,935 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:08:19,938 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:08:19,939 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:08:19,941 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:08:19,941 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:08:19,946 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:08:19,946 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:08:19,947 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:08:19,975 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:08:19,978 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:08:19,978 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:08:19,979 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,980 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:08:19,981 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,986 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:08:19,986 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,988 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:08:19,988 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,990 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:08:19,991 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,993 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:08:19,993 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:19,994 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:08:19,994 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:08:20,004 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:08:20,007 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:08:20,008 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:08:20,008 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,010 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:08:20,010 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,011 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:08:20,024 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:08:20,027 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:08:20,028 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:08:20,029 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:08:20,044 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:08:20,047 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:08:20,048 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:08:20,048 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,050 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:08:20,052 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,055 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:08:20,055 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,058 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:08:20,058 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,060 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:08:20,061 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,064 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:08:20,065 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,067 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:08:20,068 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,069 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:08:20,070 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,071 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:08:20,072 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,072 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:08:20,073 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:08:20,077 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:08:20,081 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:08:20,082 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:08:20,082 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,084 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:08:20,084 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,086 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:08:20,088 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:08:20,088 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:08:20,089 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:08:20,092 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:08:20,099 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:08:20,104 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:08:20,106 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:08:20,111 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:08:20,111 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:08:20,117 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:08:20,123 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:08:20,137 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:08:20,137 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:08:20,155 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:08:20,164 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:08:20,173 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:08:20,182 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:08:20,187 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:08:20,193 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:08:20,197 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:08:20,201 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:08:20,204 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:08:20,208 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:08:20,209 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:08:20,219 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:08:20,227 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:08:20,234 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:08:20,244 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:08:20,256 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:08:20,261 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:08:20,265 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:08:20,268 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:08:20,277 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:08:20,281 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:08:20,288 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:08:20,302 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:08:20,308 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:08:20,311 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:08:20,332 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:08:20,332 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:08:20,335 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:08:20,341 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:08:20,359 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:08:20,360 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:08:20,362 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:08:20,362 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:08:20,384 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:08:20,390 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:08:20,422 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:08:20,423 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:08:20,431 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:08:20,440 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:08:20,441 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:08:20,450 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:08:20,451 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:08:20,489 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:08:20,501 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:08:20,508 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:08:20,513 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:08:20,519 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:08:20,532 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:08:20,542 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:08:20,545 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:11:15,187 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:15,188 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:11:15,205 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:15,224 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:15,224 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:11:15,224 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,227 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:11:15,227 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,229 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:11:15,229 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,232 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:11:15,233 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,235 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:11:15,235 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,237 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:11:15,241 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:11:15,242 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:11:15,242 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:11:15,243 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:11:15,252 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:11:15,253 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:15,253 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:11:15,264 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:15,269 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:15,269 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:11:15,270 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,272 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:11:15,273 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,274 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:11:15,275 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,277 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:11:15,277 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,280 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:11:15,280 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,283 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:11:15,283 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,284 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:15,284 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:11:15,289 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:15,291 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:15,291 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:11:15,291 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,293 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:11:15,293 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,293 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:11:15,299 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:11:15,302 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:11:15,304 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:15,304 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:11:15,316 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:15,321 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:15,322 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:11:15,322 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,324 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:11:15,325 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,327 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:11:15,328 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,329 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:11:15,330 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,332 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:11:15,332 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,336 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:11:15,337 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,338 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:11:15,339 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,341 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:11:15,342 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,344 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:11:15,344 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,345 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:15,345 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:11:15,353 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:15,356 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:15,358 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:11:15,359 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,360 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:11:15,361 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,362 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:11:15,362 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:15,363 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:11:15,363 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:11:15,369 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:11:15,375 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:11:15,379 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:11:15,381 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:11:15,387 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:11:15,388 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:11:15,398 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:11:15,401 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:11:15,408 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:11:15,408 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:11:15,417 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:11:15,429 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:11:15,438 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:11:15,443 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:11:15,447 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:11:15,450 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:11:15,457 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:11:15,461 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:11:15,466 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:11:15,471 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:11:15,472 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:11:15,479 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:11:15,488 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:11:15,494 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:11:15,499 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:11:15,506 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:11:15,515 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:11:15,520 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:11:15,520 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:11:15,526 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:11:15,533 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:11:15,539 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:11:15,548 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:11:15,552 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:11:15,558 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:11:15,572 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:11:15,573 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:11:15,574 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:11:15,585 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:11:15,600 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:11:15,600 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:11:15,605 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:11:15,605 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:11:15,622 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:11:15,633 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:11:15,659 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:11:15,660 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:11:15,665 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:11:15,672 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:11:15,678 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:11:15,683 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:11:15,683 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:11:15,714 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:11:15,727 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:11:15,737 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:11:15,743 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:11:15,748 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:11:15,762 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:11:15,776 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:11:15,781 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:11:37,736 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:37,737 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:11:37,754 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:37,757 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:37,757 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:11:37,758 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,763 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:11:37,764 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,766 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:11:37,766 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,768 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:11:37,768 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,770 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:11:37,771 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,773 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:11:37,775 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:11:37,776 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:11:37,777 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:11:37,777 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:11:37,784 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:11:37,784 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:37,785 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:11:37,800 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:37,803 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:37,803 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:11:37,804 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,806 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:11:37,806 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,809 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:11:37,810 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,812 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:11:37,813 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,814 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:11:37,815 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,816 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:11:37,817 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,817 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:37,817 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:11:37,822 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:37,824 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:37,824 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:11:37,826 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,827 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:11:37,828 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,828 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:11:37,834 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:11:37,837 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:11:37,838 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:37,838 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:11:37,851 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:37,854 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:37,855 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:11:37,856 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,858 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:11:37,858 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,860 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:11:37,861 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,862 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:11:37,863 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,865 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:11:37,865 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,867 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:11:37,867 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,868 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:11:37,869 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,870 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:11:37,871 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,872 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:11:37,873 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,873 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:11:37,873 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:11:37,881 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:11:37,885 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:11:37,886 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:11:37,886 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,889 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:11:37,889 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,891 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:11:37,891 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:11:37,891 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:11:37,892 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:11:37,895 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:11:37,904 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:11:37,908 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:11:37,911 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:11:37,917 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:11:37,917 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:11:37,923 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:11:37,925 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:11:37,934 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:11:37,936 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:11:37,946 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:11:37,955 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:11:37,960 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:11:37,969 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:11:37,973 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:11:37,978 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:11:37,983 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:11:37,988 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:11:37,992 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:11:37,999 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:11:37,999 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:11:38,008 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:11:38,014 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:11:38,021 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:11:38,029 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:11:38,034 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:11:38,038 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:11:38,042 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:11:38,042 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:11:38,051 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:11:38,055 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:11:38,061 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:11:38,067 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:11:38,071 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:11:38,074 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:11:38,088 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:11:38,090 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:11:38,092 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:11:38,097 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:11:38,108 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:11:38,109 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:11:38,110 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:11:38,111 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:11:38,126 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:11:38,130 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:11:38,155 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:11:38,155 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:11:38,160 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:11:38,169 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:11:38,169 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:11:38,172 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:11:38,173 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:11:38,203 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:11:38,212 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:11:38,220 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:11:38,225 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:11:38,232 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:11:38,240 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:11:38,250 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:11:38,254 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:12:02,956 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:02,956 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:12:02,969 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:02,972 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:02,973 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:12:02,973 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:02,975 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:12:02,976 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:02,978 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:12:02,978 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:02,982 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:12:02,983 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:02,985 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:12:02,985 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:02,988 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:12:02,991 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:12:02,991 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:12:02,991 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:12:02,992 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:12:02,996 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:12:02,997 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:02,997 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:12:03,005 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:03,008 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:03,008 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:12:03,009 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,010 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:12:03,011 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,013 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:12:03,014 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,016 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:12:03,016 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,019 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:12:03,019 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,021 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:12:03,022 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,023 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:03,023 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:12:03,028 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:03,030 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:03,030 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:12:03,031 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,032 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:12:03,032 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,033 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:12:03,037 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:12:03,041 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:12:03,042 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:03,042 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:12:03,057 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:03,063 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:03,063 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:12:03,063 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,065 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:12:03,066 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,069 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:12:03,069 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,071 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:12:03,072 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,073 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:12:03,073 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,075 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:12:03,075 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,077 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:12:03,077 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,079 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:12:03,079 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,080 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:12:03,080 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,080 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:03,081 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:12:03,085 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:03,088 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:03,089 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:12:03,091 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,096 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:12:03,096 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,099 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:12:03,099 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:03,100 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:12:03,100 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:12:03,103 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:12:03,109 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:12:03,116 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:12:03,119 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:12:03,125 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:12:03,125 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:12:03,130 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:12:03,132 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:12:03,137 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:12:03,137 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:12:03,148 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:12:03,159 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:12:03,165 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:12:03,175 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:12:03,179 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:12:03,183 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:12:03,189 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:12:03,192 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:12:03,195 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:12:03,199 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:12:03,199 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:12:03,206 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:12:03,212 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:12:03,222 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:12:03,227 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:12:03,231 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:12:03,235 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:12:03,240 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:12:03,240 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:12:03,245 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:12:03,249 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:12:03,256 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:12:03,262 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:12:03,265 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:12:03,268 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:12:03,280 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:12:03,281 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:12:03,284 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:12:03,289 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:12:03,301 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:12:03,302 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:12:03,303 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:12:03,304 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:12:03,320 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:12:03,325 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:12:03,352 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:12:03,353 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:12:03,359 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:12:03,366 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:12:03,367 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:12:03,371 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:12:03,372 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:12:03,402 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:12:03,415 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:12:03,424 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:12:03,428 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:12:03,432 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:12:03,443 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:12:03,450 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:12:03,455 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:12:54,480 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:54,481 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:12:54,493 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:54,497 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:54,497 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:12:54,497 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,499 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:12:54,499 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,501 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:12:54,503 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,507 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:12:54,508 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,510 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:12:54,510 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,513 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:12:54,515 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:12:54,518 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:12:54,519 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:12:54,519 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:12:54,525 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:12:54,525 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:54,526 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:12:54,534 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:54,536 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:54,536 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:12:54,537 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,539 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:12:54,539 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,541 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:12:54,541 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,542 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:12:54,543 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,546 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:12:54,547 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,551 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:12:54,552 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,553 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:54,553 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:12:54,560 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:54,601 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:54,604 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:12:54,622 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,624 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:12:54,626 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,626 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:12:54,634 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:12:54,636 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:12:54,637 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:54,637 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:12:54,652 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:54,667 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:54,667 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:12:54,668 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,669 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:12:54,670 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,672 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:12:54,673 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,676 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:12:54,677 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,678 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:12:54,679 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,681 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:12:54,681 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,683 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:12:54,683 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,685 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:12:54,686 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,689 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:12:54,689 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,690 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:12:54,692 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:12:54,699 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:12:54,702 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:12:54,703 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:12:54,703 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,705 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:12:54,708 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,712 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:12:54,713 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:12:54,713 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:12:54,714 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:12:54,718 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:12:54,725 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:12:54,731 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:12:54,733 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:12:54,744 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:12:54,745 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:12:54,753 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:12:54,757 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:12:54,766 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:12:54,767 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:12:54,776 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:12:54,785 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:12:54,793 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:12:54,803 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:12:54,808 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:12:54,812 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:12:54,818 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:12:54,823 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:12:54,827 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:12:54,832 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:12:54,833 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:12:54,843 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:12:54,851 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:12:54,858 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:12:54,867 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:12:54,874 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:12:54,879 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:12:54,883 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:12:54,883 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:12:54,893 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:12:54,896 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:12:54,901 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:12:54,908 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:12:54,919 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:12:54,926 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:12:54,938 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:12:54,939 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:12:54,942 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:12:54,946 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:12:54,964 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:12:54,964 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:12:54,966 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:12:54,966 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:12:54,981 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:12:54,986 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:12:55,012 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:12:55,013 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:12:55,018 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:12:55,026 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:12:55,027 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:12:55,031 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:12:55,031 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:12:55,061 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:12:55,070 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:12:55,076 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:12:55,082 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:12:55,087 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:12:55,097 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:12:55,104 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:12:55,109 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:13:28,600 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:13:28,600 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:13:28,610 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:13:28,613 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:13:28,614 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:13:28,614 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,616 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:13:28,617 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,618 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:13:28,619 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,624 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:13:28,624 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,627 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:13:28,627 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,630 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:13:28,633 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:13:28,633 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:13:28,633 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:13:28,634 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:13:28,640 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:13:28,641 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:13:28,641 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:13:28,652 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:13:28,655 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:13:28,655 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:13:28,656 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,658 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:13:28,659 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,660 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:13:28,661 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,662 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:13:28,663 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,664 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:13:28,665 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,667 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:13:28,667 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,668 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:13:28,668 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:13:28,673 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:13:28,676 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:13:28,676 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:13:28,676 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,678 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:13:28,678 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,679 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:13:28,686 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:13:28,688 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:13:28,689 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:13:28,689 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:13:28,702 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:13:28,705 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:13:28,705 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:13:28,706 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,708 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:13:28,708 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,710 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:13:28,710 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,712 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:13:28,713 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,715 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:13:28,715 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,716 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:13:28,717 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,718 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:13:28,718 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,719 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:13:28,720 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,721 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:13:28,721 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,722 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:13:28,723 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:13:28,731 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:13:28,734 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:13:28,734 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:13:28,734 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,736 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:13:28,736 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,737 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:13:28,738 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:13:28,738 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:13:28,739 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:13:28,743 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:13:28,750 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:13:28,755 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:13:28,757 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:13:28,766 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:13:28,767 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:13:28,774 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:13:28,777 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:13:28,783 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:13:28,783 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:13:28,794 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:13:28,805 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:13:28,813 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:13:28,819 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:13:28,824 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:13:28,831 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:13:28,834 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:13:28,838 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:13:28,845 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:13:28,848 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:13:28,849 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:13:28,855 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:13:28,862 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:13:28,868 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:13:28,877 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:13:28,881 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:13:28,884 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:13:28,888 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:13:28,889 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:13:28,897 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:13:28,900 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:13:28,906 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:13:28,912 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:13:28,916 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:13:28,920 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:13:28,933 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:13:28,933 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:13:28,937 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:13:28,941 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:13:28,953 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:13:28,953 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:13:28,955 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:13:28,956 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:13:28,970 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:13:28,975 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:13:29,001 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:13:29,001 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:13:29,006 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:13:29,015 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:13:29,016 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:13:29,019 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:13:29,019 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:13:29,052 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:13:29,060 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:13:29,070 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:13:29,075 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:13:29,081 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:13:29,090 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:13:29,103 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:13:29,108 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:14:17,757 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:17,758 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:14:17,770 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:17,772 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:17,773 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:14:17,773 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,775 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:14:17,776 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,777 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:14:17,777 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,779 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:14:17,780 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,782 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:14:17,782 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,785 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:14:17,787 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:14:17,787 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:14:17,790 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:14:17,790 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:14:17,796 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:14:17,796 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:17,797 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:14:17,807 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:17,811 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:17,811 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:14:17,811 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,813 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:14:17,813 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,814 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:14:17,815 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,818 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:14:17,821 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,823 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:14:17,823 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,825 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:14:17,825 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,827 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:17,827 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:14:17,833 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:17,835 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:17,835 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:14:17,836 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,837 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:14:17,838 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,838 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:14:17,842 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:14:17,845 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:14:17,845 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:17,846 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:14:17,859 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:17,864 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:17,864 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:14:17,864 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,868 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:14:17,869 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,870 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:14:17,871 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,873 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:14:17,873 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,875 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:14:17,875 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,877 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:14:17,877 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,879 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:14:17,879 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,884 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:14:17,885 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,887 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:14:17,887 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,888 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:17,888 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:14:17,895 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:17,897 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:17,898 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:14:17,899 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,900 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:14:17,901 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,902 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:14:17,902 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:17,903 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:14:17,903 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:14:17,906 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:14:17,909 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:14:17,915 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:14:17,917 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:14:17,923 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:14:17,923 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:14:17,931 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:14:17,934 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:14:17,938 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:14:17,938 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:14:17,948 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:14:17,957 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:14:17,965 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:14:17,971 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:14:17,974 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:14:17,980 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:14:17,985 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:14:17,989 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:14:17,995 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:14:17,999 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:14:17,999 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:14:18,005 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:14:18,014 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:14:18,019 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:14:18,025 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:14:18,030 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:14:18,034 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:14:18,070 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:14:18,071 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:14:18,104 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:14:18,109 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:14:18,135 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:14:18,141 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:14:18,145 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:14:18,149 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:14:18,170 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:14:18,171 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:14:18,172 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:14:18,178 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:14:18,197 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:14:18,199 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:14:18,200 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:14:18,201 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:14:18,216 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:14:18,220 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:14:18,253 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:14:18,254 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:14:18,258 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:14:18,268 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:14:18,269 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:14:18,275 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:14:18,278 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:14:18,310 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:14:18,320 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:14:18,331 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:14:18,336 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:14:18,341 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:14:18,353 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:14:18,363 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:14:18,367 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:14:32,127 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:32,127 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:14:32,144 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:32,147 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:32,148 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:14:32,148 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,150 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:14:32,151 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,153 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:14:32,153 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,155 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:14:32,157 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,162 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:14:32,163 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,167 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:14:32,169 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:14:32,170 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:14:32,170 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:14:32,170 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:14:32,177 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:14:32,178 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:32,178 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:14:32,189 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:32,193 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:32,194 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:14:32,194 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,196 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:14:32,197 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,199 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:14:32,200 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,202 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:14:32,202 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,204 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:14:32,204 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,205 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:14:32,206 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,206 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:32,207 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:14:32,216 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:32,221 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:32,221 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:14:32,221 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,224 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:14:32,224 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,225 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:14:32,233 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:14:32,235 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:14:32,235 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:32,236 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:14:32,253 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:32,257 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:32,258 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:14:32,258 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,260 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:14:32,261 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,263 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:14:32,264 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,268 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:14:32,269 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,273 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:14:32,273 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,276 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:14:32,277 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,278 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:14:32,279 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,282 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:14:32,282 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,284 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:14:32,285 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,285 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:14:32,286 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:14:32,291 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:14:32,293 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:14:32,294 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:14:32,294 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,295 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:14:32,296 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,299 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:14:32,300 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:14:32,300 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:14:32,301 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:14:32,306 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:14:32,311 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:14:32,320 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:14:32,322 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:14:32,328 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:14:32,328 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:14:32,336 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:14:32,339 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:14:32,355 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:14:32,355 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:14:32,365 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:14:32,377 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:14:32,387 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:14:32,395 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:14:32,402 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:14:32,408 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:14:32,413 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:14:32,420 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:14:32,424 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:14:32,431 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:14:32,431 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:14:32,441 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:14:32,453 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:14:32,463 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:14:32,469 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:14:32,474 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:14:32,479 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:14:32,483 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:14:32,485 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:14:32,491 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:14:32,497 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:14:32,502 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:14:32,509 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:14:32,513 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:14:32,519 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:14:32,535 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:14:32,535 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:14:32,537 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:14:32,541 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:14:32,556 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:14:32,557 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:14:32,558 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:14:32,559 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:14:32,572 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:14:32,576 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:14:32,604 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:14:32,605 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:14:32,616 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:14:32,624 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:14:32,627 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:14:32,632 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:14:32,632 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:14:32,659 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:14:32,671 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:14:32,677 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:14:32,683 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:14:32,687 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:14:32,698 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:14:32,706 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:14:32,709 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:17:12,363 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:17:12,364 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:17:12,378 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:17:12,381 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:17:12,381 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:17:12,381 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,383 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:17:12,384 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,385 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:17:12,385 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,388 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:17:12,388 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,390 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:17:12,391 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,394 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:17:12,396 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:17:12,396 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:17:12,397 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:17:12,397 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:17:12,402 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:17:12,402 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:17:12,403 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:17:12,419 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:17:12,423 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:17:12,424 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:17:12,424 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,426 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:17:12,427 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,428 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:17:12,429 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,432 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:17:12,432 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,435 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:17:12,435 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,437 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:17:12,438 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,438 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:17:12,438 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:17:12,446 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:17:12,451 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:17:12,451 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:17:12,452 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,454 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:17:12,455 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,456 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:17:12,466 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:17:12,467 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:17:12,468 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:17:12,468 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:17:12,481 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:17:12,481 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:17:12,481 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:17:12,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,481 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:17:12,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,481 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:17:12,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,498 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:17:12,499 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,500 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:17:12,501 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,502 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:17:12,502 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,506 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:17:12,507 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,508 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:17:12,510 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,510 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:17:12,510 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,510 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:17:12,510 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:17:12,520 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:17:12,523 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:17:12,524 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:17:12,524 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,527 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:17:12,528 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,531 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:17:12,531 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:17:12,532 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:17:12,532 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:17:12,535 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:17:12,538 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:17:12,543 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:17:12,546 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:17:12,554 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:17:12,554 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:17:12,560 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:17:12,564 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:17:12,569 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:17:12,570 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:17:12,577 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:17:12,590 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:17:12,598 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:17:12,606 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:17:12,609 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:17:12,616 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:17:12,619 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:17:12,623 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:17:12,627 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:17:12,631 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:17:12,633 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:17:12,639 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:17:12,643 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:17:12,651 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:17:12,658 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:17:12,664 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:17:12,668 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:17:12,671 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:17:12,671 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:17:12,676 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:17:12,682 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:17:12,686 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:17:12,694 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:17:12,700 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:17:12,704 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:17:12,718 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:17:12,718 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:17:12,720 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:17:12,724 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:17:12,740 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:17:12,740 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:17:12,741 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:17:12,743 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:17:12,756 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:17:12,761 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:17:12,784 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:17:12,785 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:17:12,789 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:17:12,799 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:17:12,800 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:17:12,804 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:17:12,804 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:17:12,836 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:17:12,845 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:17:12,854 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:17:12,859 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:17:12,864 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:17:12,874 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:17:12,881 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:17:12,886 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:18:30,953 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:18:30,954 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:18:30,965 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:18:30,968 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:18:30,968 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:18:30,969 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:30,970 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:18:30,971 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:30,972 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:18:30,972 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:30,974 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:18:30,974 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:30,975 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:18:30,976 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:30,979 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:18:30,982 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:18:30,982 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:18:30,984 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:18:30,985 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:18:30,992 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:18:30,993 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:18:30,993 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:18:31,005 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:18:31,008 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:18:31,009 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:18:31,009 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,011 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:18:31,011 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,013 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:18:31,013 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,017 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:18:31,017 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,020 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:18:31,021 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,023 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:18:31,023 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,024 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:18:31,025 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:18:31,030 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:18:31,033 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:18:31,033 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:18:31,033 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,034 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:18:31,035 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,035 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:18:31,043 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:18:31,044 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:18:31,044 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:18:31,045 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:18:31,060 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:18:31,064 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:18:31,065 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:18:31,065 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,067 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:18:31,067 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,069 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:18:31,070 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,072 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:18:31,075 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,077 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:18:31,079 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,081 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:18:31,082 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,084 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:18:31,084 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,086 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:18:31,087 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,091 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:18:31,091 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,095 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:18:31,095 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:18:31,101 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:18:31,104 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:18:31,106 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:18:31,107 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,112 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:18:31,113 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,115 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:18:31,115 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:18:31,116 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:18:31,116 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:18:31,119 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:18:31,124 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:18:31,132 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:18:31,134 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:18:31,145 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:18:31,146 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:18:31,152 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:18:31,155 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:18:31,166 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:18:31,166 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:18:31,179 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:18:31,193 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:18:31,200 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:18:31,208 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:18:31,213 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:18:31,216 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:18:31,223 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:18:31,226 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:18:31,231 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:18:31,235 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:18:31,235 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:18:31,246 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:18:31,255 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:18:31,261 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:18:31,266 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:18:31,274 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:18:31,279 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:18:31,282 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:18:31,287 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:18:31,293 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:18:31,297 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:18:31,303 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:18:31,320 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:18:31,325 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:18:31,329 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:18:31,346 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:18:31,347 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:18:31,350 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:18:31,353 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:18:31,375 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:18:31,376 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:18:31,377 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:18:31,383 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:18:31,397 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:18:31,404 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:18:31,433 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:18:31,434 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:18:31,439 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:18:31,447 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:18:31,486 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:18:31,492 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:18:31,494 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:18:31,544 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:18:31,556 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:18:31,563 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:18:31,570 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:18:31,575 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:18:31,590 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:18:31,605 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:18:31,612 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:19:23,873 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:19:23,874 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:19:23,886 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:19:23,890 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:19:23,890 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:19:23,890 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,892 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:19:23,893 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,897 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:19:23,898 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,900 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:19:23,901 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,904 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:19:23,904 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,907 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:19:23,909 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:19:23,909 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:19:23,909 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:19:23,910 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:19:23,914 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:19:23,915 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:19:23,915 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:19:23,923 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:19:23,934 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:19:23,934 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:19:23,935 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,937 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:19:23,937 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,940 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:19:23,941 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,943 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:19:23,943 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,945 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:19:23,945 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,946 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:19:23,947 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,947 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:19:23,947 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:19:23,952 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:19:23,956 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:19:23,956 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:19:23,957 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,960 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:19:23,961 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,962 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:19:23,967 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:19:23,968 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:19:23,969 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:19:23,969 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:19:23,986 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:19:23,988 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:19:23,988 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:19:23,989 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,991 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:19:23,992 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,993 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:19:23,994 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,995 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:19:23,996 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,997 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:19:23,997 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:23,998 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:19:23,999 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:24,000 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:19:24,000 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:24,001 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:19:24,002 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:24,006 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:19:24,007 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:24,008 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:19:24,008 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:19:24,014 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:19:24,016 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:19:24,016 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:19:24,016 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:24,018 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:19:24,018 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:24,023 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:19:24,024 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:19:24,025 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:19:24,026 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:19:24,030 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:19:24,034 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:19:24,040 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:19:24,045 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:19:24,052 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:19:24,053 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:19:24,061 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:19:24,064 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:19:24,072 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:19:24,073 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:19:24,088 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:19:24,108 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:19:24,121 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:19:24,131 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:19:24,155 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:19:24,164 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:19:24,169 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:19:24,180 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:19:24,193 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:19:24,204 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:19:24,205 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:19:24,244 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:19:24,265 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:19:24,278 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:19:24,285 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:19:24,292 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:19:24,300 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:19:24,331 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:19:24,340 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:19:24,365 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:19:24,379 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:19:24,399 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:19:24,424 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:19:24,440 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:19:24,470 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:19:24,494 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:19:24,495 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:19:24,497 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:19:24,539 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:19:24,560 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:19:24,561 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:19:24,565 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:19:24,566 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:19:24,593 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:19:24,614 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:19:24,662 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:19:24,663 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:19:24,683 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:19:24,703 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:19:24,714 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:19:24,735 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:19:24,737 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:19:24,820 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:19:24,835 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:19:24,848 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:19:24,858 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:19:24,871 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:19:24,896 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:19:24,912 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:19:24,921 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:19:24,943 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for 2 funds.
2025-10-26 13:20:43,206 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:20:43,207 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:20:43,219 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:20:43,223 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:20:43,224 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:20:43,224 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,226 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:20:43,229 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,232 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:20:43,232 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,234 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:20:43,235 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,238 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:20:43,238 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,242 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:20:43,245 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:20:43,245 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:20:43,246 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:20:43,246 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:20:43,251 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:20:43,251 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:20:43,251 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:20:43,260 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:20:43,263 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:20:43,263 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:20:43,264 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,265 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:20:43,266 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,267 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:20:43,268 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,269 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:20:43,270 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,273 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:20:43,274 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,275 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:20:43,276 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,277 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:20:43,277 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:20:43,283 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:20:43,286 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:20:43,286 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:20:43,286 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,288 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:20:43,288 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,289 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:20:43,293 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:20:43,295 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:20:43,296 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:20:43,296 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:20:43,309 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:20:43,311 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:20:43,311 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:20:43,312 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,314 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:20:43,315 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,317 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:20:43,318 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,321 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:20:43,321 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,323 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:20:43,323 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,325 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:20:43,325 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,327 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:20:43,327 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,329 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:20:43,330 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,334 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:20:43,334 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,335 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:20:43,335 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:20:43,345 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:20:43,350 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:20:43,350 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:20:43,350 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,354 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:20:43,355 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,356 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:20:43,357 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:20:43,357 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:20:43,358 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:20:43,361 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:20:43,370 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:20:43,374 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:20:43,377 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:20:43,387 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:20:43,387 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:20:43,394 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:20:43,397 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:20:43,407 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:20:43,408 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:20:43,418 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:20:43,426 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:20:43,434 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:20:43,441 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:20:43,446 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:20:43,451 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:20:43,455 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:20:43,459 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:20:43,465 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:20:43,470 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:20:43,470 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:20:43,480 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:20:43,485 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:20:43,490 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:20:43,494 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:20:43,502 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:20:43,505 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:20:43,509 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:20:43,509 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:20:43,515 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:20:43,520 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:20:43,524 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:20:43,533 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:20:43,537 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:20:43,540 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:20:43,553 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:20:43,553 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:20:43,555 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:20:43,558 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:20:43,572 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:20:43,573 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:20:43,575 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:20:43,576 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:20:43,596 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:20:43,600 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:20:43,630 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:20:43,631 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:20:43,636 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:20:43,642 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:20:43,643 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:20:43,648 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:20:43,648 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:20:43,679 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:20:43,691 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:20:43,698 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:20:43,703 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:20:43,707 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:20:43,717 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:20:43,728 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:20:43,734 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:20:43,741 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for 2 funds.
2025-10-26 13:22:36,878 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:22:36,879 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:22:36,890 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:22:36,892 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:22:36,892 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:22:36,893 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,894 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:22:36,895 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,896 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:22:36,897 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,900 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:22:36,901 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,903 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:22:36,904 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,906 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:22:36,910 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:22:36,911 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:22:36,911 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:22:36,911 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:22:36,917 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:22:36,917 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:22:36,918 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:22:36,930 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:22:36,932 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:22:36,933 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:22:36,933 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,934 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:22:36,934 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,936 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:22:36,936 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,938 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:22:36,938 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,940 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:22:36,940 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,942 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:22:36,943 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,944 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:22:36,945 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:22:36,950 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:22:36,953 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:22:36,954 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:22:36,954 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,956 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:22:36,957 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,957 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:22:36,962 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:22:36,964 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:22:36,964 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:22:36,965 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:22:36,977 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:22:36,979 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:22:36,980 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:22:36,980 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,982 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:22:36,982 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,983 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:22:36,984 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,986 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:22:36,986 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,988 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:22:36,989 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,990 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:22:36,994 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,996 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:22:36,997 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:36,998 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:22:36,999 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:37,001 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:22:37,001 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:37,003 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:22:37,004 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:22:37,010 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:22:37,014 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:22:37,015 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:22:37,015 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:37,017 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:22:37,018 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:37,020 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:22:37,020 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:22:37,021 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:22:37,021 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:22:37,025 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:22:37,031 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:22:37,037 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:22:37,040 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:22:37,047 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:22:37,048 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:22:37,057 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:22:37,060 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:22:37,097 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:22:37,098 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:22:37,111 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:22:37,159 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:22:37,167 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:22:37,173 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:22:37,180 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:22:37,186 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:22:37,191 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:22:37,196 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:22:37,199 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:22:37,203 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:22:37,203 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:22:37,213 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:22:37,220 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:22:37,229 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:22:37,235 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:22:37,243 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:22:37,247 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:22:37,251 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:22:37,252 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:22:37,260 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:22:37,265 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:22:37,275 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:22:37,283 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:22:37,288 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:22:37,293 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:22:37,309 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:22:37,310 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:22:37,312 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:22:37,315 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:22:37,331 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:22:37,331 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:22:37,336 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:22:37,336 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:22:37,349 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:22:37,354 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:22:37,395 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:22:37,396 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:22:37,402 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:22:37,410 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:22:37,411 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:22:37,414 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:22:37,415 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:22:37,451 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:22:37,463 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:22:37,470 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:22:37,475 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:22:37,482 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:22:37,498 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:22:37,506 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:22:37,514 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:23:29,865 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:23:29,865 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:23:29,878 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:23:29,881 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:23:29,881 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:23:29,882 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,884 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:23:29,885 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,889 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:23:29,890 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,891 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:23:29,893 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,895 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:23:29,896 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,898 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:23:29,900 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:23:29,901 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:23:29,901 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:23:29,903 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:23:29,908 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:23:29,908 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:23:29,909 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:23:29,925 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:23:29,928 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:23:29,928 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:23:29,928 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,930 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:23:29,930 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,931 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:23:29,932 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,933 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:23:29,934 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,935 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:23:29,936 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,938 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:23:29,938 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,941 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:23:29,942 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:23:29,947 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:23:29,952 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:23:29,952 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:23:29,953 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,955 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:23:29,956 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,956 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:23:29,961 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:23:29,963 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:23:29,964 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:23:29,964 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:23:29,977 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:23:29,980 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:23:29,980 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:23:29,980 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,983 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:23:29,984 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,986 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:23:29,986 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,988 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:23:29,988 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,992 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:23:29,994 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,996 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:23:29,998 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:29,999 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:23:30,000 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:30,003 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:23:30,003 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:30,005 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:23:30,005 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:30,006 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:23:30,007 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:23:30,012 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:23:30,014 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:23:30,014 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:23:30,015 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:30,016 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:23:30,016 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:30,017 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:23:30,018 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:23:30,018 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:23:30,019 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:23:30,024 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:23:30,030 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:23:30,035 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:23:30,037 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:23:30,042 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:23:30,043 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:23:30,048 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:23:30,051 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:23:30,056 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:23:30,057 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:23:30,067 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:23:30,078 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:23:30,084 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:23:30,092 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:23:30,098 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:23:30,103 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:23:30,107 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:23:30,111 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:23:30,114 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:23:30,118 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:23:30,118 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:23:30,129 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:23:30,134 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:23:30,142 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:23:30,147 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:23:30,153 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:23:30,158 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:23:30,163 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:23:30,163 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:23:30,173 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:23:30,177 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:23:30,181 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:23:30,196 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:23:30,200 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:23:30,205 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:23:30,223 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:23:30,224 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:23:30,226 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:23:30,231 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:23:30,257 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:23:30,257 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:23:30,259 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:23:30,259 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:23:30,276 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:23:30,282 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:23:30,315 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:23:30,315 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:23:30,320 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:23:30,329 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:23:30,330 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:23:30,334 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:23:30,334 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:23:30,366 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:23:30,377 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:23:30,383 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:23:30,387 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:23:30,394 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:23:30,404 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:23:30,413 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:23:30,416 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:23:30,428 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:34:09,267 [WARNING] matplotlib.font_manager: Matplotlib is building the font cache; this may take a moment.
2025-10-26 13:34:10,136 [INFO] matplotlib.font_manager: generated new fontManager
2025-10-26 13:34:12,018 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:34:12,019 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:34:12,033 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:34:12,037 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:34:12,037 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:34:12,037 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,040 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:34:12,043 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,046 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:34:12,046 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,053 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:34:12,053 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,055 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:34:12,056 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,059 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:34:12,062 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:34:12,062 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:34:12,062 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:34:12,064 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:34:12,069 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:34:12,070 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:34:12,070 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:34:12,085 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:34:12,088 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:34:12,089 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:34:12,089 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,091 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:34:12,091 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,093 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:34:12,093 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,097 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:34:12,100 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,103 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:34:12,104 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,106 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:34:12,106 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,107 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:34:12,108 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:34:12,117 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:34:12,121 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:34:12,122 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:34:12,122 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,123 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:34:12,124 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,124 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:34:12,134 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:34:12,137 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:34:12,138 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:34:12,138 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:34:12,155 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:34:12,161 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:34:12,162 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:34:12,163 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,165 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:34:12,165 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,168 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:34:12,169 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,171 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:34:12,171 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,173 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:34:12,173 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,177 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:34:12,177 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,178 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:34:12,180 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,181 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:34:12,182 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,184 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:34:12,184 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,184 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:34:12,184 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:34:12,194 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:34:12,198 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:34:12,199 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:34:12,199 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,201 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:34:12,202 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,203 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:34:12,204 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:34:12,204 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:34:12,205 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:34:12,209 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:34:12,211 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:34:12,217 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:34:12,219 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:34:12,226 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:34:12,227 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:34:12,233 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:34:12,236 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:34:12,245 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:34:12,245 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:34:12,256 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:34:12,265 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:34:12,276 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:34:12,282 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:34:12,288 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:34:12,291 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:34:12,295 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:34:12,298 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:34:12,304 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:34:12,308 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:34:12,308 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:34:12,318 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:34:12,324 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:34:12,329 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:34:12,339 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:34:12,344 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:34:12,351 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:34:12,355 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:34:12,355 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:34:12,359 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:34:12,363 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:34:12,370 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:34:12,377 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:34:12,384 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:34:12,388 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:34:12,403 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:34:12,403 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:34:12,410 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:34:12,419 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:34:12,433 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:34:12,434 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:34:12,436 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:34:12,437 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:34:12,453 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:34:12,457 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:34:12,483 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:34:12,485 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:34:12,489 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:34:12,495 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:34:12,497 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:34:12,502 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:34:12,502 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:34:12,531 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:34:12,544 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:34:12,552 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:34:12,557 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:34:12,560 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:34:12,575 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:34:12,583 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:34:12,587 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:34:12,593 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:35:59,450 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:35:59,450 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:35:59,463 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:35:59,467 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:35:59,468 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:35:59,468 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,473 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:35:59,474 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,476 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:35:59,476 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,478 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:35:59,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,483 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:35:59,483 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,487 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:35:59,489 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:35:59,490 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:35:59,490 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:35:59,491 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:35:59,497 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:35:59,498 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:35:59,498 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:35:59,509 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:35:59,512 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:35:59,512 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:35:59,513 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,515 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:35:59,516 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,517 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:35:59,518 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,520 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:35:59,521 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,522 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:35:59,523 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,524 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:35:59,525 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,525 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:35:59,525 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:35:59,531 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:35:59,533 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:35:59,534 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:35:59,534 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,536 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:35:59,537 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,538 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:35:59,544 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:35:59,546 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:35:59,546 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:35:59,547 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:35:59,556 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:35:59,559 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:35:59,559 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:35:59,560 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,561 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:35:59,562 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,563 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:35:59,564 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,567 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:35:59,568 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,570 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:35:59,570 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,572 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:35:59,573 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,577 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:35:59,578 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,580 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:35:59,580 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,582 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:35:59,582 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,583 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:35:59,583 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:35:59,589 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:35:59,591 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:35:59,591 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:35:59,591 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,593 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:35:59,593 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,594 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:35:59,594 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:35:59,595 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:35:59,595 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:35:59,601 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:35:59,605 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:35:59,610 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:35:59,612 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:35:59,620 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:35:59,620 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:35:59,629 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:35:59,633 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:35:59,639 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:35:59,639 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:35:59,646 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:35:59,663 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:35:59,670 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:35:59,675 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:35:59,679 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:35:59,687 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:35:59,691 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:35:59,695 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:35:59,699 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:35:59,704 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:35:59,704 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:35:59,711 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:35:59,721 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:35:59,726 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:35:59,733 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:35:59,738 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:35:59,742 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:35:59,745 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:35:59,745 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:35:59,752 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:35:59,757 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:35:59,761 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:35:59,770 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:35:59,774 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:35:59,777 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:35:59,792 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:35:59,792 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:35:59,794 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:35:59,800 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:35:59,811 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:35:59,812 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:35:59,814 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:35:59,815 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:35:59,827 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:35:59,834 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:35:59,859 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:35:59,861 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:35:59,866 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:35:59,873 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:35:59,873 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:35:59,877 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:35:59,878 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:35:59,908 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:35:59,918 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:35:59,925 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:35:59,931 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:35:59,936 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:35:59,945 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:35:59,952 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:35:59,956 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:35:59,965 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:40:52,331 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:40:52,332 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:40:52,349 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:40:52,354 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:40:52,355 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:40:52,355 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,358 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:40:52,359 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,361 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:40:52,361 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,382 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:40:52,383 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,387 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:40:52,387 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,390 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:40:52,392 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:40:52,392 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:40:52,393 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:40:52,393 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:40:52,403 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:40:52,404 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:40:52,405 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:40:52,427 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:40:52,440 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:40:52,441 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:40:52,441 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,443 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:40:52,444 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,446 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:40:52,446 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,449 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:40:52,449 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,451 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:40:52,452 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,454 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:40:52,454 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,455 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:40:52,455 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:40:52,474 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:40:52,477 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:40:52,477 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:40:52,478 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,480 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:40:52,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,482 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:40:52,487 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:40:52,494 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:40:52,496 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:40:52,497 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:40:52,517 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:40:52,521 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:40:52,521 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:40:52,521 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,530 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:40:52,531 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,534 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:40:52,535 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,538 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:40:52,540 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,556 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:40:52,557 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,560 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:40:52,561 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,562 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:40:52,563 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,565 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:40:52,565 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,568 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:40:52,569 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,570 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:40:52,570 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:40:52,582 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:40:52,586 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:40:52,587 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:40:52,588 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,600 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:40:52,601 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,603 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:40:52,604 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:40:52,605 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:40:52,605 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:40:52,617 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:40:52,624 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:40:52,629 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:40:52,631 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:40:52,636 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:40:52,637 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:40:52,652 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:40:52,658 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:40:52,668 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:40:52,668 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:40:52,689 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:40:52,699 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:40:52,712 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:40:52,723 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:40:52,728 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:40:52,732 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:40:52,742 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:40:52,759 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:40:52,764 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:40:52,770 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:40:52,771 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:40:52,821 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:40:52,838 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:40:52,875 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:40:52,883 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:40:52,915 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:40:52,953 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:40:52,959 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:40:52,960 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:40:52,989 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:40:53,014 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:40:53,024 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:40:53,040 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:40:53,051 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:40:53,057 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:40:53,088 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:40:53,089 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:40:53,091 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:40:53,099 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:40:53,164 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:40:53,164 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:40:53,166 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:40:53,166 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:40:53,190 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:40:53,195 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:40:53,236 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:40:53,237 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:40:53,261 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:40:53,267 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:40:53,269 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:40:53,288 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:40:53,293 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:40:53,369 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:40:53,383 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:40:53,396 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:40:53,405 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:40:53,420 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:40:53,443 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:40:53,455 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:40:53,460 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:40:53,481 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:41:29,648 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:41:29,649 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:41:29,663 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:41:29,665 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:41:29,666 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:41:29,666 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,668 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:41:29,668 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,671 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:41:29,672 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,675 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:41:29,675 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,678 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:41:29,679 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,682 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:41:29,684 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:41:29,685 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:41:29,687 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:41:29,687 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:41:29,694 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:41:29,695 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:41:29,695 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:41:29,705 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:41:29,707 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:41:29,710 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:41:29,711 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,712 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:41:29,713 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,715 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:41:29,716 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,718 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:41:29,718 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,720 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:41:29,721 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,723 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:41:29,724 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,724 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:41:29,725 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:41:29,729 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:41:29,731 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:41:29,732 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:41:29,732 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,733 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:41:29,734 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,734 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:41:29,741 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:41:29,743 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:41:29,743 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:41:29,744 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:41:29,761 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:41:29,763 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:41:29,764 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:41:29,765 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,767 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:41:29,767 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,769 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:41:29,770 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,778 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:41:29,779 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,780 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:41:29,781 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,783 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:41:29,784 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,787 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:41:29,787 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,789 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:41:29,789 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,791 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:41:29,791 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,792 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:41:29,792 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:41:29,796 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:41:29,799 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:41:29,800 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:41:29,800 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,802 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:41:29,805 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,807 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:41:29,807 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:41:29,808 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:41:29,809 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:41:29,812 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:41:29,816 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:41:29,824 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:41:29,828 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:41:29,834 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:41:29,835 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:41:29,844 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:41:29,847 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:41:29,855 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:41:29,856 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:41:29,868 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:41:29,878 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:41:29,888 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:41:29,894 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:41:29,903 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:41:29,908 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:41:29,914 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:41:29,918 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:41:29,924 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:41:29,929 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:41:29,930 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:41:29,939 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:41:29,951 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:41:29,958 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:41:29,964 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:41:29,968 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:41:29,974 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:41:29,980 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:41:29,980 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:41:29,987 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:41:29,992 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:41:29,996 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:41:30,002 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:41:30,009 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:41:30,012 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:41:30,027 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:41:30,028 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:41:30,030 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:41:30,033 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:41:30,047 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:41:30,047 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:41:30,050 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:41:30,051 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:41:30,064 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:41:30,072 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:41:30,096 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:41:30,097 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:41:30,101 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:41:30,108 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:41:30,109 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:41:30,112 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:41:30,113 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:41:30,145 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:41:30,157 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:41:30,162 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:41:30,167 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:41:30,174 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:41:30,186 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:41:30,192 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:41:30,196 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:41:30,206 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:42:49,228 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:42:49,228 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:42:49,295 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:42:49,298 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:42:49,298 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:42:49,299 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,301 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:42:49,302 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,304 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:42:49,304 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,306 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:42:49,306 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,309 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:42:49,309 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,312 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:42:49,314 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:42:49,315 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:42:49,315 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:42:49,315 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:42:49,325 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:42:49,326 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:42:49,326 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:42:49,337 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:42:49,340 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:42:49,340 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:42:49,341 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,342 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:42:49,343 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,345 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:42:49,346 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,348 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:42:49,351 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,353 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:42:49,354 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,356 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:42:49,356 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,357 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:42:49,358 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:42:49,370 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:42:49,372 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:42:49,373 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:42:49,373 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,375 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:42:49,375 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,376 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:42:49,384 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:42:49,386 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:42:49,386 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:42:49,387 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:42:49,402 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:42:49,405 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:42:49,405 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:42:49,405 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,408 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:42:49,408 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,410 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:42:49,411 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,414 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:42:49,414 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,416 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:42:49,416 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,418 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:42:49,418 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,420 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:42:49,420 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,422 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:42:49,422 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,423 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:42:49,424 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,424 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:42:49,425 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:42:49,433 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:42:49,436 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:42:49,436 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:42:49,437 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,438 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:42:49,439 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,440 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:42:49,441 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:42:49,441 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:42:49,441 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:42:49,449 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:42:49,453 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:42:49,459 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:42:49,463 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:42:49,469 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:42:49,469 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:42:49,481 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:42:49,485 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:42:49,494 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:42:49,494 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:42:49,507 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:42:49,525 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:42:49,532 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:42:49,545 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:42:49,550 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:42:49,555 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:42:49,561 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:42:49,566 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:42:49,570 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:42:49,574 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:42:49,574 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:42:49,583 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:42:49,592 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:42:49,598 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:42:49,605 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:42:49,612 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:42:49,618 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:42:49,622 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:42:49,623 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:42:49,630 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:42:49,636 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:42:49,641 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:42:49,649 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:42:49,657 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:42:49,661 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:42:49,681 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:42:49,681 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:42:49,683 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:42:49,686 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:42:49,704 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:42:49,704 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:42:49,708 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:42:49,713 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:42:49,731 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:42:49,736 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:42:49,757 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:42:49,758 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:42:49,766 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:42:49,776 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:42:49,778 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:42:49,781 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:42:49,782 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:42:49,814 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:42:49,825 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:42:49,833 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:42:49,841 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:42:49,846 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:42:49,856 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:42:49,864 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:42:49,868 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:42:49,877 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:45:20,177 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:45:20,178 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:45:20,190 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:45:20,193 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:45:20,193 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:45:20,194 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,197 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:45:20,198 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,199 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:45:20,200 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,201 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:45:20,202 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,203 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:45:20,205 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,209 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:45:20,211 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:45:20,212 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:45:20,214 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:45:20,215 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:45:20,223 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:45:20,223 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:45:20,224 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:45:20,235 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:45:20,237 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:45:20,237 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:45:20,237 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,239 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:45:20,239 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,241 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:45:20,241 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,243 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:45:20,244 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,245 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:45:20,245 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,247 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:45:20,247 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,248 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:45:20,249 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:45:20,255 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:45:20,258 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:45:20,258 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:45:20,258 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,260 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:45:20,260 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,260 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:45:20,265 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:45:20,269 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:45:20,270 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:45:20,270 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:45:20,282 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:45:20,285 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:45:20,290 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:45:20,290 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,292 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:45:20,292 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,294 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:45:20,295 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,296 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:45:20,298 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,299 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:45:20,300 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,302 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:45:20,303 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,305 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:45:20,305 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,306 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:45:20,307 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,308 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:45:20,309 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,309 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:45:20,309 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:45:20,314 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:45:20,317 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:45:20,318 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:45:20,318 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,322 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:45:20,322 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,324 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:45:20,324 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:45:20,325 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:45:20,326 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:45:20,329 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:45:20,334 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:45:20,345 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:45:20,347 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:45:20,354 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:45:20,354 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:45:20,360 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:45:20,361 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:45:20,367 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:45:20,367 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:45:20,377 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:45:20,391 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:45:20,397 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:45:20,403 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:45:20,408 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:45:20,412 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:45:20,418 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:45:20,422 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:45:20,426 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:45:20,429 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:45:20,429 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:45:20,438 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:45:20,443 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:45:20,451 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:45:20,456 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:45:20,461 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:45:20,465 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:45:20,470 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:45:20,471 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:45:20,481 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:45:20,487 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:45:20,492 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:45:20,498 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:45:20,502 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:45:20,506 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:45:20,521 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:45:20,522 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:45:20,523 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:45:20,527 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:45:20,543 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:45:20,543 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:45:20,546 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:45:20,547 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:45:20,560 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:45:20,565 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:45:20,595 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:45:20,596 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:45:20,604 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:45:20,610 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:45:20,611 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:45:20,615 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:45:20,615 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:45:20,647 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:45:20,657 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:45:20,663 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:45:20,670 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:45:20,674 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:45:20,688 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:45:20,694 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:45:20,698 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:45:20,707 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:45:20,710 [INFO] pc_project: plot_irr_by_level: generating IRR comparison chart...
2025-10-26 13:45:21,241 [INFO] pc_project: plot_irr_by_level: chart saved successfully to C:\Users\zhouy\OneDrive\Documents\pc_project\outputs (levels=3).
2025-10-26 13:46:43,755 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:46:43,756 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:46:43,776 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:46:43,781 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:46:43,781 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:46:43,781 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,784 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:46:43,785 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,786 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:46:43,787 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,789 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:46:43,790 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,791 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:46:43,791 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,793 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:46:43,795 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:46:43,796 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:46:43,796 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:46:43,796 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:46:43,801 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:46:43,801 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:46:43,802 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:46:43,814 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:46:43,817 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:46:43,817 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:46:43,818 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,819 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:46:43,820 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,822 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:46:43,822 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,824 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:46:43,824 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,826 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:46:43,827 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,829 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:46:43,829 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,830 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:46:43,830 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:46:43,836 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:46:43,839 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:46:43,839 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:46:43,840 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,841 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:46:43,843 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,843 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:46:43,850 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:46:43,852 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:46:43,853 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:46:43,853 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:46:43,869 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:46:43,872 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:46:43,872 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:46:43,873 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,877 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:46:43,878 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,880 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:46:43,880 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,882 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:46:43,882 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,884 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:46:43,884 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,887 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:46:43,887 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,889 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:46:43,894 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,896 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:46:43,896 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,898 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:46:43,898 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,899 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:46:43,900 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:46:43,909 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:46:43,912 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:46:43,912 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:46:43,913 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,914 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:46:43,915 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,917 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:46:43,917 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:46:43,918 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:46:43,918 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:46:43,924 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:46:43,930 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:46:43,936 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:46:43,939 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:46:43,947 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:46:43,947 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:46:43,955 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:46:43,960 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:46:43,966 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:46:43,968 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:46:43,979 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:46:43,991 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:46:44,000 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:46:44,007 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:46:44,011 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:46:44,020 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:46:44,025 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:46:44,028 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:46:44,035 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:46:44,044 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:46:44,044 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:46:44,057 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:46:44,066 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:46:44,072 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:46:44,078 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:46:44,083 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:46:44,092 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:46:44,097 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:46:44,097 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:46:44,104 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:46:44,111 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:46:44,115 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:46:44,124 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:46:44,130 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:46:44,135 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:46:44,149 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:46:44,150 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:46:44,156 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:46:44,160 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:46:44,174 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:46:44,175 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:46:44,177 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:46:44,177 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:46:44,187 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:46:44,198 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:46:44,226 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:46:44,227 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:46:44,232 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:46:44,242 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:46:44,243 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:46:44,247 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:46:44,247 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:46:44,281 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:46:44,294 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:46:44,303 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:46:44,309 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:46:44,315 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:46:44,327 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:46:44,338 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:46:44,343 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:46:44,351 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:46:44,356 [INFO] pc_project: plot_irr_by_level: generating IRR comparison chart...
2025-10-26 13:46:44,950 [INFO] pc_project: plot_irr_by_level: chart saved successfully to C:\Users\zhouy\OneDrive\Documents\pc_project\outputs (levels=3).
2025-10-26 13:50:55,374 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:50:55,375 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:50:55,436 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:50:55,440 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:50:55,440 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:50:55,440 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,445 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:50:55,446 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,448 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:50:55,448 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,450 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:50:55,451 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,453 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:50:55,454 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,456 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:50:55,460 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:50:55,460 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:50:55,461 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:50:55,461 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:50:55,466 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:50:55,467 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:50:55,467 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:50:55,479 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:50:55,482 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:50:55,482 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:50:55,483 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,484 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:50:55,485 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,487 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:50:55,487 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,490 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:50:55,490 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,492 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:50:55,493 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,495 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:50:55,495 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,496 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:50:55,496 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:50:55,501 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:50:55,503 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:50:55,503 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:50:55,504 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,505 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:50:55,506 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,506 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:50:55,513 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:50:55,515 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:50:55,516 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:50:55,516 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:50:55,529 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:50:55,531 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:50:55,532 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:50:55,532 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,534 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:50:55,536 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,539 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:50:55,540 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,542 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:50:55,542 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,544 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:50:55,544 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,546 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:50:55,547 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,549 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:50:55,549 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,551 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:50:55,557 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,559 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:50:55,559 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,560 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:50:55,561 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:50:55,567 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:50:55,573 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:50:55,573 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:50:55,574 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,575 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:50:55,576 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,578 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:50:55,578 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:50:55,579 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:50:55,579 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:50:55,583 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:50:55,585 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:50:55,596 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:50:55,598 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:50:55,603 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:50:55,604 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:50:55,609 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:50:55,611 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:50:55,616 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:50:55,616 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:50:55,631 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:50:55,642 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:50:55,648 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:50:55,658 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:50:55,663 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:50:55,669 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:50:55,673 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:50:55,676 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:50:55,679 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:50:55,682 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:50:55,683 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:50:55,691 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:50:55,697 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:50:55,705 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:50:55,709 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:50:55,713 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:50:55,718 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:50:55,723 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:50:55,723 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:50:55,728 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:50:55,735 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:50:55,739 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:50:55,745 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:50:55,749 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:50:55,755 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:50:55,770 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:50:55,771 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:50:55,773 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:50:55,776 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:50:55,789 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:50:55,789 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:50:55,791 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:50:55,792 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:50:55,806 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:50:55,810 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:50:55,836 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:50:55,837 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:50:55,843 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:50:55,848 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:50:55,850 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:50:55,855 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:50:55,855 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:50:55,883 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:50:55,894 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:50:55,902 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:50:55,908 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:50:55,913 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:50:55,922 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:50:55,927 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:50:55,933 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:50:55,941 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:50:55,946 [INFO] pc_project: plot_irr_by_level: target file = C:\Users\zhouy\OneDrive\Documents\pc_project\outputs
2025-10-26 13:50:56,229 [INFO] pc_project: plot_irr_by_level: chart saved successfully to C:\Users\zhouy\OneDrive\Documents\pc_project\outputs
2025-10-26 13:51:43,605 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:51:43,605 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:51:43,671 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:51:43,675 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:51:43,675 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:51:43,676 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,678 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:51:43,679 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,680 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:51:43,681 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,683 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:51:43,684 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,685 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:51:43,685 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,688 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:51:43,690 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:51:43,691 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:51:43,691 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:51:43,691 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:51:43,696 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:51:43,697 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:51:43,697 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:51:43,710 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:51:43,713 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:51:43,713 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:51:43,714 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,715 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:51:43,715 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,717 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:51:43,718 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,719 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:51:43,720 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,723 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:51:43,724 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,726 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:51:43,726 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,727 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:51:43,727 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:51:43,733 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:51:43,735 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:51:43,736 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:51:43,736 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,737 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:51:43,738 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,741 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:51:43,747 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:51:43,749 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:51:43,749 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:51:43,750 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:51:43,765 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:51:43,767 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:51:43,768 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:51:43,768 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,769 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:51:43,771 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,773 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:51:43,774 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,775 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:51:43,776 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,777 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:51:43,777 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,779 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:51:43,779 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,781 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:51:43,781 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,782 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:51:43,783 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,784 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:51:43,784 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,784 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:51:43,785 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:51:43,794 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:51:43,796 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:51:43,797 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:51:43,797 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,799 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:51:43,800 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,801 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:51:43,801 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:51:43,802 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:51:43,802 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:51:43,808 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:51:43,813 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:51:43,818 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:51:43,821 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:51:43,828 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:51:43,829 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:51:43,838 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:51:43,841 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:51:43,847 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:51:43,847 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:51:43,857 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:51:43,866 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:51:43,874 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:51:43,879 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:51:43,883 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:51:43,886 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:51:43,892 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:51:43,896 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:51:43,902 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:51:43,906 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:51:43,907 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:51:43,923 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:51:43,931 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:51:43,939 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:51:43,944 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:51:43,951 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:51:43,955 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:51:43,958 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:51:43,959 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:51:43,966 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:51:43,971 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:51:43,980 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:51:43,988 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:51:43,992 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:51:43,996 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:51:44,015 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:51:44,016 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:51:44,018 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:51:44,027 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:51:44,042 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:51:44,043 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:51:44,046 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:51:44,047 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:51:44,062 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:51:44,066 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:51:44,103 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:51:44,105 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:51:44,110 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:51:44,120 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:51:44,121 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:51:44,125 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:51:44,125 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:51:44,159 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:51:44,168 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:51:44,174 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:51:44,181 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:51:44,186 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:51:44,198 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:51:44,205 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:51:44,209 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:51:44,225 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:52:48,750 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:52:48,750 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:52:48,807 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:52:48,810 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:52:48,811 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:52:48,811 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,813 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:52:48,815 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,818 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:52:48,818 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,820 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:52:48,821 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,824 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:52:48,824 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,828 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:52:48,830 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:52:48,831 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:52:48,831 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:52:48,831 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:52:48,837 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:52:48,838 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:52:48,838 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:52:48,848 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:52:48,851 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:52:48,852 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:52:48,852 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,854 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:52:48,855 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,858 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:52:48,858 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,861 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:52:48,861 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,864 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:52:48,864 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,866 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:52:48,866 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,867 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:52:48,867 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:52:48,872 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:52:48,874 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:52:48,874 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:52:48,875 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,877 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:52:48,879 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,879 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:52:48,888 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:52:48,889 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:52:48,890 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:52:48,890 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:52:48,908 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:52:48,911 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:52:48,914 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:52:48,915 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,917 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:52:48,918 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,919 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:52:48,920 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,922 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:52:48,923 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,924 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:52:48,925 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,930 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:52:48,932 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,933 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:52:48,934 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,936 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:52:48,936 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,939 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:52:48,939 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,940 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:52:48,940 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:52:48,948 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:52:48,951 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:52:48,952 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:52:48,952 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,954 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:52:48,955 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,956 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:52:48,956 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:52:48,957 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:52:48,957 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:52:48,962 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:52:48,966 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:52:48,971 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:52:48,973 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:52:48,979 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:52:48,979 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:52:48,985 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:52:48,987 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:52:48,995 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:52:48,996 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:52:49,005 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:52:49,017 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:52:49,024 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:52:49,031 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:52:49,037 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:52:49,043 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:52:49,047 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:52:49,051 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:52:49,055 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:52:49,059 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:52:49,059 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:52:49,066 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:52:49,074 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:52:49,081 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:52:49,087 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:52:49,092 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:52:49,096 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:52:49,099 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:52:49,099 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:52:49,107 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:52:49,111 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:52:49,119 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:52:49,125 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:52:49,129 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:52:49,135 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:52:49,148 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:52:49,149 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:52:49,151 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:52:49,154 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:52:49,171 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:52:49,171 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:52:49,173 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:52:49,174 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:52:49,187 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:52:49,192 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:52:49,222 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:52:49,223 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:52:49,231 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:52:49,237 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:52:49,238 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:52:49,245 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:52:49,246 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:52:49,277 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:52:49,286 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:52:49,295 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:52:49,300 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:52:49,304 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:52:49,317 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:52:49,323 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:52:49,326 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:52:49,335 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:54:31,579 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:54:31,579 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:54:31,599 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:54:31,615 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:54:31,616 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:54:31,616 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,619 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:54:31,619 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,621 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:54:31,621 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,623 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:54:31,624 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,625 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:54:31,626 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,629 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:54:31,631 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:54:31,632 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:54:31,633 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:54:31,633 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:54:31,641 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:54:31,646 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:54:31,648 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:54:31,682 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:54:31,685 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:54:31,686 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:54:31,686 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,688 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:54:31,688 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,691 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:54:31,691 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,692 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:54:31,693 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,694 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:54:31,705 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,714 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:54:31,715 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,716 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:54:31,716 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:54:31,722 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:54:31,724 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:54:31,724 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:54:31,725 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,726 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:54:31,727 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,728 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:54:31,744 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:54:31,746 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:54:31,753 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:54:31,756 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:54:31,772 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:54:31,775 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:54:31,776 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:54:31,776 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,779 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:54:31,779 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,793 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:54:31,794 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,796 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:54:31,797 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,799 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:54:31,799 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,801 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:54:31,802 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,803 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:54:31,804 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,805 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:54:31,806 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,807 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:54:31,808 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,808 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:54:31,808 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:54:31,827 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:54:31,830 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:54:31,831 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:54:31,831 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,833 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:54:31,833 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,835 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:54:31,835 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:54:31,836 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:54:31,836 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:54:31,840 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:54:31,845 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:54:31,851 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:54:31,859 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:54:31,867 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:54:31,871 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:54:31,882 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:54:31,885 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:54:31,890 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:54:31,890 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:54:31,900 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:54:31,923 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:54:31,931 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:54:31,949 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:54:31,954 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:54:31,958 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:54:31,961 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:54:31,966 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:54:31,970 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:54:31,974 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:54:31,974 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:54:31,984 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:54:31,989 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:54:31,993 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:54:31,999 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:54:32,006 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:54:32,011 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:54:32,015 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:54:32,015 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:54:32,021 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:54:32,024 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:54:32,030 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:54:32,038 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:54:32,043 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:54:32,048 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:54:32,059 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:54:32,059 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:54:32,062 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:54:32,068 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:54:32,089 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:54:32,090 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:54:32,092 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:54:32,093 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:54:32,114 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:54:32,120 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:54:32,171 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:54:32,172 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:54:32,178 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:54:32,189 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:54:32,190 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:54:32,195 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:54:32,195 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:54:32,254 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:54:32,268 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:54:32,299 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:54:32,312 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:54:32,318 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:54:32,335 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:54:32,356 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:54:32,361 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:54:32,383 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 13:58:42,724 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:58:42,725 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 13:58:42,734 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:58:42,737 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:58:42,738 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 13:58:42,738 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,740 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 13:58:42,740 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,742 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 13:58:42,743 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,744 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 13:58:42,745 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,747 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 13:58:42,747 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,751 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 13:58:42,755 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 13:58:42,755 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 13:58:42,755 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 13:58:42,756 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 13:58:42,762 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 13:58:42,762 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:58:42,764 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 13:58:42,775 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:58:42,777 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:58:42,778 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 13:58:42,778 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,780 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:58:42,780 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,781 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 13:58:42,781 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,784 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 13:58:42,785 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,787 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 13:58:42,787 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,789 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 13:58:42,790 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,790 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:58:42,791 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 13:58:42,796 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:58:42,799 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:58:42,800 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 13:58:42,800 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,802 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 13:58:42,803 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,803 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 13:58:42,810 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 13:58:42,812 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 13:58:42,812 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:58:42,813 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 13:58:42,825 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:58:42,828 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:58:42,828 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 13:58:42,828 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,830 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 13:58:42,831 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,832 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 13:58:42,833 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,834 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 13:58:42,836 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,839 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 13:58:42,839 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,841 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 13:58:42,842 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,844 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 13:58:42,845 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,848 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 13:58:42,848 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,850 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 13:58:42,851 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,851 [INFO] pc_project: Starting data cleaning.
2025-10-26 13:58:42,852 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 13:58:42,857 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 13:58:42,859 [INFO] pc_project: Data cleaning complete.
2025-10-26 13:58:42,861 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 13:58:42,861 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,864 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 13:58:42,864 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,866 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 13:58:42,866 [INFO] pc_project: --------------------------------------------------
2025-10-26 13:58:42,867 [INFO] pc_project: Starting merge pipeline...
2025-10-26 13:58:42,868 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 13:58:42,871 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 13:58:42,875 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 13:58:42,880 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 13:58:42,881 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 13:58:42,888 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 13:58:42,888 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 13:58:42,897 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 13:58:42,900 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 13:58:42,906 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 13:58:42,907 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 13:58:42,916 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 13:58:42,925 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:58:42,933 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 13:58:42,939 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 13:58:42,945 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 13:58:42,949 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 13:58:42,953 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 13:58:42,957 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 13:58:42,963 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:58:42,967 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 13:58:42,967 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 13:58:42,973 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:58:42,979 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 13:58:42,987 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 13:58:42,995 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 13:58:43,000 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 13:58:43,004 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:58:43,008 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 13:58:43,008 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:58:43,016 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:58:43,019 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:58:43,026 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:58:43,032 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 13:58:43,036 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 13:58:43,039 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:58:43,054 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 13:58:43,055 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 13:58:43,057 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 13:58:43,061 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 13:58:43,074 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 13:58:43,074 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 13:58:43,077 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 13:58:43,078 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 13:58:43,091 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 13:58:43,097 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 13:58:43,121 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 13:58:43,122 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 13:58:43,127 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 13:58:43,135 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 13:58:43,136 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 13:58:43,139 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 13:58:43,140 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 13:58:43,173 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 13:58:43,185 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 13:58:43,195 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 13:58:43,202 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 13:58:43,207 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 13:58:43,220 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 13:58:43,227 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 13:58:43,232 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 13:58:43,239 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 14:00:28,101 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:00:28,101 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 14:00:28,172 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:00:28,177 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:00:28,177 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 14:00:28,178 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,181 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 14:00:28,182 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,184 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 14:00:28,184 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,186 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 14:00:28,187 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,188 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 14:00:28,189 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,192 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 14:00:28,194 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 14:00:28,194 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 14:00:28,195 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 14:00:28,195 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 14:00:28,203 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 14:00:28,204 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:00:28,205 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 14:00:28,223 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:00:28,226 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:00:28,226 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 14:00:28,227 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,231 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:00:28,232 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,235 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 14:00:28,236 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,238 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 14:00:28,238 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,239 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 14:00:28,240 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,242 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 14:00:28,243 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,243 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:00:28,244 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 14:00:28,252 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:00:28,255 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:00:28,255 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 14:00:28,255 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,258 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 14:00:28,258 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,259 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 14:00:28,268 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 14:00:28,269 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 14:00:28,270 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:00:28,270 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 14:00:28,284 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:00:28,286 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:00:28,287 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 14:00:28,287 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,289 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:00:28,290 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,292 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 14:00:28,293 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,295 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 14:00:28,295 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,297 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 14:00:28,298 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,303 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 14:00:28,303 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,305 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 14:00:28,305 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,308 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 14:00:28,309 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,311 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 14:00:28,311 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,312 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:00:28,313 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 14:00:28,318 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:00:28,320 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:00:28,320 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 14:00:28,320 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,322 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 14:00:28,322 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,323 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 14:00:28,324 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:00:28,324 [INFO] pc_project: Starting merge pipeline...
2025-10-26 14:00:28,325 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 14:00:28,331 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 14:00:28,335 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 14:00:28,339 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 14:00:28,342 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 14:00:28,351 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 14:00:28,352 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 14:00:28,363 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 14:00:28,366 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 14:00:28,373 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 14:00:28,373 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 14:00:28,385 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 14:00:28,398 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:00:28,405 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:00:28,414 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 14:00:28,421 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 14:00:28,428 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 14:00:28,432 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 14:00:28,435 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 14:00:28,443 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:00:28,447 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 14:00:28,447 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 14:00:28,456 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:00:28,462 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:00:28,468 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 14:00:28,476 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 14:00:28,482 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 14:00:28,486 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:00:28,493 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 14:00:28,493 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:00:28,499 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:00:28,504 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:00:28,511 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:00:28,521 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 14:00:28,525 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:00:28,532 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:00:28,546 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 14:00:28,547 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 14:00:28,549 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 14:00:28,553 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 14:00:28,567 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 14:00:28,568 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 14:00:28,569 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 14:00:28,570 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 14:00:28,584 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 14:00:28,588 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 14:00:28,619 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 14:00:28,620 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 14:00:28,625 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 14:00:28,634 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 14:00:28,635 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 14:00:28,639 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 14:00:28,639 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 14:00:28,674 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 14:00:28,685 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:00:28,693 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:00:28,698 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:00:28,704 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:00:28,714 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 14:00:28,723 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 14:00:28,730 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:00:28,744 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 14:06:17,376 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:06:17,377 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 14:06:17,442 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:06:17,446 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:06:17,448 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 14:06:17,448 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,451 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 14:06:17,452 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,453 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 14:06:17,454 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,457 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 14:06:17,458 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,460 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 14:06:17,460 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,463 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 14:06:17,465 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 14:06:17,465 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 14:06:17,466 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 14:06:17,466 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 14:06:17,474 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 14:06:17,475 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:06:17,475 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 14:06:17,488 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:06:17,490 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:06:17,491 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 14:06:17,491 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,492 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:06:17,493 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,494 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 14:06:17,495 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,496 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 14:06:17,497 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,499 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 14:06:17,499 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,508 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 14:06:17,509 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,510 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:06:17,511 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 14:06:17,517 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:06:17,520 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:06:17,520 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 14:06:17,520 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,522 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 14:06:17,522 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,522 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 14:06:17,527 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 14:06:17,529 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 14:06:17,529 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:06:17,530 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 14:06:17,545 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:06:17,547 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:06:17,548 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 14:06:17,548 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,552 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:06:17,553 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,555 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 14:06:17,555 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,557 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 14:06:17,557 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,559 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 14:06:17,560 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,562 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 14:06:17,562 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,564 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 14:06:17,565 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,567 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 14:06:17,567 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,569 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 14:06:17,569 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,570 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:06:17,570 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 14:06:17,574 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:06:17,576 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:06:17,577 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 14:06:17,577 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,578 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 14:06:17,579 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,580 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 14:06:17,581 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:06:17,584 [INFO] pc_project: Starting merge pipeline...
2025-10-26 14:06:17,584 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 14:06:17,587 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 14:06:17,591 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 14:06:17,600 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 14:06:17,602 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 14:06:17,608 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 14:06:17,608 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 14:06:17,620 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 14:06:17,622 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 14:06:17,633 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 14:06:17,634 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 14:06:17,644 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 14:06:17,654 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:06:17,663 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:06:17,671 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 14:06:17,676 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 14:06:17,682 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 14:06:17,686 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 14:06:17,694 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 14:06:17,699 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:06:17,702 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 14:06:17,703 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 14:06:17,712 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:06:17,719 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:06:17,728 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 14:06:17,734 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 14:06:17,742 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 14:06:17,746 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:06:17,751 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 14:06:17,751 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:06:17,761 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:06:17,765 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:06:17,769 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:06:17,780 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 14:06:17,785 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:06:17,790 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:06:17,804 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 14:06:17,804 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 14:06:17,806 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 14:06:17,813 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 14:06:17,828 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 14:06:17,829 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 14:06:17,830 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 14:06:17,833 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 14:06:17,848 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 14:06:17,853 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 14:06:17,879 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 14:06:17,880 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 14:06:17,886 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 14:06:17,893 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 14:06:17,894 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 14:06:17,899 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 14:06:17,900 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 14:06:17,932 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 14:06:17,941 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:06:17,950 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:06:17,955 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:06:17,961 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:06:17,971 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 14:06:17,979 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 14:06:17,982 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:06:17,989 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 14:14:25,424 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:14:25,424 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 14:14:25,486 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:14:25,489 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:14:25,490 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 14:14:25,490 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,496 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 14:14:25,497 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,499 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 14:14:25,500 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,502 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 14:14:25,502 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,505 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 14:14:25,505 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,508 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 14:14:25,511 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 14:14:25,511 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 14:14:25,511 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 14:14:25,511 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 14:14:25,518 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 14:14:25,518 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:14:25,519 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 14:14:25,532 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:14:25,535 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:14:25,535 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 14:14:25,535 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,537 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:14:25,540 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,542 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 14:14:25,543 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,544 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 14:14:25,545 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,546 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 14:14:25,547 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,549 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 14:14:25,550 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,551 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:14:25,551 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 14:14:25,560 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:14:25,563 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:14:25,563 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 14:14:25,563 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,565 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 14:14:25,566 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,567 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 14:14:25,576 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 14:14:25,578 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 14:14:25,578 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:14:25,579 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 14:14:25,595 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:14:25,598 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:14:25,598 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 14:14:25,599 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,601 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:14:25,602 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,605 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 14:14:25,606 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,607 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 14:14:25,608 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,609 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 14:14:25,610 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,612 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 14:14:25,614 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,617 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 14:14:25,617 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,620 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 14:14:25,620 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,622 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 14:14:25,622 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,623 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:14:25,624 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 14:14:25,632 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:14:25,636 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:14:25,637 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 14:14:25,637 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,639 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 14:14:25,639 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,641 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 14:14:25,641 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:14:25,642 [INFO] pc_project: Starting merge pipeline...
2025-10-26 14:14:25,642 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 14:14:25,646 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 14:14:25,655 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 14:14:25,659 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 14:14:25,662 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 14:14:25,668 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 14:14:25,668 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 14:14:25,676 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 14:14:25,679 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 14:14:25,690 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 14:14:25,691 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 14:14:25,702 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 14:14:25,712 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:14:25,723 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:14:25,733 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 14:14:25,739 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 14:14:25,742 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 14:14:25,746 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 14:14:25,749 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 14:14:25,754 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:14:25,760 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 14:14:25,766 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 14:14:25,773 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:14:25,780 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:14:25,788 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 14:14:25,798 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 14:14:25,804 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 14:14:25,809 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:14:25,812 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 14:14:25,813 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:14:25,820 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:14:25,844 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:14:25,848 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:14:25,872 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 14:14:25,876 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:14:25,880 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:14:25,895 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 14:14:25,903 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 14:14:25,906 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 14:14:25,910 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 14:14:25,927 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 14:14:25,927 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 14:14:25,929 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 14:14:25,930 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 14:14:25,943 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 14:14:25,947 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 14:14:26,019 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 14:14:26,037 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 14:14:26,066 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 14:14:26,074 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 14:14:26,074 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 14:14:26,078 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 14:14:26,078 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 14:14:26,121 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 14:14:26,130 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:14:26,136 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:14:26,143 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:14:26,148 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:14:26,160 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 14:14:26,167 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 14:14:26,170 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:14:26,179 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 14:14:26,182 [INFO] pc_project: plot_irr_highlighted: starting chart build.
2025-10-26 14:14:26,192 [INFO] pc_project: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 14:14:26,657 [INFO] pc_project: plot_irr_highlighted: rendering chart to screen.
2025-10-26 14:14:30,466 [INFO] pc_project: plot_irr_highlighted: done.
2025-10-26 14:15:52,026 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:15:52,026 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 14:15:52,037 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:15:52,040 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:15:52,040 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 14:15:52,040 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,042 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 14:15:52,043 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,045 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 14:15:52,045 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,046 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 14:15:52,047 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,048 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 14:15:52,049 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,052 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 14:15:52,057 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 14:15:52,057 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 14:15:52,058 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 14:15:52,058 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 14:15:52,064 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 14:15:52,064 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:15:52,065 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 14:15:52,078 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:15:52,082 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:15:52,083 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 14:15:52,083 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,088 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:15:52,088 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,091 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 14:15:52,091 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,093 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 14:15:52,093 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,095 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 14:15:52,095 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,097 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 14:15:52,097 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,097 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:15:52,098 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 14:15:52,109 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:15:52,112 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:15:52,112 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 14:15:52,113 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,114 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 14:15:52,115 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,115 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 14:15:52,124 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 14:15:52,126 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 14:15:52,127 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:15:52,127 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 14:15:52,144 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:15:52,146 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:15:52,146 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 14:15:52,147 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,150 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:15:52,151 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,154 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 14:15:52,154 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,156 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 14:15:52,157 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,158 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 14:15:52,159 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,162 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 14:15:52,163 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,166 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 14:15:52,167 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,169 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 14:15:52,170 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,172 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 14:15:52,172 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,173 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:15:52,173 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 14:15:52,178 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:15:52,181 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:15:52,182 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 14:15:52,182 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,183 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 14:15:52,184 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,186 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 14:15:52,187 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:15:52,189 [INFO] pc_project: Starting merge pipeline...
2025-10-26 14:15:52,190 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 14:15:52,193 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 14:15:52,200 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 14:15:52,206 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 14:15:52,208 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 14:15:52,216 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 14:15:52,218 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 14:15:52,225 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 14:15:52,228 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 14:15:52,238 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 14:15:52,239 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 14:15:52,248 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 14:15:52,263 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:15:52,272 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:15:52,279 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 14:15:52,287 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 14:15:52,293 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 14:15:52,297 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 14:15:52,301 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 14:15:52,310 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:15:52,314 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 14:15:52,315 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 14:15:52,324 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:15:52,330 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:15:52,335 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 14:15:52,342 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 14:15:52,347 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 14:15:52,351 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:15:52,357 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 14:15:52,358 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:15:52,363 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:15:52,366 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:15:52,373 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:15:52,380 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 14:15:52,384 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:15:52,390 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:15:52,400 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 14:15:52,402 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 14:15:52,406 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 14:15:52,410 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 14:15:52,430 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 14:15:52,430 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 14:15:52,432 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 14:15:52,433 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 14:15:52,446 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 14:15:52,455 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 14:15:52,484 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 14:15:52,485 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 14:15:52,490 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 14:15:52,499 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 14:15:52,502 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 14:15:52,506 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 14:15:52,506 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 14:15:52,541 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 14:15:52,553 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:15:52,560 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:15:52,566 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:15:52,572 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:15:52,587 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 14:15:52,597 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 14:15:52,601 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:15:52,611 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 14:15:52,614 [INFO] pc_project: plot_irr_highlighted: starting chart build.
2025-10-26 14:15:52,625 [INFO] pc_project: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 14:15:53,109 [INFO] pc_project: plot_irr_highlighted: rendering chart to screen.
2025-10-26 14:15:58,357 [INFO] pc_project: plot_irr_highlighted: done.
2025-10-26 14:15:58,754 [INFO] pc_project: save pic: done.
2025-10-26 14:17:26,439 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:17:26,440 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 14:17:26,455 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:17:26,459 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:17:26,459 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 14:17:26,460 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,463 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 14:17:26,463 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,465 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 14:17:26,466 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,467 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 14:17:26,468 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,470 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 14:17:26,470 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,473 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 14:17:26,475 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 14:17:26,476 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 14:17:26,476 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 14:17:26,477 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 14:17:26,484 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 14:17:26,485 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:17:26,485 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 14:17:26,494 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:17:26,498 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:17:26,498 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 14:17:26,498 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,500 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:17:26,500 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,502 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 14:17:26,502 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,505 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 14:17:26,505 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,508 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 14:17:26,508 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,510 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 14:17:26,511 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,514 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:17:26,516 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 14:17:26,521 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:17:26,523 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:17:26,523 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 14:17:26,524 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,525 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 14:17:26,525 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,526 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 14:17:26,532 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 14:17:26,534 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 14:17:26,535 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:17:26,536 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 14:17:26,547 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:17:26,554 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:17:26,555 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 14:17:26,555 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,559 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 14:17:26,560 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,562 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 14:17:26,563 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,567 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 14:17:26,568 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,570 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 14:17:26,571 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,572 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 14:17:26,574 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,576 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 14:17:26,577 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,579 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 14:17:26,579 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,581 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 14:17:26,581 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,582 [INFO] pc_project: Starting data cleaning.
2025-10-26 14:17:26,584 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 14:17:26,593 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 14:17:26,596 [INFO] pc_project: Data cleaning complete.
2025-10-26 14:17:26,597 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 14:17:26,597 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,598 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 14:17:26,599 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,600 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 14:17:26,601 [INFO] pc_project: --------------------------------------------------
2025-10-26 14:17:26,601 [INFO] pc_project: Starting merge pipeline...
2025-10-26 14:17:26,601 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 14:17:26,607 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 14:17:26,612 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 14:17:26,618 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 14:17:26,620 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 14:17:26,628 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 14:17:26,628 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 14:17:26,639 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 14:17:26,642 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 14:17:26,650 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 14:17:26,650 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 14:17:26,713 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 14:17:26,747 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:17:26,756 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 14:17:26,788 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 14:17:26,793 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 14:17:26,800 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 14:17:26,804 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 14:17:26,808 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 14:17:26,817 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:17:26,820 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 14:17:26,821 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 14:17:26,831 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:17:26,837 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 14:17:26,847 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 14:17:26,852 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 14:17:26,857 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 14:17:26,864 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:17:26,869 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 14:17:26,870 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:17:26,876 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:17:26,881 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:17:26,886 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:17:26,894 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 14:17:26,899 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 14:17:26,903 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:17:26,918 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 14:17:26,919 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 14:17:26,924 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 14:17:26,927 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 14:17:26,945 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 14:17:26,945 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 14:17:26,947 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 14:17:26,948 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 14:17:26,962 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 14:17:26,967 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 14:17:26,992 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 14:17:26,993 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 14:17:26,997 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 14:17:27,006 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 14:17:27,006 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 14:17:27,010 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 14:17:27,010 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 14:17:27,042 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 14:17:27,054 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 14:17:27,061 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 14:17:27,069 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 14:17:27,072 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 14:17:27,084 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 14:17:27,091 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 14:17:27,098 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 14:17:27,105 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 14:17:27,108 [INFO] pc_project: plot_irr_highlighted: starting chart build.
2025-10-26 14:17:27,119 [INFO] pc_project: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 14:17:27,574 [INFO] pc_project: plot_irr_highlighted: rendering chart to screen.
2025-10-26 14:17:28,016 [INFO] pc_project: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 14:17:31,224 [INFO] pc_project: plot_irr_highlighted: done.
2025-10-26 16:48:35,431 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 16:48:35,432 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:48:35,477 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:48:35,478 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 16:48:35,582 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:48:35,586 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:48:35,586 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 16:48:35,586 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,592 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 16:48:35,592 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,594 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 16:48:35,594 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,596 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 16:48:35,596 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,598 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 16:48:35,598 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,600 [INFO] pc_project: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 16:48:35,604 [INFO] pc_project: Applied cash flow sign convention.
2025-10-26 16:48:35,604 [INFO] pc_project:   • Negative cash flow types: ['contribution']
2025-10-26 16:48:35,605 [INFO] pc_project:   • Rows converted to negative: 6
2025-10-26 16:48:35,605 [INFO] pc_project:   • Rows converted to positive: 131
2025-10-26 16:48:35,616 [INFO] pc_project: ----------------------------------------------------------------------
2025-10-26 16:48:35,616 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:48:35,617 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 16:48:35,628 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:48:35,631 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:48:35,631 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 16:48:35,631 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,633 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:48:35,633 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,635 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 16:48:35,636 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,637 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 16:48:35,638 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,639 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 16:48:35,640 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,641 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 16:48:35,642 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,643 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:48:35,643 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 16:48:35,650 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:48:35,653 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:48:35,653 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 16:48:35,654 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,657 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 16:48:35,658 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,658 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 16:48:35,667 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 16:48:35,668 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 16:48:35,669 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:48:35,669 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 16:48:35,680 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:48:35,683 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:48:35,683 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 16:48:35,683 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,685 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:48:35,685 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,688 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 16:48:35,689 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,690 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 16:48:35,691 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,692 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 16:48:35,693 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,695 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 16:48:35,695 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,697 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 16:48:35,698 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,700 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 16:48:35,700 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,702 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 16:48:35,702 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,703 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:48:35,704 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 16:48:35,709 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:48:35,711 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:48:35,711 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 16:48:35,712 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,713 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 16:48:35,716 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,718 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 16:48:35,718 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:48:35,718 [INFO] pc_project: Starting merge pipeline...
2025-10-26 16:48:35,720 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 16:48:35,733 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 16:48:35,738 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 16:48:35,744 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 16:48:35,746 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 16:48:35,759 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 16:48:35,759 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 16:48:35,775 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 16:48:35,778 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 16:48:35,787 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 16:48:35,787 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 16:48:35,803 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 16:48:35,818 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:48:35,824 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:48:35,830 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 16:48:35,843 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 16:48:35,850 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 16:48:35,853 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 16:48:35,857 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 16:48:35,860 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 16:48:35,866 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 16:48:35,866 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 16:48:35,873 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:48:35,884 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:48:35,891 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 16:48:35,896 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 16:48:35,903 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 16:48:35,907 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 16:48:35,913 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 16:48:35,913 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 16:48:35,919 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:48:35,922 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:48:35,927 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 16:48:35,936 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 16:48:35,941 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 16:48:35,946 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:48:35,961 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 16:48:35,961 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 16:48:35,965 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 16:48:35,974 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 16:48:36,005 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 16:48:36,011 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 16:48:36,013 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 16:48:36,014 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 16:48:36,043 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 16:48:36,055 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 16:48:36,109 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 16:48:36,110 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 16:48:36,118 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 16:48:36,136 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 16:48:36,141 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 16:48:36,148 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 16:48:36,148 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:48:36,198 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 16:48:36,222 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 16:48:36,239 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:48:36,247 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:48:36,280 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 16:48:36,296 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 16:48:36,310 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 16:48:36,317 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:48:36,339 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 16:48:36,345 [INFO] pc_project: plot_irr_highlighted: starting chart build.
2025-10-26 16:48:36,378 [INFO] pc_project: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 16:48:37,189 [INFO] pc_project: plot_irr_highlighted: rendering chart to screen.
2025-10-26 16:48:37,696 [INFO] pc_project: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 16:50:27,280 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 16:50:27,280 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:50:27,341 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:50:27,341 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 16:50:27,353 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:50:27,356 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:50:27,357 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 16:50:27,357 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,364 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 16:50:27,364 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,366 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 16:50:27,367 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,368 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 16:50:27,369 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,371 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 16:50:27,372 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,374 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 16:50:27,380 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 16:50:27,380 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 16:50:27,380 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 16:50:27,381 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 16:50:27,386 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 16:50:27,386 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:50:27,387 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 16:50:27,400 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:50:27,402 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:50:27,403 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 16:50:27,403 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,406 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:50:27,408 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,411 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 16:50:27,411 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,413 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 16:50:27,414 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,416 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 16:50:27,416 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,417 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 16:50:27,418 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,418 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:50:27,419 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 16:50:27,425 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:50:27,430 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:50:27,430 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 16:50:27,430 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,433 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 16:50:27,433 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,434 [INFO] pc_project: Starting curve cleaning process...
2025-10-26 16:50:27,444 [INFO] pc_project: Curve cleaning completed — 2 values modified.
2025-10-26 16:50:27,445 [INFO] pc_project: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 16:50:27,446 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:50:27,446 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 16:50:27,465 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:50:27,468 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:50:27,468 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 16:50:27,469 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,471 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:50:27,472 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,474 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 16:50:27,475 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,477 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 16:50:27,478 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,479 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 16:50:27,481 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,484 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 16:50:27,484 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,488 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 16:50:27,488 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,491 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 16:50:27,492 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,494 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 16:50:27,495 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,495 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:50:27,496 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 16:50:27,504 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:50:27,506 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:50:27,507 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 16:50:27,507 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,508 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 16:50:27,509 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,510 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 16:50:27,511 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:50:27,511 [INFO] pc_project: Starting merge pipeline...
2025-10-26 16:50:27,512 [INFO] pc_project: Before structure merge: (137, 6)
2025-10-26 16:50:27,515 [INFO] pc_project: After structure merge: (137, 14)
2025-10-26 16:50:27,522 [INFO] pc_project: After terms merge: (137, 24)
2025-10-26 16:50:27,527 [INFO] pc_project: After leverage merge: (137, 29)
2025-10-26 16:50:27,529 [INFO] pc_project: No missing values detected in merged dataset.
2025-10-26 16:50:27,537 [INFO] pc_project: No duplicate rows detected in merged dataset.
2025-10-26 16:50:27,538 [INFO] pc_project: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 16:50:27,548 [INFO] pc_project: Curve merge successful: all rows matched a curve rate.
2025-10-26 16:50:27,551 [INFO] pc_project: Removed 12 PIK interest cashflows (accrued).
2025-10-26 16:50:27,562 [INFO] pc_project: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 16:50:27,565 [INFO] pc_project: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 16:50:27,576 [INFO] pc_project: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 16:50:27,589 [INFO] pc_project: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:50:27,597 [INFO] pc_project: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:50:27,604 [INFO] pc_project: IRR calculation starts on the entity_id level
2025-10-26 16:50:27,610 [INFO] pc_project: xirr(): Converged successfully at 0.140130
2025-10-26 16:50:27,616 [INFO] pc_project: xirr(): Converged successfully at 0.128055
2025-10-26 16:50:27,623 [INFO] pc_project: xirr(): Converged successfully at 0.149952
2025-10-26 16:50:27,629 [INFO] pc_project: xirr(): Converged successfully at 0.113139
2025-10-26 16:50:27,633 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 16:50:27,639 [INFO] pc_project: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 16:50:27,640 [INFO] pc_project: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 16:50:27,654 [INFO] pc_project: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:50:27,661 [INFO] pc_project: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:50:27,667 [INFO] pc_project: IRR calculation starts on the deal_id level
2025-10-26 16:50:27,674 [INFO] pc_project: xirr(): Converged successfully at 0.136003
2025-10-26 16:50:27,681 [INFO] pc_project: xirr(): Converged successfully at 0.133075
2025-10-26 16:50:27,685 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 16:50:27,689 [INFO] pc_project: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 16:50:27,689 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 16:50:27,695 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:50:27,699 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:50:27,703 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 16:50:27,713 [INFO] pc_project: xirr(): Converged successfully at 0.134758
2025-10-26 16:50:27,718 [INFO] pc_project: xirr(): Converged successfully at 0.127697
2025-10-26 16:50:27,721 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:50:27,736 [INFO] pc_project: Merged all levels — total rows: 10
2025-10-26 16:50:27,736 [INFO] pc_project: Facility: 5, Deal: 3, Fund: 2
2025-10-26 16:50:27,741 [INFO] pc_project: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 16:50:27,746 [INFO] pc_project: Starting full fund-level financing pipeline...
2025-10-26 16:50:27,760 [INFO] pc_project: clean_data_fund: processed 6 records.
2025-10-26 16:50:27,762 [INFO] pc_project: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 16:50:27,764 [INFO] pc_project: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 16:50:27,765 [INFO] pc_project: Step 1: clean_data_fund complete — 6 rows
2025-10-26 16:50:27,780 [INFO] pc_project: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 16:50:27,784 [INFO] pc_project: Step 2: return_fund_info complete — 3 rows
2025-10-26 16:50:27,811 [INFO] pc_project: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 16:50:27,812 [INFO] pc_project: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 16:50:27,817 [INFO] pc_project: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 16:50:27,822 [INFO] pc_project: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 16:50:27,824 [INFO] pc_project: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 16:50:27,829 [INFO] pc_project: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 16:50:27,829 [INFO] pc_project: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:50:27,861 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 16:50:27,873 [INFO] pc_project: Computing metrics at level: ['fund']
2025-10-26 16:50:27,881 [INFO] pc_project: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:50:27,885 [INFO] pc_project: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:50:27,889 [INFO] pc_project: IRR calculation starts on the fund level
2025-10-26 16:50:27,900 [INFO] pc_project: xirr(): Converged successfully at 0.106299
2025-10-26 16:50:27,907 [INFO] pc_project: xirr(): Converged successfully at 0.103069
2025-10-26 16:50:27,912 [INFO] pc_project: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:50:27,920 [INFO] pc_project: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 16:50:27,923 [INFO] pc_project: plot_irr_highlighted: starting chart build.
2025-10-26 16:50:27,932 [INFO] pc_project: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 16:50:28,405 [INFO] pc_project: plot_irr_highlighted: rendering chart to screen.
2025-10-26 16:50:28,908 [INFO] pc_project: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 16:53:21,852 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 16:53:21,852 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:53:21,870 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:53:21,870 [INFO] pc_project: Input shape: (137, 6)
2025-10-26 16:53:21,940 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:53:21,943 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:53:21,944 [INFO] pc_project: Output shape: (137, 6)
2025-10-26 16:53:21,944 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,947 [INFO] pc_project: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 16:53:21,948 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,950 [INFO] pc_project: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 16:53:21,950 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,952 [INFO] pc_project: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 16:53:21,953 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,954 [INFO] pc_project: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 16:53:21,955 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,956 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 16:53:21,958 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 16:53:21,959 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 16:53:21,959 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 16:53:21,959 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 16:53:21,965 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 16:53:21,965 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:53:21,965 [INFO] pc_project: Input shape: (5, 10)
2025-10-26 16:53:21,980 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:53:21,983 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:53:21,983 [INFO] pc_project: Output shape: (5, 10)
2025-10-26 16:53:21,983 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,985 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:53:21,985 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,987 [INFO] pc_project: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 16:53:21,987 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,989 [INFO] pc_project: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 16:53:21,989 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,990 [INFO] pc_project: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 16:53:21,991 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,992 [INFO] pc_project: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 16:53:21,993 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:21,993 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:53:21,994 [INFO] pc_project: Input shape: (48, 3)
2025-10-26 16:53:22,002 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:53:22,004 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:53:22,005 [INFO] pc_project: Output shape: (48, 3)
2025-10-26 16:53:22,005 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,007 [INFO] pc_project: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 16:53:22,007 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,007 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 16:53:22,017 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 16:53:22,019 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 16:53:22,019 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:53:22,020 [INFO] pc_project: Input shape: (5, 8)
2025-10-26 16:53:22,034 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:53:22,037 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:53:22,037 [INFO] pc_project: Output shape: (5, 8)
2025-10-26 16:53:22,038 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,039 [INFO] pc_project: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:53:22,040 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,042 [INFO] pc_project: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 16:53:22,043 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,045 [INFO] pc_project: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 16:53:22,046 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,048 [INFO] pc_project: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 16:53:22,049 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,050 [INFO] pc_project: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 16:53:22,050 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,052 [INFO] pc_project: Top values in 'region':
region
nan    4
eu     1
2025-10-26 16:53:22,053 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,054 [INFO] pc_project: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 16:53:22,054 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,055 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 16:53:22,055 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,056 [INFO] pc_project: Starting data cleaning.
2025-10-26 16:53:22,056 [INFO] pc_project: Input shape: (2, 6)
2025-10-26 16:53:22,064 [INFO] pc_project: No NaN values detected in the dataset.
2025-10-26 16:53:22,066 [INFO] pc_project: Data cleaning complete.
2025-10-26 16:53:22,067 [INFO] pc_project: Output shape: (2, 6)
2025-10-26 16:53:22,067 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,069 [INFO] pc_project: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 16:53:22,069 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,072 [INFO] pc_project: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 16:53:22,072 [INFO] pc_project: --------------------------------------------------
2025-10-26 16:53:22,073 [INFO] merge: Starting merge pipeline...
2025-10-26 16:53:22,073 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 16:53:22,076 [INFO] merge: After structure merge: (137, 14)
2025-10-26 16:53:22,081 [INFO] merge: After terms merge: (137, 24)
2025-10-26 16:53:22,086 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 16:53:22,088 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 16:53:22,095 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 16:53:22,096 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 16:53:22,101 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 16:53:22,103 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 16:53:22,108 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 16:53:22,108 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 16:53:22,118 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 16:53:22,130 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:53:22,136 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:53:22,141 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 16:53:22,148 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 16:53:22,154 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 16:53:22,163 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 16:53:22,167 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 16:53:22,171 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 16:53:22,174 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 16:53:22,175 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 16:53:22,185 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:53:22,194 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:53:22,199 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 16:53:22,205 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 16:53:22,210 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 16:53:22,216 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 16:53:22,222 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 16:53:22,223 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 16:53:22,231 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:53:22,236 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:53:22,240 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 16:53:22,249 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 16:53:22,254 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 16:53:22,260 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:53:22,274 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 16:53:22,274 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 16:53:22,278 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 16:53:22,284 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 16:53:22,304 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 16:53:22,304 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 16:53:22,306 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 16:53:22,306 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 16:53:22,328 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 16:53:22,333 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 16:53:22,365 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 16:53:22,366 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 16:53:22,371 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 16:53:22,380 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 16:53:22,382 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 16:53:22,386 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 16:53:22,387 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:53:22,428 [INFO] pc_project: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 16:53:22,443 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 16:53:22,455 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:53:22,459 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:53:22,465 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 16:53:22,479 [INFO] metrics: xirr(): Converged successfully at 0.106299
2025-10-26 16:53:22,486 [INFO] metrics: xirr(): Converged successfully at 0.103069
2025-10-26 16:53:22,490 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:53:22,498 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 16:53:22,501 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 16:53:22,513 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 16:53:22,972 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 16:53:23,434 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
