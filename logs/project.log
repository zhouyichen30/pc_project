2025-10-26 16:57:22,661 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 16:57:22,662 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:57:22,684 [INFO] utils: Starting data cleaning.
2025-10-26 16:57:22,685 [INFO] utils: Input shape: (137, 6)
2025-10-26 16:57:22,768 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 16:57:22,771 [INFO] utils: Data cleaning complete.
2025-10-26 16:57:22,772 [INFO] utils: Output shape: (137, 6)
2025-10-26 16:57:22,772 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,774 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 16:57:22,774 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,776 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 16:57:22,776 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,778 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 16:57:22,779 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,782 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 16:57:22,782 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,786 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 16:57:22,789 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 16:57:22,797 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 16:57:22,804 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 16:57:22,804 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 16:57:22,811 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 16:57:22,812 [INFO] utils: Starting data cleaning.
2025-10-26 16:57:22,812 [INFO] utils: Input shape: (5, 10)
2025-10-26 16:57:22,827 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 16:57:22,837 [INFO] utils: Data cleaning complete.
2025-10-26 16:57:22,837 [INFO] utils: Output shape: (5, 10)
2025-10-26 16:57:22,838 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,840 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:57:22,841 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,843 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 16:57:22,843 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,845 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 16:57:22,847 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,850 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 16:57:22,850 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,852 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 16:57:22,852 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,852 [INFO] utils: Starting data cleaning.
2025-10-26 16:57:22,852 [INFO] utils: Input shape: (48, 3)
2025-10-26 16:57:22,861 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 16:57:22,866 [INFO] utils: Data cleaning complete.
2025-10-26 16:57:22,867 [INFO] utils: Output shape: (48, 3)
2025-10-26 16:57:22,868 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,869 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 16:57:22,870 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,870 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 16:57:22,876 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 16:57:22,878 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 16:57:22,878 [INFO] utils: Starting data cleaning.
2025-10-26 16:57:22,879 [INFO] utils: Input shape: (5, 8)
2025-10-26 16:57:22,899 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 16:57:22,903 [INFO] utils: Data cleaning complete.
2025-10-26 16:57:22,903 [INFO] utils: Output shape: (5, 8)
2025-10-26 16:57:22,904 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,906 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 16:57:22,906 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,908 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 16:57:22,908 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,911 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 16:57:22,911 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,913 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 16:57:22,914 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,915 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 16:57:22,919 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,921 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 16:57:22,922 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,924 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 16:57:22,927 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,929 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 16:57:22,930 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,931 [INFO] utils: Starting data cleaning.
2025-10-26 16:57:22,943 [INFO] utils: Input shape: (2, 6)
2025-10-26 16:57:22,965 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 16:57:22,978 [INFO] utils: Data cleaning complete.
2025-10-26 16:57:22,978 [INFO] utils: Output shape: (2, 6)
2025-10-26 16:57:22,979 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,984 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 16:57:22,988 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,994 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 16:57:22,994 [INFO] utils: --------------------------------------------------
2025-10-26 16:57:22,995 [INFO] merge: Starting merge pipeline...
2025-10-26 16:57:22,995 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 16:57:23,001 [INFO] merge: After structure merge: (137, 14)
2025-10-26 16:57:23,011 [INFO] merge: After terms merge: (137, 24)
2025-10-26 16:57:23,020 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 16:57:23,022 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 16:57:23,028 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 16:57:23,029 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 16:57:23,040 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 16:57:23,050 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 16:57:23,059 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 16:57:23,059 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 16:57:23,083 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 16:57:23,093 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:57:23,102 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 16:57:23,127 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 16:57:23,134 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 16:57:23,138 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 16:57:23,144 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 16:57:23,150 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 16:57:23,156 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 16:57:23,163 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 16:57:23,163 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 16:57:23,175 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:57:23,194 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 16:57:23,199 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 16:57:23,210 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 16:57:23,225 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 16:57:23,229 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 16:57:23,233 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 16:57:23,236 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 16:57:23,282 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:57:23,291 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:57:23,307 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 16:57:23,329 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 16:57:23,335 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 16:57:23,343 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:57:23,364 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 16:57:23,366 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 16:57:23,369 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 16:57:23,375 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 16:57:23,396 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 16:57:23,397 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 16:57:23,401 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 16:57:23,405 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 16:57:23,421 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 16:57:23,426 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 16:57:23,456 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 16:57:23,457 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 16:57:23,462 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 16:57:23,471 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 16:57:23,472 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 16:57:23,476 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 16:57:23,476 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 16:57:23,517 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 16:57:23,528 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 16:57:23,536 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 16:57:23,541 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 16:57:23,548 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 16:57:23,559 [INFO] metrics: xirr(): Converged successfully at 0.106299
2025-10-26 16:57:23,565 [INFO] metrics: xirr(): Converged successfully at 0.103069
2025-10-26 16:57:23,569 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 16:57:23,577 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 16:57:23,582 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 16:57:23,631 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 16:57:24,178 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 16:57:24,683 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:03:19,696 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:03:19,697 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:03:19,712 [INFO] utils: Starting data cleaning.
2025-10-26 17:03:19,712 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:03:19,781 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:03:19,783 [INFO] utils: Data cleaning complete.
2025-10-26 17:03:19,784 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:03:19,784 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,787 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:03:19,788 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,790 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:03:19,791 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,794 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:03:19,796 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,797 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:03:19,798 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,801 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:03:19,803 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:03:19,804 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:03:19,804 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:03:19,806 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:03:19,812 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:03:19,812 [INFO] utils: Starting data cleaning.
2025-10-26 17:03:19,812 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:03:19,821 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:03:19,823 [INFO] utils: Data cleaning complete.
2025-10-26 17:03:19,824 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:03:19,824 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,825 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:03:19,825 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,827 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:03:19,828 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,829 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:03:19,830 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,831 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:03:19,832 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,833 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:03:19,835 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,839 [INFO] utils: Starting data cleaning.
2025-10-26 17:03:19,839 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:03:19,847 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:03:19,849 [INFO] utils: Data cleaning complete.
2025-10-26 17:03:19,849 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:03:19,850 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,851 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:03:19,852 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,852 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:03:19,857 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:03:19,858 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:03:19,859 [INFO] utils: Starting data cleaning.
2025-10-26 17:03:19,859 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:03:19,872 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:03:19,874 [INFO] utils: Data cleaning complete.
2025-10-26 17:03:19,875 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:03:19,876 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,878 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:03:19,879 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,881 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:03:19,881 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,882 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:03:19,883 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,884 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:03:19,885 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,886 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:03:19,887 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,888 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:03:19,888 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,889 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:03:19,890 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,891 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:03:19,891 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,892 [INFO] utils: Starting data cleaning.
2025-10-26 17:03:19,892 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:03:19,903 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:03:19,906 [INFO] utils: Data cleaning complete.
2025-10-26 17:03:19,906 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:03:19,906 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,908 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:03:19,908 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,910 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:03:19,911 [INFO] utils: --------------------------------------------------
2025-10-26 17:03:19,911 [INFO] merge: Starting merge pipeline...
2025-10-26 17:03:19,911 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:03:19,916 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:03:19,920 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:03:19,925 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:03:19,926 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:03:19,938 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:03:19,938 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:03:19,944 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:03:19,950 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:03:19,956 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:03:19,957 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:03:19,968 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:03:19,976 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:03:19,986 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:03:19,992 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:03:19,999 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:03:20,002 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:03:20,005 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:03:20,008 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:03:20,021 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:03:20,027 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:03:20,028 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:03:20,034 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:03:20,040 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:03:20,049 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:03:20,057 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:03:20,062 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:03:20,066 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:03:20,070 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:03:20,070 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:03:20,074 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:03:20,078 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:03:20,085 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:03:20,094 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:03:20,098 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:03:20,101 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:03:20,112 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:03:20,113 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:03:20,114 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:03:20,119 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:03:20,136 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:03:20,137 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:03:20,138 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:03:20,139 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:03:20,152 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:03:20,160 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:03:20,184 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:03:20,188 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:03:20,192 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:03:20,200 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:03:20,201 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:03:20,205 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:03:20,205 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:03:20,239 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:03:20,251 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:03:20,258 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:03:20,267 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:03:20,271 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:03:20,284 [INFO] metrics: xirr(): Converged successfully at 0.106299
2025-10-26 17:03:20,290 [INFO] metrics: xirr(): Converged successfully at 0.103069
2025-10-26 17:03:20,297 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:03:20,303 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:03:20,306 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:03:20,317 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:03:20,784 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:03:21,229 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:06:16,346 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:06:16,347 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:06:16,416 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:16,417 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:06:16,438 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:16,442 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:16,443 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:06:16,443 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,445 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:06:16,446 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,448 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:06:16,448 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,455 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:06:16,456 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,457 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:06:16,458 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,463 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:06:16,468 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:06:16,468 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:06:16,469 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:06:16,470 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:06:16,475 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:06:16,475 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:16,476 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:06:16,492 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:16,497 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:16,498 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:06:16,498 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,500 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:06:16,501 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,503 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:06:16,503 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,505 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:06:16,505 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,507 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:06:16,507 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,509 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:06:16,509 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,511 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:16,511 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:06:16,522 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:16,524 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:16,525 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:06:16,525 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,527 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:06:16,528 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,528 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:06:16,535 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:06:16,537 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:06:16,538 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:06:16,539 [INFO] __main__: curve data shocked for 0.01
2025-10-26 17:06:16,539 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:16,540 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:06:16,555 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:16,558 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:16,558 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:06:16,559 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,560 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:06:16,562 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,566 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:06:16,568 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,570 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:06:16,570 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,572 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:06:16,572 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,574 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:06:16,574 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,577 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:06:16,578 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,580 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:06:16,580 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,582 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:06:16,583 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,584 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:16,584 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:06:16,589 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:16,594 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:16,594 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:06:16,595 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,597 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:06:16,597 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,599 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:06:16,599 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:16,600 [INFO] merge: Starting merge pipeline...
2025-10-26 17:06:16,602 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:06:16,606 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:06:16,611 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:06:16,616 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:06:16,618 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:06:16,624 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:06:16,624 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:06:16,635 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:06:16,638 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:06:16,649 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:06:16,649 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:06:16,661 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:06:16,672 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:06:16,682 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:06:16,690 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:06:16,695 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:06:16,701 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:06:16,704 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:06:16,708 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:06:16,711 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:06:16,718 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:06:16,718 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:06:16,729 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:06:16,736 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:06:16,741 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:06:16,747 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:06:16,755 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:06:16,759 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:06:16,764 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:06:16,764 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:06:16,770 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:06:16,773 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:06:16,778 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:06:16,790 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:06:16,795 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:06:16,798 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:06:16,810 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:06:16,810 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:06:16,812 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:06:16,818 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:06:16,835 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:06:16,835 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:06:16,836 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:06:16,837 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:06:16,853 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:06:16,857 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:06:16,884 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:06:16,885 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:06:16,889 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:06:16,899 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:06:16,900 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:06:16,904 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:06:16,904 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:06:16,937 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:06:16,948 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:06:16,956 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:06:16,965 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:06:16,969 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:06:16,977 [INFO] metrics: xirr(): Converged successfully at 0.100246
2025-10-26 17:06:16,986 [INFO] metrics: xirr(): Converged successfully at 0.098175
2025-10-26 17:06:16,990 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:06:17,001 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:06:17,004 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:06:17,011 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:06:17,468 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:06:17,979 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:06:36,599 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:06:36,599 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:06:36,661 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:36,662 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:06:36,682 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:36,685 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:36,686 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:06:36,686 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,688 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:06:36,689 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,692 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:06:36,692 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,694 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:06:36,695 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,696 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:06:36,697 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,699 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:06:36,701 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:06:36,701 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:06:36,702 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:06:36,702 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:06:36,707 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:06:36,707 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:36,708 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:06:36,720 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:36,725 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:36,726 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:06:36,726 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,729 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:06:36,729 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,731 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:06:36,731 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,733 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:06:36,733 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,735 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:06:36,735 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,737 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:06:36,737 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,738 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:36,738 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:06:36,745 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:36,747 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:36,748 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:06:36,748 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,750 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:06:36,751 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,751 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:06:36,758 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:06:36,759 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:06:36,760 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:06:36,763 [INFO] __main__: curve data shocked for 0.05
2025-10-26 17:06:36,765 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:36,765 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:06:36,778 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:36,782 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:36,782 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:06:36,782 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,784 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:06:36,784 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,785 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:06:36,785 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,786 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:06:36,787 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,789 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:06:36,789 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,791 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:06:36,791 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,794 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:06:36,795 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,796 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:06:36,797 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,798 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:06:36,799 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,800 [INFO] utils: Starting data cleaning.
2025-10-26 17:06:36,800 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:06:36,806 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:06:36,808 [INFO] utils: Data cleaning complete.
2025-10-26 17:06:36,809 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:06:36,809 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,812 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:06:36,812 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,814 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:06:36,814 [INFO] utils: --------------------------------------------------
2025-10-26 17:06:36,815 [INFO] merge: Starting merge pipeline...
2025-10-26 17:06:36,816 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:06:36,819 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:06:36,824 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:06:36,829 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:06:36,831 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:06:36,838 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:06:36,839 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:06:36,847 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:06:36,852 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:06:36,861 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:06:36,863 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:06:36,875 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:06:36,888 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:06:36,900 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:06:36,905 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:06:36,911 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:06:36,915 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:06:36,920 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:06:36,925 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:06:36,929 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:06:36,934 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:06:36,935 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:06:36,948 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:06:36,953 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:06:36,960 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:06:36,969 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:06:36,975 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:06:36,980 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:06:36,983 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:06:36,987 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:06:36,993 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:06:36,998 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:06:37,002 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:06:37,015 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:06:37,018 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:06:37,022 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:06:37,037 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:06:37,038 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:06:37,041 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:06:37,045 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:06:37,062 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:06:37,063 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:06:37,064 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:06:37,065 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:06:37,083 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:06:37,088 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:06:37,117 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:06:37,118 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:06:37,122 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:06:37,130 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:06:37,131 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:06:37,136 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:06:37,136 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:06:37,166 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:06:37,179 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:06:37,191 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:06:37,196 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:06:37,203 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:06:37,213 [INFO] metrics: xirr(): Converged successfully at 0.076314
2025-10-26 17:06:37,223 [INFO] metrics: xirr(): Converged successfully at 0.078781
2025-10-26 17:06:37,227 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:06:37,237 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:06:37,240 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:06:37,248 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:06:37,730 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:06:38,153 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:08:08,380 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:08:08,380 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:08:08,444 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:08,444 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:08:08,462 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:08,465 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:08,466 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:08:08,466 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,468 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:08:08,470 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,473 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:08:08,473 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,475 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:08:08,476 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,477 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:08:08,477 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,480 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:08:08,482 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:08:08,482 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:08:08,483 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:08:08,483 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:08:08,489 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:08:08,490 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:08,490 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:08:08,500 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:08,508 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:08,509 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:08:08,510 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,512 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:08:08,512 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,514 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:08:08,514 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,516 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:08:08,517 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,519 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:08:08,519 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,521 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:08:08,521 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,522 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:08,522 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:08:08,529 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:08,532 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:08,532 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:08:08,533 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,535 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:08:08,536 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,536 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:08:08,543 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:08:08,546 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:08:08,548 [INFO] cli_utils: CLI argument parsed — curve shock: 0.0
2025-10-26 17:08:08,550 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:08,550 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:08:08,565 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:08,568 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:08,569 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:08:08,570 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,572 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:08:08,572 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,574 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:08:08,574 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,576 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:08:08,576 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,578 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:08:08,578 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,580 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:08:08,580 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,582 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:08:08,582 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,583 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:08:08,583 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,585 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:08:08,585 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,586 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:08,586 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:08:08,593 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:08,596 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:08,599 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:08:08,601 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,605 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:08:08,606 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,608 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:08:08,609 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:08,609 [INFO] merge: Starting merge pipeline...
2025-10-26 17:08:08,609 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:08:08,613 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:08:08,616 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:08:08,620 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:08:08,622 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:08:08,630 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:08:08,630 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:08:08,638 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:08:08,640 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:08:08,646 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:08:08,646 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:08:08,654 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:08:08,666 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:08:08,675 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:08:08,680 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:08:08,684 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:08:08,687 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:08:08,691 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:08:08,695 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:08:08,700 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:08,707 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:08:08,708 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:08:08,715 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:08:08,719 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:08:08,727 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:08:08,733 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:08:08,738 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:08:08,743 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:08,747 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:08:08,747 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:08:08,752 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:08:08,756 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:08:08,761 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:08:08,768 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:08:08,775 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:08,778 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:08:08,792 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:08:08,793 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:08:08,795 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:08:08,798 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:08:08,814 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:08:08,814 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:08:08,815 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:08:08,816 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:08:08,827 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:08:08,835 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:08:08,860 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:08:08,861 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:08:08,867 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:08:08,875 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:08:08,876 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:08:08,880 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:08:08,880 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:08:08,908 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:08:08,917 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:08:08,927 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:08:08,932 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:08:08,937 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:08:08,947 [INFO] metrics: xirr(): Converged successfully at 0.106299
2025-10-26 17:08:08,953 [INFO] metrics: xirr(): Converged successfully at 0.103069
2025-10-26 17:08:08,961 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:08:08,968 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:08:08,972 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:08:08,981 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:08:09,470 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:08:09,932 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:08:23,699 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:08:23,700 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:08:23,716 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:23,716 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:08:23,781 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:23,784 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:23,785 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:08:23,785 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,787 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:08:23,787 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,789 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:08:23,789 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,792 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:08:23,792 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,794 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:08:23,794 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,797 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:08:23,798 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:08:23,799 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:08:23,799 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:08:23,799 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:08:23,804 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:08:23,809 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:23,809 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:08:23,819 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:23,824 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:23,824 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:08:23,824 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,826 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:08:23,827 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,829 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:08:23,829 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,831 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:08:23,831 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,833 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:08:23,833 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,835 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:08:23,835 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,836 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:23,836 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:08:23,841 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:23,843 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:23,843 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:08:23,843 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,845 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:08:23,845 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,845 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:08:23,855 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:08:23,856 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:08:23,861 [INFO] cli_utils: CLI argument parsed — curve shock: 0.01
2025-10-26 17:08:23,862 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:08:23,863 [INFO] __main__: curve data shocked for 0.01
2025-10-26 17:08:23,864 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:23,865 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:08:23,877 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:23,880 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:23,880 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:08:23,880 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,881 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:08:23,882 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,883 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:08:23,884 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,885 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:08:23,885 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,887 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:08:23,887 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,889 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:08:23,889 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,891 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:08:23,891 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,893 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:08:23,893 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,895 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:08:23,895 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,895 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:23,896 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:08:23,904 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:23,906 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:23,907 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:08:23,907 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,910 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:08:23,910 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,912 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:08:23,912 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:23,913 [INFO] merge: Starting merge pipeline...
2025-10-26 17:08:23,913 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:08:23,917 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:08:23,921 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:08:23,926 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:08:23,928 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:08:23,935 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:08:23,935 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:08:23,944 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:08:23,949 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:08:23,957 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:08:23,957 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:08:23,966 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:08:23,974 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:08:23,983 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:08:23,997 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:08:24,001 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:08:24,005 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:08:24,024 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:08:24,029 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:08:24,033 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:24,036 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:08:24,036 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:08:24,046 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:08:24,062 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:08:24,068 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:08:24,071 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:08:24,078 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:08:24,082 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:24,085 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:08:24,086 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:08:24,093 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:08:24,098 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:08:24,101 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:08:24,112 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:08:24,115 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:24,119 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:08:24,132 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:08:24,132 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:08:24,135 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:08:24,139 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:08:24,156 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:08:24,156 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:08:24,159 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:08:24,159 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:08:24,170 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:08:24,175 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:08:24,202 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:08:24,203 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:08:24,207 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:08:24,214 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:08:24,215 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:08:24,220 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:08:24,221 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:08:24,248 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:08:24,260 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:08:24,268 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:08:24,273 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:08:24,278 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:08:24,293 [INFO] metrics: xirr(): Converged successfully at 0.100246
2025-10-26 17:08:24,301 [INFO] metrics: xirr(): Converged successfully at 0.098175
2025-10-26 17:08:24,304 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:08:24,314 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:08:24,317 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:08:24,329 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:08:24,792 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:08:25,251 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:08:31,393 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:08:31,393 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:08:31,412 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:31,412 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:08:31,475 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:31,478 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:31,478 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:08:31,479 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,482 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:08:31,482 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,484 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:08:31,484 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,486 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:08:31,486 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,488 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:08:31,488 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,490 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:08:31,492 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:08:31,492 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:08:31,495 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:08:31,496 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:08:31,502 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:08:31,502 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:31,504 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:08:31,516 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:31,518 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:31,518 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:08:31,519 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,520 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:08:31,520 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,522 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:08:31,522 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,524 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:08:31,524 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,526 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:08:31,526 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,528 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:08:31,528 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,529 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:31,530 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:08:31,536 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:31,539 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:31,539 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:08:31,540 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,541 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:08:31,542 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,544 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:08:31,552 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:08:31,552 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:08:31,556 [INFO] cli_utils: CLI argument parsed — curve shock: 0.05
2025-10-26 17:08:31,556 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:08:31,557 [INFO] __main__: curve data shocked for 0.05
2025-10-26 17:08:31,557 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:31,558 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:08:31,568 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:31,569 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:31,570 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:08:31,570 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,572 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:08:31,573 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,576 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:08:31,576 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,578 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:08:31,579 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,581 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:08:31,581 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,583 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:08:31,584 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,586 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:08:31,589 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,593 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:08:31,594 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,595 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:08:31,596 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,596 [INFO] utils: Starting data cleaning.
2025-10-26 17:08:31,598 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:08:31,604 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:08:31,610 [INFO] utils: Data cleaning complete.
2025-10-26 17:08:31,610 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:08:31,611 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,612 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:08:31,613 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,615 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:08:31,615 [INFO] utils: --------------------------------------------------
2025-10-26 17:08:31,616 [INFO] merge: Starting merge pipeline...
2025-10-26 17:08:31,616 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:08:31,620 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:08:31,624 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:08:31,631 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:08:31,633 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:08:31,641 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:08:31,641 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:08:31,650 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:08:31,654 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:08:31,659 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:08:31,661 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:08:31,676 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:08:31,692 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:08:31,703 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:08:31,709 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:08:31,719 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:08:31,723 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:08:31,727 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:08:31,732 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:08:31,739 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:31,746 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:08:31,746 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:08:31,766 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:08:31,774 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:08:31,783 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:08:31,787 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:08:31,792 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:08:31,797 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:31,802 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:08:31,803 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:08:31,808 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:08:31,814 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:08:31,818 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:08:31,825 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:08:31,830 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:08:31,836 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:08:31,850 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:08:31,850 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:08:31,852 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:08:31,859 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:08:31,875 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:08:31,876 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:08:31,877 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:08:31,877 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:08:31,892 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:08:31,897 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:08:31,924 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:08:31,925 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:08:31,929 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:08:31,938 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:08:31,939 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:08:31,942 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:08:31,942 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:08:31,974 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:08:31,982 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:08:31,991 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:08:31,996 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:08:32,002 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:08:32,012 [INFO] metrics: xirr(): Converged successfully at 0.076314
2025-10-26 17:08:32,022 [INFO] metrics: xirr(): Converged successfully at 0.078781
2025-10-26 17:08:32,026 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:08:32,039 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:08:32,042 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:08:32,051 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:08:32,502 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:08:32,946 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:16:41,007 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:16:41,008 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:16:41,021 [INFO] utils: Starting data cleaning.
2025-10-26 17:16:41,022 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:16:41,092 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:16:41,095 [INFO] utils: Data cleaning complete.
2025-10-26 17:16:41,096 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:16:41,096 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,098 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:16:41,099 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,101 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:16:41,102 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,104 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:16:41,104 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,106 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:16:41,107 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,109 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:16:41,111 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:16:41,112 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:16:41,112 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:16:41,112 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:16:41,123 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:16:41,123 [INFO] utils: Starting data cleaning.
2025-10-26 17:16:41,124 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:16:41,134 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:16:41,137 [INFO] utils: Data cleaning complete.
2025-10-26 17:16:41,137 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:16:41,138 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,141 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:16:41,142 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,143 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:16:41,144 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,146 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:16:41,147 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,149 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:16:41,149 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,151 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:16:41,152 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,152 [INFO] utils: Starting data cleaning.
2025-10-26 17:16:41,153 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:16:41,160 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:16:41,164 [INFO] utils: Data cleaning complete.
2025-10-26 17:16:41,165 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:16:41,165 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,166 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:16:41,167 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,167 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:16:41,172 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:16:41,175 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:16:41,179 [INFO] cli_utils: CLI argument parsed — curve shock: -0.0025
2025-10-26 17:16:41,180 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:16:41,181 [INFO] __main__: curve data shocked for -0.0025
2025-10-26 17:16:41,181 [INFO] utils: Starting data cleaning.
2025-10-26 17:16:41,182 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:16:41,198 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:16:41,201 [INFO] utils: Data cleaning complete.
2025-10-26 17:16:41,202 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:16:41,202 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,204 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:16:41,205 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,211 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:16:41,212 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,214 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:16:41,214 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,216 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:16:41,217 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,220 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:16:41,220 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,222 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:16:41,222 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,224 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:16:41,225 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,228 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:16:41,228 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,230 [INFO] utils: Starting data cleaning.
2025-10-26 17:16:41,230 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:16:41,236 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:16:41,240 [INFO] utils: Data cleaning complete.
2025-10-26 17:16:41,241 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:16:41,241 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,242 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:16:41,243 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,247 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:16:41,249 [INFO] utils: --------------------------------------------------
2025-10-26 17:16:41,252 [INFO] merge: Starting merge pipeline...
2025-10-26 17:16:41,253 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:16:41,258 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:16:41,264 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:16:41,269 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:16:41,272 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:16:41,278 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:16:41,278 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:16:41,286 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:16:41,289 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:16:41,300 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:16:41,300 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:16:41,313 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:16:41,326 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:16:41,338 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:16:41,344 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:16:41,355 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:16:41,359 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:16:41,363 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:16:41,368 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:16:41,372 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:16:41,375 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:16:41,376 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:16:41,389 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:16:41,395 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:16:41,401 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:16:41,406 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:16:41,410 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:16:41,416 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:16:41,421 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:16:41,421 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:16:41,427 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:16:41,432 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:16:41,436 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:16:41,443 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:16:41,449 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:16:41,452 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:16:41,465 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:16:41,466 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:16:41,468 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:16:41,472 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:16:41,488 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:16:41,489 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:16:41,490 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:16:41,491 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:16:41,502 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:16:41,509 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:16:41,534 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:16:41,535 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:16:41,540 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:16:41,548 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:16:41,550 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:16:41,553 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:16:41,554 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:16:41,585 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:16:41,593 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:16:41,603 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:16:41,608 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:16:41,614 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:16:41,627 [INFO] metrics: xirr(): Converged successfully at 0.107817
2025-10-26 17:16:41,633 [INFO] metrics: xirr(): Converged successfully at 0.104296
2025-10-26 17:16:41,637 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:16:41,647 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:16:41,650 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:16:41,659 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:16:42,127 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:16:42,682 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:17:01,574 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:17:01,575 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:17:01,590 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:01,590 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:17:01,654 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:01,657 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:01,657 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:17:01,658 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,660 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:17:01,660 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,662 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:17:01,662 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,664 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:17:01,664 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,666 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:17:01,666 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,669 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:17:01,671 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:17:01,671 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:17:01,671 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:17:01,672 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:17:01,676 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:17:01,677 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:01,677 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:17:01,697 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:01,703 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:01,703 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:17:01,703 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,705 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:17:01,706 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,707 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:17:01,707 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,709 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:17:01,710 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,711 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:17:01,712 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,713 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:17:01,713 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,713 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:01,714 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:17:01,718 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:01,720 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:01,721 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:17:01,721 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,723 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:17:01,724 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,724 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:17:01,730 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:17:01,731 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:17:01,734 [INFO] cli_utils: CLI argument parsed — curve shock: -0.06
2025-10-26 17:17:01,739 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:17:01,740 [INFO] __main__: curve data shocked for -0.06
2025-10-26 17:17:01,742 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:01,742 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:17:01,755 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:01,760 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:01,760 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:17:01,761 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,763 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:17:01,763 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,765 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:17:01,765 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,767 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:17:01,768 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,771 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:17:01,775 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,777 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:17:01,778 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,779 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:17:01,779 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,781 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:17:01,782 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,784 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:17:01,784 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,785 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:01,786 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:17:01,836 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:01,848 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:01,863 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:17:01,864 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,866 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:17:01,866 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,867 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:17:01,868 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:01,868 [INFO] merge: Starting merge pipeline...
2025-10-26 17:17:01,869 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:17:01,872 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:17:01,875 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:17:01,880 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:17:01,897 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:17:01,907 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:17:01,908 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:17:01,915 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:17:01,920 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:17:01,927 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:17:01,927 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:17:01,939 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:17:01,953 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:17:01,960 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:17:01,969 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:17:01,977 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:17:01,983 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:17:01,987 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:17:01,993 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:17:02,001 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:17:02,004 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:17:02,005 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:17:02,013 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:17:02,019 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:17:02,027 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:17:02,032 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:17:02,037 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:17:02,041 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:17:02,046 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:17:02,046 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:17:02,053 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:17:02,060 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:17:02,064 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:17:02,075 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:17:02,080 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:17:02,084 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:17:02,103 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:17:02,104 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:17:02,106 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:17:02,109 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:17:02,129 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:17:02,130 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:17:02,131 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:17:02,132 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:17:02,151 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:17:02,157 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:17:02,183 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:17:02,185 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:17:02,190 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:17:02,196 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:17:02,197 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:17:02,204 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:17:02,204 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:17:02,235 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:17:02,244 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:17:02,251 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:17:02,257 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:17:02,261 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:17:02,275 [INFO] metrics: xirr(): Converged successfully at 0.143222
2025-10-26 17:17:02,284 [INFO] metrics: xirr(): Converged successfully at 0.132823
2025-10-26 17:17:02,294 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:17:02,307 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:17:02,310 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:17:02,321 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:17:02,806 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:17:03,247 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:17:16,981 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:17:16,981 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:17:16,999 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:16,999 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:17:17,071 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:17,075 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:17,076 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:17:17,076 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,080 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:17:17,081 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,082 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:17:17,083 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,087 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:17:17,088 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,090 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:17:17,091 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,093 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:17:17,095 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:17:17,095 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:17:17,096 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:17:17,096 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:17:17,101 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:17:17,102 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:17,102 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:17:17,111 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:17,117 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:17,118 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:17:17,119 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,121 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:17:17,121 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,124 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:17:17,125 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,126 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:17:17,127 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,129 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:17:17,129 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,131 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:17:17,131 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,131 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:17,132 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:17:17,137 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:17,139 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:17,142 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:17:17,142 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,144 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:17:17,144 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,145 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:17:17,151 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:17:17,152 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:17:17,155 [INFO] cli_utils: CLI argument parsed — curve shock: 0.06
2025-10-26 17:17:17,157 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:17:17,161 [INFO] __main__: curve data shocked for 0.06
2025-10-26 17:17:17,161 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:17,162 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:17:17,176 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:17,179 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:17,179 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:17:17,179 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,182 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:17:17,183 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,184 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:17:17,184 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,186 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:17:17,187 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,189 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:17:17,189 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,191 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:17:17,191 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,193 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:17:17,193 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,195 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:17:17,195 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,199 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:17:17,199 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,200 [INFO] utils: Starting data cleaning.
2025-10-26 17:17:17,200 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:17:17,207 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:17:17,215 [INFO] utils: Data cleaning complete.
2025-10-26 17:17:17,215 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:17:17,216 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,218 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:17:17,218 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,220 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:17:17,221 [INFO] utils: --------------------------------------------------
2025-10-26 17:17:17,221 [INFO] merge: Starting merge pipeline...
2025-10-26 17:17:17,222 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:17:17,227 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:17:17,232 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:17:17,237 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:17:17,243 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:17:17,249 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:17:17,249 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:17:17,257 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:17:17,263 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:17:17,271 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:17:17,271 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:17:17,284 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:17:17,295 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:17:17,300 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:17:17,307 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:17:17,313 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:17:17,318 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:17:17,322 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:17:17,329 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:17:17,333 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:17:17,337 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:17:17,337 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:17:17,348 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:17:17,355 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:17:17,361 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:17:17,365 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:17:17,370 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:17:17,374 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:17:17,378 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:17:17,379 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:17:17,384 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:17:17,392 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:17:17,397 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:17:17,403 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:17:17,408 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:17:17,412 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:17:17,426 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:17:17,426 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:17:17,428 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:17:17,431 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:17:17,444 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:17:17,445 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:17:17,448 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:17:17,448 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:17:17,463 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:17:17,468 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:17:17,495 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:17:17,496 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:17:17,500 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:17:17,506 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:17:17,507 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:17:17,511 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:17:17,511 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:17:17,542 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:17:17,555 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:17:17,562 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:17:17,566 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:17:17,570 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:17:17,585 [INFO] metrics: xirr(): Converged successfully at 0.070401
2025-10-26 17:17:17,594 [INFO] metrics: xirr(): Converged successfully at 0.073977
2025-10-26 17:17:17,597 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:17:17,603 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:17:17,608 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:17:17,617 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:17:18,084 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:17:18,557 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:21:11,256 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:21:11,256 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:21:11,281 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:11,281 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:21:11,350 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:11,353 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:11,353 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:21:11,354 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,356 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:21:11,357 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,359 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:21:11,360 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,361 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:21:11,362 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,363 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:21:11,363 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,366 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:21:11,368 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:21:11,369 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:21:11,369 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:21:11,369 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:21:11,375 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:21:11,376 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:11,376 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:21:11,386 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:11,391 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:11,392 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:21:11,392 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,393 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:21:11,394 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,395 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:21:11,395 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,399 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:21:11,399 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,400 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:21:11,401 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,402 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:21:11,403 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,403 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:11,403 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:21:11,408 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:11,411 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:11,411 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:21:11,411 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,413 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:21:11,413 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,414 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:21:11,419 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:21:11,420 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:21:11,424 [INFO] cli_utils: CLI argument parsed — curve shock: 0.06
2025-10-26 17:21:11,424 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:21:11,426 [INFO] __main__: curve data shocked for 0.06
2025-10-26 17:21:11,427 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:11,428 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:21:11,438 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:11,440 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:11,441 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:21:11,442 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,444 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:21:11,444 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,446 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:21:11,446 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,449 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:21:11,450 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,452 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:21:11,452 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,455 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:21:11,457 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,459 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:21:11,459 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,462 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:21:11,463 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,465 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:21:11,465 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,467 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:11,468 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:21:11,476 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:11,479 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:11,480 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:21:11,481 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,482 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:21:11,483 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,486 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:21:11,486 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:11,487 [INFO] merge: Starting merge pipeline...
2025-10-26 17:21:11,487 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:21:11,492 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:21:11,496 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:21:11,502 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:21:11,506 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:21:11,520 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:21:11,524 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:21:11,540 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:21:11,550 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:21:11,559 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:21:11,567 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:21:11,589 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:21:11,610 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:21:11,619 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:21:11,625 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:21:11,633 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:21:11,638 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:21:11,642 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:21:11,648 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:21:11,655 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:21:11,661 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:21:11,661 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:21:11,669 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:21:11,675 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:21:11,685 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:21:11,691 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:21:11,696 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:21:11,706 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:21:11,711 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:21:11,712 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:21:11,718 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:21:11,726 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:21:11,731 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:21:11,739 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:21:11,744 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:21:11,749 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:21:11,764 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:21:11,764 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:21:11,768 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:21:11,774 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:21:11,791 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:21:11,792 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:21:11,794 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:21:11,795 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:21:11,810 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:21:11,814 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:21:11,841 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:21:11,842 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:21:11,846 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:21:11,853 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:21:11,854 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:21:11,857 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:21:11,858 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:21:11,888 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:21:11,901 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:21:11,907 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:21:11,911 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:21:11,918 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:21:11,933 [INFO] metrics: xirr(): Converged successfully at 0.070401
2025-10-26 17:21:11,939 [INFO] metrics: xirr(): Converged successfully at 0.073977
2025-10-26 17:21:11,943 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:21:11,952 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:21:11,956 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:21:11,967 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:21:12,418 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:21:12,874 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:21:21,681 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:21:21,682 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:21:21,752 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:21,753 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:21:21,771 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:21,775 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:21,775 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:21:21,775 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,777 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:21:21,777 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,779 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:21:21,779 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,783 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:21:21,784 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,786 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:21:21,786 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,789 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:21:21,792 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:21:21,793 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:21:21,793 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:21:21,793 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:21:21,802 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:21:21,802 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:21,803 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:21:21,824 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:21,828 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:21,828 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:21:21,830 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,832 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:21:21,832 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,835 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:21:21,835 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,838 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:21:21,839 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,841 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:21:21,842 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,844 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:21:21,844 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,845 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:21,846 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:21:21,852 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:21,855 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:21,856 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:21:21,856 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,859 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:21:21,861 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,861 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:21:21,868 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:21:21,870 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:21:21,873 [INFO] cli_utils: CLI argument parsed — curve shock: -0.06
2025-10-26 17:21:21,875 [INFO] __main__: Applying interest rate shock...
2025-10-26 17:21:21,883 [INFO] __main__: curve data shocked for -0.06
2025-10-26 17:21:21,884 [WARNING] __main__: 48 rate(s) fell below 0 after shock. Clipping to 0.0.
2025-10-26 17:21:21,885 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:21,886 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:21:21,900 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:21,903 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:21,904 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:21:21,904 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,907 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:21:21,908 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,911 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:21:21,913 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,914 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:21:21,915 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,916 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:21:21,917 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,920 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:21:21,920 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,922 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:21:21,923 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,925 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:21:21,926 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,927 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:21:21,931 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,934 [INFO] utils: Starting data cleaning.
2025-10-26 17:21:21,934 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:21:21,946 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:21:21,951 [INFO] utils: Data cleaning complete.
2025-10-26 17:21:21,953 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:21:21,956 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,958 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:21:21,958 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,960 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:21:21,960 [INFO] utils: --------------------------------------------------
2025-10-26 17:21:21,961 [INFO] merge: Starting merge pipeline...
2025-10-26 17:21:21,962 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:21:21,965 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:21:21,974 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:21:21,979 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:21:21,981 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:21:21,989 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:21:21,990 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:21:21,997 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:21:22,001 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:21:22,011 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:21:22,012 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:21:22,024 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:21:22,033 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:21:22,045 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:21:22,053 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:21:22,057 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:21:22,062 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:21:22,068 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:21:22,074 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:21:22,078 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:21:22,082 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:21:22,083 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:21:22,091 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:21:22,099 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:21:22,105 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:21:22,112 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:21:22,118 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:21:22,122 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:21:22,127 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:21:22,128 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:21:22,135 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:21:22,141 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:21:22,145 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:21:22,151 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:21:22,155 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:21:22,177 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:21:22,191 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:21:22,196 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:21:22,203 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:21:22,211 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:21:22,241 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:21:22,242 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:21:22,244 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:21:22,244 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:21:22,274 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:21:22,279 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:21:22,316 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:21:22,317 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:21:22,322 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:21:22,331 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:21:22,334 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:21:22,338 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:21:22,339 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:21:22,371 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:21:22,382 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:21:22,388 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:21:22,391 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:21:22,395 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:21:22,410 [INFO] metrics: xirr(): Converged successfully at 0.124682
2025-10-26 17:21:22,418 [INFO] metrics: xirr(): Converged successfully at 0.115198
2025-10-26 17:21:22,422 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:21:22,432 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:21:22,434 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:21:22,446 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:21:22,906 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:21:23,382 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:25:41,611 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:25:41,612 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:25:41,628 [INFO] utils: Starting data cleaning.
2025-10-26 17:25:41,628 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:25:41,704 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:25:41,707 [INFO] utils: Data cleaning complete.
2025-10-26 17:25:41,707 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:25:41,708 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,711 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:25:41,711 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,713 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:25:41,714 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,715 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:25:41,715 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,716 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:25:41,716 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,718 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:25:41,720 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:25:41,720 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:25:41,720 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:25:41,720 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:25:41,725 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:25:41,725 [INFO] utils: Starting data cleaning.
2025-10-26 17:25:41,726 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:25:41,735 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:25:41,738 [INFO] utils: Data cleaning complete.
2025-10-26 17:25:41,738 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:25:41,739 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,740 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:25:41,741 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,742 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:25:41,742 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,744 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:25:41,745 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,746 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:25:41,746 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,751 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:25:41,751 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,752 [INFO] utils: Starting data cleaning.
2025-10-26 17:25:41,753 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:25:41,759 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:25:41,763 [INFO] utils: Data cleaning complete.
2025-10-26 17:25:41,763 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:25:41,764 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,765 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:25:41,765 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,766 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:25:41,771 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:25:41,772 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:25:41,776 [INFO] cli_utils: CLI argument parsed — curve shock: 0.0
2025-10-26 17:25:41,778 [INFO] utils: Starting data cleaning.
2025-10-26 17:25:41,778 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:25:41,791 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:25:41,793 [INFO] utils: Data cleaning complete.
2025-10-26 17:25:41,793 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:25:41,794 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,795 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:25:41,796 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,797 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:25:41,798 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,799 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:25:41,800 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,801 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:25:41,801 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,802 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:25:41,803 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,804 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:25:41,804 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,805 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:25:41,805 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,807 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:25:41,808 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,808 [INFO] utils: Starting data cleaning.
2025-10-26 17:25:41,809 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:25:41,818 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:25:41,820 [INFO] utils: Data cleaning complete.
2025-10-26 17:25:41,821 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:25:41,821 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,823 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:25:41,823 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,825 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:25:41,826 [INFO] utils: --------------------------------------------------
2025-10-26 17:25:41,826 [INFO] merge: Starting merge pipeline...
2025-10-26 17:25:41,832 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:25:41,836 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:25:41,841 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:25:41,847 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:25:41,849 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:25:41,855 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:25:41,855 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:25:41,862 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:25:41,864 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:25:41,876 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:25:41,878 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:25:41,889 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:25:41,911 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:25:41,920 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:25:41,926 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:25:41,930 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:25:41,937 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:25:41,941 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:25:41,946 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:25:41,950 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:25:41,954 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:25:41,954 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:25:41,961 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:25:41,968 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:25:41,974 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:25:41,980 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:25:41,984 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:25:41,987 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:25:41,992 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:25:41,992 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:25:42,000 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:25:42,003 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:25:42,008 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:25:42,018 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:25:42,021 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:25:42,024 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:25:42,039 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:25:42,040 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:25:42,043 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:25:42,047 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:25:42,060 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:25:42,061 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:25:42,065 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:25:42,065 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:25:42,080 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:25:42,084 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:25:42,111 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:25:42,112 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:25:42,116 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:25:42,123 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:25:42,124 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:25:42,128 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:25:42,129 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:25:42,162 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:25:42,176 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:25:42,183 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:25:42,188 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:25:42,195 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:25:42,205 [INFO] metrics: xirr(): Converged successfully at 0.106299
2025-10-26 17:25:42,215 [INFO] metrics: xirr(): Converged successfully at 0.103069
2025-10-26 17:25:42,218 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:25:42,224 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:25:42,232 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:25:42,241 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:25:42,705 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:25:43,236 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 17:29:18,158 [INFO] __main__: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 17:29:18,159 [INFO] __main__: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:29:18,175 [INFO] utils: Starting data cleaning.
2025-10-26 17:29:18,175 [INFO] utils: Input shape: (137, 6)
2025-10-26 17:29:18,249 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:29:18,252 [INFO] utils: Data cleaning complete.
2025-10-26 17:29:18,252 [INFO] utils: Output shape: (137, 6)
2025-10-26 17:29:18,253 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,255 [INFO] utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 17:29:18,256 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,258 [INFO] utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 17:29:18,258 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,259 [INFO] utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 17:29:18,260 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,261 [INFO] utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 17:29:18,261 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,264 [INFO] clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 17:29:18,265 [INFO] clean_cash_flow: Applied cash flow sign convention.
2025-10-26 17:29:18,266 [INFO] clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 17:29:18,266 [INFO] clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 17:29:18,266 [INFO] clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 17:29:18,270 [INFO] clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 17:29:18,271 [INFO] utils: Starting data cleaning.
2025-10-26 17:29:18,271 [INFO] utils: Input shape: (5, 10)
2025-10-26 17:29:18,283 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:29:18,285 [INFO] utils: Data cleaning complete.
2025-10-26 17:29:18,286 [INFO] utils: Output shape: (5, 10)
2025-10-26 17:29:18,286 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,289 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:29:18,290 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,293 [INFO] utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 17:29:18,293 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,294 [INFO] utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 17:29:18,295 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,296 [INFO] utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 17:29:18,296 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,298 [INFO] utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 17:29:18,298 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,299 [INFO] utils: Starting data cleaning.
2025-10-26 17:29:18,299 [INFO] utils: Input shape: (48, 3)
2025-10-26 17:29:18,303 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:29:18,308 [INFO] utils: Data cleaning complete.
2025-10-26 17:29:18,309 [INFO] utils: Output shape: (48, 3)
2025-10-26 17:29:18,309 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,312 [INFO] utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 17:29:18,312 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,313 [INFO] clean_curve: Starting curve cleaning process...
2025-10-26 17:29:18,318 [INFO] clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 17:29:18,319 [INFO] clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 17:29:18,323 [INFO] cli_utils: CLI argument parsed — curve shock: 0.0
2025-10-26 17:29:18,328 [INFO] utils: Starting data cleaning.
2025-10-26 17:29:18,328 [INFO] utils: Input shape: (5, 8)
2025-10-26 17:29:18,342 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:29:18,345 [INFO] utils: Data cleaning complete.
2025-10-26 17:29:18,346 [INFO] utils: Output shape: (5, 8)
2025-10-26 17:29:18,346 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,348 [INFO] utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 17:29:18,348 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,350 [INFO] utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 17:29:18,350 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,352 [INFO] utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 17:29:18,353 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,355 [INFO] utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 17:29:18,355 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,357 [INFO] utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 17:29:18,357 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,363 [INFO] utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 17:29:18,363 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,364 [INFO] utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 17:29:18,365 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,368 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 17:29:18,369 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,369 [INFO] utils: Starting data cleaning.
2025-10-26 17:29:18,370 [INFO] utils: Input shape: (2, 6)
2025-10-26 17:29:18,376 [INFO] utils: No NaN values detected in the dataset.
2025-10-26 17:29:18,378 [INFO] utils: Data cleaning complete.
2025-10-26 17:29:18,378 [INFO] utils: Output shape: (2, 6)
2025-10-26 17:29:18,378 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,380 [INFO] utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 17:29:18,380 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,382 [INFO] utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 17:29:18,382 [INFO] utils: --------------------------------------------------
2025-10-26 17:29:18,384 [INFO] merge: Starting merge pipeline...
2025-10-26 17:29:18,385 [INFO] merge: Before structure merge: (137, 6)
2025-10-26 17:29:18,389 [INFO] merge: After structure merge: (137, 14)
2025-10-26 17:29:18,395 [INFO] merge: After terms merge: (137, 24)
2025-10-26 17:29:18,401 [INFO] merge: After leverage merge: (137, 29)
2025-10-26 17:29:18,403 [INFO] merge: No missing values detected in merged dataset.
2025-10-26 17:29:18,411 [INFO] merge: No duplicate rows detected in merged dataset.
2025-10-26 17:29:18,411 [INFO] merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 17:29:18,420 [INFO] merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 17:29:18,423 [INFO] cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 17:29:18,434 [INFO] cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 17:29:18,434 [INFO] cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 17:29:18,445 [INFO] metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 17:29:18,456 [INFO] metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:29:18,467 [INFO] metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 17:29:18,475 [INFO] metrics: IRR calculation starts on the entity_id level
2025-10-26 17:29:18,480 [INFO] metrics: xirr(): Converged successfully at 0.140130
2025-10-26 17:29:18,485 [INFO] metrics: xirr(): Converged successfully at 0.128055
2025-10-26 17:29:18,489 [INFO] metrics: xirr(): Converged successfully at 0.149952
2025-10-26 17:29:18,493 [INFO] metrics: xirr(): Converged successfully at 0.113139
2025-10-26 17:29:18,499 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:29:18,505 [INFO] metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 17:29:18,506 [INFO] metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 17:29:18,514 [INFO] metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:29:18,521 [INFO] metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 17:29:18,533 [INFO] metrics: IRR calculation starts on the deal_id level
2025-10-26 17:29:18,538 [INFO] metrics: xirr(): Converged successfully at 0.136003
2025-10-26 17:29:18,544 [INFO] metrics: xirr(): Converged successfully at 0.133075
2025-10-26 17:29:18,550 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:29:18,554 [INFO] metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 17:29:18,554 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:29:18,564 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:29:18,572 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:29:18,579 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:29:18,587 [INFO] metrics: xirr(): Converged successfully at 0.134758
2025-10-26 17:29:18,593 [INFO] metrics: xirr(): Converged successfully at 0.127697
2025-10-26 17:29:18,598 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:29:18,617 [INFO] level_merge: Merged all levels — total rows: 10
2025-10-26 17:29:18,618 [INFO] level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 17:29:18,620 [INFO] level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 17:29:18,624 [INFO] fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 17:29:18,643 [INFO] fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 17:29:18,643 [INFO] fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 17:29:18,646 [INFO] fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 17:29:18,646 [INFO] fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 17:29:18,660 [INFO] fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 17:29:18,664 [INFO] fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 17:29:18,689 [INFO] fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 17:29:18,690 [INFO] fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 17:29:18,694 [INFO] fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 17:29:18,701 [INFO] fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 17:29:18,703 [INFO] fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 17:29:18,708 [INFO] fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 17:29:18,709 [INFO] fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 17:29:18,741 [INFO] utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 17:29:18,753 [INFO] metrics: Computing metrics at level: ['fund']
2025-10-26 17:29:18,761 [INFO] metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 17:29:18,766 [INFO] metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 17:29:18,770 [INFO] metrics: IRR calculation starts on the fund level
2025-10-26 17:29:18,783 [INFO] metrics: xirr(): Converged successfully at 0.106299
2025-10-26 17:29:18,791 [INFO] metrics: xirr(): Converged successfully at 0.103069
2025-10-26 17:29:18,795 [INFO] metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 17:29:18,802 [INFO] level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 17:29:18,804 [INFO] charts: plot_irr_highlighted: starting chart build.
2025-10-26 17:29:18,814 [INFO] charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 17:29:19,286 [INFO] charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 17:29:19,745 [INFO] charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
2025-10-26 19:28:22,018 [INFO] irr_calc.main: Base Dir is C:\Users\zhouy\OneDrive\Documents\pc_project
2025-10-26 19:28:22,020 [INFO] irr_calc.main: Data folder: C:\Users\zhouy\OneDrive\Documents\pc_project\data
2025-10-26 19:28:22,021 [INFO] irr_calc.main: Output folders ready: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\cash_master, C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 19:28:22,044 [INFO] irr_calc.utils: Starting data cleaning.
2025-10-26 19:28:22,045 [INFO] irr_calc.utils: Input shape: (137, 6)
2025-10-26 19:28:22,115 [INFO] irr_calc.utils: No NaN values detected in the dataset.
2025-10-26 19:28:22,118 [INFO] irr_calc.utils: Data cleaning complete.
2025-10-26 19:28:22,118 [INFO] irr_calc.utils: Output shape: (137, 6)
2025-10-26 19:28:22,119 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,121 [INFO] irr_calc.utils: Top values in 'entity_id':
entity_id
f001    28
f002    27
f003    27
f004    27
f005    27
fo02     1
2025-10-26 19:28:22,122 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,125 [INFO] irr_calc.utils: Top values in 'entity_type':
entity_type
facility    137
2025-10-26 19:28:22,125 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,127 [INFO] irr_calc.utils: Top values in 'cashflow_type':
cashflow_type
interest            79
principal_return    35
pik_interest        12
contribution         6
exit_fee             5
2025-10-26 19:28:22,128 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,130 [INFO] irr_calc.utils: Top values in 'currency':
currency
usd    110
eur     27
2025-10-26 19:28:22,131 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,134 [INFO] irr_calc.clean_cash_flow: entity_id clean complete - cleaned db: entity_id
f001    28
f002    28
f003    27
f004    27
f005    27
Name: count, dtype: int64
2025-10-26 19:28:22,137 [INFO] irr_calc.clean_cash_flow: Applied cash flow sign convention.
2025-10-26 19:28:22,138 [INFO] irr_calc.clean_cash_flow:   • Negative cash flow types: ['contribution']
2025-10-26 19:28:22,138 [INFO] irr_calc.clean_cash_flow:   • Rows converted to negative: 6
2025-10-26 19:28:22,139 [INFO] irr_calc.clean_cash_flow:   • Rows converted to positive: 131
2025-10-26 19:28:22,146 [INFO] irr_calc.clean_cash_flow: ----------------------------------------------------------------------
2025-10-26 19:28:22,147 [INFO] irr_calc.utils: Starting data cleaning.
2025-10-26 19:28:22,147 [INFO] irr_calc.utils: Input shape: (5, 10)
2025-10-26 19:28:22,163 [INFO] irr_calc.utils: No NaN values detected in the dataset.
2025-10-26 19:28:22,167 [INFO] irr_calc.utils: Data cleaning complete.
2025-10-26 19:28:22,167 [INFO] irr_calc.utils: Output shape: (5, 10)
2025-10-26 19:28:22,167 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,169 [INFO] irr_calc.utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 19:28:22,169 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,175 [INFO] irr_calc.utils: Top values in 'rate_type':
rate_type
sofr+spread       3
fixed             1
euribor+spread    1
2025-10-26 19:28:22,175 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,177 [INFO] irr_calc.utils: Top values in 'day_count':
day_count
act/360    4
30/360     1
2025-10-26 19:28:22,177 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,179 [INFO] irr_calc.utils: Top values in 'pik':
pik
no     3
yes    2
2025-10-26 19:28:22,180 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,183 [INFO] irr_calc.utils: Top values in 'delayed_draw':
delayed_draw
no     4
yes    1
2025-10-26 19:28:22,183 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,184 [INFO] irr_calc.utils: Starting data cleaning.
2025-10-26 19:28:22,185 [INFO] irr_calc.utils: Input shape: (48, 3)
2025-10-26 19:28:22,193 [INFO] irr_calc.utils: No NaN values detected in the dataset.
2025-10-26 19:28:22,195 [INFO] irr_calc.utils: Data cleaning complete.
2025-10-26 19:28:22,196 [INFO] irr_calc.utils: Output shape: (48, 3)
2025-10-26 19:28:22,196 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,198 [INFO] irr_calc.utils: Top values in 'curve':
curve
sofr       23
euribor    23
eurib0r     1
s0fr        1
2025-10-26 19:28:22,198 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,199 [INFO] irr_calc.clean_curve: Starting curve cleaning process...
2025-10-26 19:28:22,207 [INFO] irr_calc.clean_curve: Curve cleaning completed — 2 values modified.
2025-10-26 19:28:22,209 [INFO] irr_calc.clean_curve: curve data after cleaned curve
sofr       24
euribor    24
Name: count, dtype: int64
2025-10-26 19:28:22,211 [INFO] irr_calc.cli_utils: CLI argument parsed — curve shock: 0.0
2025-10-26 19:28:22,212 [INFO] irr_calc.utils: Starting data cleaning.
2025-10-26 19:28:22,213 [INFO] irr_calc.utils: Input shape: (5, 8)
2025-10-26 19:28:22,230 [INFO] irr_calc.utils: No NaN values detected in the dataset.
2025-10-26 19:28:22,233 [INFO] irr_calc.utils: Data cleaning complete.
2025-10-26 19:28:22,233 [INFO] irr_calc.utils: Output shape: (5, 8)
2025-10-26 19:28:22,233 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,235 [INFO] irr_calc.utils: Top values in 'facility_id':
facility_id
f001    1
f002    1
f003    1
f004    1
f005    1
2025-10-26 19:28:22,235 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,238 [INFO] irr_calc.utils: Top values in 'facility_name':
facility_name
term_loan_a          1
delayed_draw_tl      1
mezz_loan            1
refinance_tl         1
senior_secured_tl    1
2025-10-26 19:28:22,238 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,242 [INFO] irr_calc.utils: Top values in 'deal_id':
deal_id
d001    2
d002    2
d003    1
2025-10-26 19:28:22,242 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,244 [INFO] irr_calc.utils: Top values in 'deal_name':
deal_name
acme_industrials_unitranche     2
greenleaf_real_estate_mezz      2
bluewave_software_sr_secured    1
2025-10-26 19:28:22,245 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,246 [INFO] irr_calc.utils: Top values in 'strategy_bucket':
strategy_bucket
direct_lending          2
real_estate_credit      2
opportunistic_credit    1
2025-10-26 19:28:22,247 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,249 [INFO] irr_calc.utils: Top values in 'region':
region
nan    4
eu     1
2025-10-26 19:28:22,250 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,252 [INFO] irr_calc.utils: Top values in 'sector':
sector
industrials    2
real_estate    2
technology     1
2025-10-26 19:28:22,252 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,254 [INFO] irr_calc.utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     4
hbc_private_credit_fund_ii    1
2025-10-26 19:28:22,254 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,255 [INFO] irr_calc.utils: Starting data cleaning.
2025-10-26 19:28:22,255 [INFO] irr_calc.utils: Input shape: (2, 6)
2025-10-26 19:28:22,263 [INFO] irr_calc.utils: No NaN values detected in the dataset.
2025-10-26 19:28:22,266 [INFO] irr_calc.utils: Data cleaning complete.
2025-10-26 19:28:22,266 [INFO] irr_calc.utils: Output shape: (2, 6)
2025-10-26 19:28:22,267 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,268 [INFO] irr_calc.utils: Top values in 'fund':
fund
hbc_private_credit_fund_i     1
hbc_private_credit_fund_ii    1
2025-10-26 19:28:22,269 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,271 [INFO] irr_calc.utils: Top values in 'cost_of_funds_curve':
cost_of_funds_curve
sofr       1
euribor    1
2025-10-26 19:28:22,271 [INFO] irr_calc.utils: --------------------------------------------------
2025-10-26 19:28:22,272 [INFO] irr_calc.merge: Starting merge pipeline...
2025-10-26 19:28:22,272 [INFO] irr_calc.merge: Before structure merge: (137, 6)
2025-10-26 19:28:22,276 [INFO] irr_calc.merge: After structure merge: (137, 14)
2025-10-26 19:28:22,281 [INFO] irr_calc.merge: After terms merge: (137, 24)
2025-10-26 19:28:22,285 [INFO] irr_calc.merge: After leverage merge: (137, 29)
2025-10-26 19:28:22,287 [INFO] irr_calc.merge: No missing values detected in merged dataset.
2025-10-26 19:28:22,294 [INFO] irr_calc.merge: No duplicate rows detected in merged dataset.
2025-10-26 19:28:22,295 [INFO] irr_calc.merge: Merge pipeline completed. Final shape: (137, 29)
2025-10-26 19:28:22,302 [INFO] irr_calc.merge: Curve merge successful: all rows matched a curve rate.
2025-10-26 19:28:22,306 [INFO] irr_calc.cash_flow_adjust: Removed 12 PIK interest cashflows (accrued).
2025-10-26 19:28:22,333 [INFO] irr_calc.cash_flow_adjust: Adjusted OID/origination fees for 6 cashflows.
2025-10-26 19:28:22,349 [INFO] irr_calc.cash_flow_adjust: Total invested before: -171,000,000.00 | after adjustment: -167,125,000.00
2025-10-26 19:28:22,374 [INFO] irr_calc.metrics: Computing metrics at level: ['entity_id', 'facility_name', 'deal_id', 'fund']
2025-10-26 19:28:22,389 [INFO] irr_calc.metrics: Calculated paid-in capital for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 19:28:22,399 [INFO] irr_calc.metrics: Calculated distributions for 5 grouped records at level ['entity_id', 'facility_name', 'deal_id', 'fund'].
2025-10-26 19:28:22,407 [INFO] irr_calc.metrics: IRR calculation starts on the entity_id level
2025-10-26 19:28:22,412 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.140130
2025-10-26 19:28:22,416 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.128055
2025-10-26 19:28:22,419 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.149952
2025-10-26 19:28:22,423 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.113139
2025-10-26 19:28:22,428 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.127697
2025-10-26 19:28:22,433 [INFO] irr_calc.metrics: Metrics calculated and merged for 5 ['entity_id', 'facility_name', 'deal_id', 'fund'] records.
2025-10-26 19:28:22,433 [INFO] irr_calc.metrics: Computing metrics at level: ['deal_id', 'deal_name', 'fund']
2025-10-26 19:28:22,441 [INFO] irr_calc.metrics: Calculated paid-in capital for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 19:28:22,447 [INFO] irr_calc.metrics: Calculated distributions for 3 grouped records at level ['deal_id', 'deal_name', 'fund'].
2025-10-26 19:28:22,452 [INFO] irr_calc.metrics: IRR calculation starts on the deal_id level
2025-10-26 19:28:22,459 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.136003
2025-10-26 19:28:22,465 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.133075
2025-10-26 19:28:22,470 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.127697
2025-10-26 19:28:22,474 [INFO] irr_calc.metrics: Metrics calculated and merged for 3 ['deal_id', 'deal_name', 'fund'] records.
2025-10-26 19:28:22,475 [INFO] irr_calc.metrics: Computing metrics at level: ['fund']
2025-10-26 19:28:22,478 [INFO] irr_calc.metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 19:28:22,481 [INFO] irr_calc.metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 19:28:22,485 [INFO] irr_calc.metrics: IRR calculation starts on the fund level
2025-10-26 19:28:22,490 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.134758
2025-10-26 19:28:22,494 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.127697
2025-10-26 19:28:22,497 [INFO] irr_calc.metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 19:28:22,509 [INFO] irr_calc.level_merge: Merged all levels — total rows: 10
2025-10-26 19:28:22,510 [INFO] irr_calc.level_merge: Facility: 5, Deal: 3, Fund: 2
2025-10-26 19:28:22,511 [INFO] irr_calc.level_merge: Missing values summary: {'level': 0, 'id': 0, 'name': 0, 'paid_in': 0, 'distributed': 0, 'gross_irr': 0, 'gross_moic': 0, 'net_irr': 10, 'net_moic': 10}
2025-10-26 19:28:22,514 [INFO] irr_calc.fund_metrics: Starting full fund-level financing pipeline...
2025-10-26 19:28:22,529 [INFO] irr_calc.fund_metrics: clean_data_fund: processed 6 records.
2025-10-26 19:28:22,530 [INFO] irr_calc.fund_metrics: Columns: ['entity_id', 'con_date', 'con_amount', 'fund_commitment', 'cost_of_funds_curve', 'fund_spread_bps_lev', 'fund_undrawn_fee_bps', 'advance_rate', 'fund', 'finance_portion', 'credit_line', 'exit_date']
2025-10-26 19:28:22,558 [INFO] irr_calc.fund_metrics: Missing values summary: {'entity_id': 0, 'con_date': 0, 'con_amount': 0, 'fund_commitment': 0, 'cost_of_funds_curve': 0, 'fund_spread_bps_lev': 0, 'fund_undrawn_fee_bps': 0, 'advance_rate': 0, 'fund': 0, 'finance_portion': 0, 'credit_line': 0, 'exit_date': 0}
2025-10-26 19:28:22,561 [INFO] irr_calc.fund_metrics: Step 1: clean_data_fund complete — 6 rows
2025-10-26 19:28:22,591 [INFO] irr_calc.fund_metrics: return_fund_info: aggregated 3 rows for 2 funds.
2025-10-26 19:28:22,596 [INFO] irr_calc.fund_metrics: Step 2: return_fund_info complete — 3 rows
2025-10-26 19:28:22,622 [INFO] irr_calc.fund_metrics: expand_and_join_curve: produced 57 fund×month rows across 2 funds.
2025-10-26 19:28:22,623 [INFO] irr_calc.fund_metrics: expand_and_join_curve: missing curve rates on 0 rows.
2025-10-26 19:28:22,627 [INFO] irr_calc.fund_metrics: Step 3: expand_and_join_curve complete — 57 rows
2025-10-26 19:28:22,633 [INFO] irr_calc.fund_metrics: calc_monthly_fee: generated 114 fee rows across 2 funds.
2025-10-26 19:28:22,634 [INFO] irr_calc.fund_metrics: calc_monthly_fee: interest rows=57, undrawn_fee rows=57
2025-10-26 19:28:22,637 [INFO] irr_calc.fund_metrics: Step 4: calc_monthly_fee complete — 114 rows
2025-10-26 19:28:22,638 [INFO] irr_calc.fund_metrics: Pipeline finished successfully. Outputs saved in: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\fund_level
2025-10-26 19:28:22,664 [INFO] irr_calc.utils: stack_fund_fees_into_master: appended 114 fund rows to 125 master rows (total=239).
2025-10-26 19:28:22,671 [INFO] irr_calc.metrics: Computing metrics at level: ['fund']
2025-10-26 19:28:22,678 [INFO] irr_calc.metrics: Calculated paid-in capital for 2 grouped records at level ['fund'].
2025-10-26 19:28:22,682 [INFO] irr_calc.metrics: Calculated distributions for 2 grouped records at level ['fund'].
2025-10-26 19:28:22,686 [INFO] irr_calc.metrics: IRR calculation starts on the fund level
2025-10-26 19:28:22,696 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.106299
2025-10-26 19:28:22,702 [INFO] irr_calc.metrics: xirr(): Converged successfully at 0.103069
2025-10-26 19:28:22,706 [INFO] irr_calc.metrics: Metrics calculated and merged for 2 ['fund'] records.
2025-10-26 19:28:22,712 [INFO] irr_calc.level_merge: assign_fund_net_metrics: updated fund-level net_irr and net_moic for %d funds.
2025-10-26 19:28:22,714 [INFO] irr_calc.charts: plot_irr_highlighted: starting chart build.
2025-10-26 19:28:22,720 [INFO] irr_calc.charts: plot_irr_highlighted: counts by level {'Facility': 5, 'Deal': 3, 'Fund': 2}
2025-10-26 19:28:23,147 [INFO] irr_calc.charts: plot_irr_highlighted: rendering chart to screen.
2025-10-26 19:28:23,581 [INFO] irr_calc.charts: Chart saved to: C:\Users\zhouy\OneDrive\Documents\pc_project\outputs\irr_plot.png
